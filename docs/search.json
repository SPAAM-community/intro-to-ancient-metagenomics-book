[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Introduction to Ancient Metagenomics",
    "section": "",
    "text": "Introduction\nAncient metagenomics applies cutting-edge metagenomic methods to the degraded DNA content of archaeological and palaeontological specimens. The rapidly growing field is currently uncovering a wealth of novel information for both human and natural history, from identifying the causes of devastating pandemics such as the Black Death, to revealing how past ecosystems changed in response to long-term climatic and anthropogenic change, to reconstructing the microbiomes of extinct human relatives. However, as the field grows, the techniques, methods, and workflows used to analyse such data are rapidly changing and improving.\nIn this book we will go through the main steps of ancient metagenomic bioinformatic workflows, familiarising students with the command line, demonstrating how to process next-generation-sequencing (NGS) data, and showing how to perform de novo metagenomic assembly. Focusing on host-associated ancient metagenomics, the book consists of a combination of theory and hands-on exercises, allowing readers to become familiar with the types of questions and data researchers work with.\nBy the end of the textbook, readers will have an understanding of how to effectively carry out the major bioinformatic components of an ancient metagenomic project in an open and transparent manner.\n\n\n\n\n\n\nNote\n\n\n\nIf you export the PDF or ePub versions of this book, some sections maybe excluded (such as videos, and embedded slide decks). Always refer to this website in doubt.\n\n\nAll material was originally developed for the SPAAM Summer School: Introduction to Ancient Metagenomics"
  },
  {
    "objectID": "authors.html",
    "href": "authors.html",
    "title": "1¬† Authors",
    "section": "",
    "text": "The creation of this text book was developed through a series of ‚Ä¶\n\n\n\n\n\n\n\n\n2022\n\nüá¨üáß James Fellows Yates is an archaeology-trained biomolecular archaeologist and convert to palaeogenomics, and is recently pivoting to bioinformatics. He specialises in ancient metagenomics analysis, generating tools and high-throughput approaches and high-quality pipelines for validating and analysing ancient (oral) microbiomes and palaeogenomic data.\n\n\n2022\n\nüá∫üá∏ Christina Warinner is Group Leader of Microbiome Sciences at the Max Planck Institute for Evolutionary Anthropology in Leipzig, Germany, and Associate Professor of Anthropology at Harvard University. She serves on the Leadership Team of the Max Planck-Harvard Research Center for the Archaeoscience of the Ancient Mediterranean (MHAAM), and is a Professor in the Faculty of Biological Sciences at Friedrich Schiller University in Jena, Germany. Her research focuses on the use of metagenomics and paleoproteomics to better understand past human diet, health, and the evolution of the human microbiome.\n\n\n2022\n\nüá™üá∏ Aida Andrades Valtue√±a is a geneticist interested in pathogen evolution, with particular interest in prehistoric pathogens. She has been exploring new methods to analyse ancient pathogen data to understand their past function and ecology to inform models of pathogen emergence.\n\n\n2022\n\nüá©üá™ Alexander Herbig is a bioinformatician and group leader for Computational Pathogenomics at the Max Planck Institute for Evolutionary Anthropology. His main interest is in studying the evolution of human pathogens and in methods development for pathogen detection and bacterial genomics.\n\n\n2022\n\nüá©üá™ Alex H√ºbner is a computational biologist, who originally studied biotechnology, before switching to evolutionary biology during his PhD. For his postdoc in the Warinner lab, he focuses on investigating whether new methods in the field of modern metagenomics can be directly applied to ancient DNA data. Here, he is particularly interested in the de novo assembly of ancient metagenomic sequencing data and the subsequent analysis of its results.\n\n\n2022\n\nüá©üá™ Alina Hiss is a PhD student in the Computational Pathogenomics group at the Max Planck Institute for Evolutionary Anthropology. She is interested in the evolution of human pathogens and working on material from the Carpathian basin to gain insights about the presence and spread of pathogens in the region during the Early Medieval period.\n\n\n2022\n\nüá´üá∑ Arthur Kocher initially trained as a veterinarian. He then pursued a PhD in the field of disease ecology, during which he studied the impact of biodiversity changes on the transmission of zoonotic diseases using molecular tools such as DNA metabarcoding. During his Post-Docs, he extended his research focus to evolutionary aspects of pathogens, which he currently investigates using ancient genomic data and Bayesian phylogenetics.\n\n\n2022\n\nüá©üá™ Clemens Schmid is a computational archaeologist pursuing a PhD in the group of Stephan Schiffels at the department of Archaeogenetics at the Max Planck Institute for Evolutionary Anthropology. He is trained both in archaeology and computer science and currently develops computational methods for the spatiotemporal co-analysis of archaeological and ancient genomic data. He worked in research projects on the European Neolithic, Copper and Bronze age and maintains research software in R, C++ and Haskell.\n\n\n2022\n\nüá∫üá∏ Irina Velsko is a postdoc in the Microbiome group of the department of Archaeogenetics at the Max Planck Institute for Evolutionary Anthropology. She did her PhD work on oral microbiology and immunology of the living, and now works on oral microbiomes of the living and the dead. Her work focuses on the evolution and ecology of dental plaque biofilms, both modern and ancient, and the complex interplay between microbiomes and their hosts.\n\n\n2022\n\nüá´üá∑ Maxime Borry is a doctoral researcher in bioinformatics at the Max Planck Institute for Evolutionary Anthropology in Germany. After an undergraduate in life sciences and a master in Ecology, followed by a master in bioinformatics, he is now working on the completion of his PhD, focused on developing new tools and data analysis of ancient metagenomic samples.\n\n\n2022\n\nüá∫üá∏ Megan Michel is a PhD student jointly affiliated with the Archaeogenetics Department at the Max Planck Institute for Evolutionary Anthropology and the Human Evolutionary Biology Department at Harvard University. Her research focuses on using computational genomic analyses to understand how pathogens have co-evolved with their hosts over the course of human history.\n\n\n2022\n\nüá∑üá∫ Nikolay Oskolkov is a bioinformatician at Lund University and the bioinformatics platform of SciLifeLab, Sweden. He defended his PhD in theoretical physics in 2007, and switched to life sciences in 2012. His research interests include mathematical statistics and machine learning applied to genetics and genomics, single cell and ancient metagenomics data analysis.\n\n\n2022\n\nüá¶üá∫ Sebastian Duchene is an Australian Research Council Fellow at the Doherty Institute for Infection and Immunity at the University of Melbourne, Australia. Prior to joining the University of Melbourne he obtained his PhD and conducted postdoctoral work at the University of Sydney. His research is in molecular evolution and epidemiology of infectious pathogens, notably viruses and bacteria, and developing Bayesian phylodynamic methods.\n\n\n2022\n\nüá¨üá∑ Thiseas Lamnidis is a human population geneticist interested in European population history after the Bronze Age. To gain the required resolution to differentiate between Iron Age European populations, he is developing analytical methods based on the sharing of rare variation between individuals. He has also contributed to pipelines that streamline the processing and analysis of genetic data in a reproducible manner, while also facilitating dissemination of information among interdisciplinary colleagues."
  },
  {
    "objectID": "acknowledgements.html#financial-support",
    "href": "acknowledgements.html#financial-support",
    "title": "2¬† Acknowledgements",
    "section": "2.1 Financial Support",
    "text": "2.1 Financial Support\n\nThe content of this textbook was developed from the SPAAM Summer School: Introduction to Ancient Metagenomics summer school series, sponsored by the Werner Siemens-Stiftung (Grant: Paleobiotechnology, awarded to Pierre Stallforth, Hans-Kn√∂ll Institute, and Christina Warinner, Max Planck Institute for Evolutionary Anthropology)"
  },
  {
    "objectID": "acknowledgements.html#institutional-support",
    "href": "acknowledgements.html#institutional-support",
    "title": "2¬† Acknowledgements",
    "section": "2.2 Institutional Support",
    "text": "2.2 Institutional Support"
  },
  {
    "objectID": "acknowledgements.html#infrastructural-support",
    "href": "acknowledgements.html#infrastructural-support",
    "title": "2¬† Acknowledgements",
    "section": "2.3 Infrastructural Support",
    "text": "2.3 Infrastructural Support\n\nThe practical sessions of the summers schools work was supported by the BMBF-funded de.NBI Cloud within the German Network for Bioinformatics Infrastructure (de.NBI) (031A532B, 031A533A, 031A533B, 031A534A, 031A535A, 031A537A, 031A537B, 031A537C, 031A537D, 031A538A). z"
  },
  {
    "objectID": "introduction-to-ngs-sequencing.html#introduction",
    "href": "introduction-to-ngs-sequencing.html#introduction",
    "title": "3¬† Introduction to NGS Sequencing",
    "section": "3.1 Introduction",
    "text": "3.1 Introduction\n\n\nIn this section, I will introduce how we are able to convert DNA molecules to human readable sequences of A, C, T, and Gs, which we can subsequently can computationally analyse.\nThe field of Ancient DNA was revolutionised by the development of ‚ÄòNext Generation Sequencing‚Äô (NGS), which relies on sequencing of millions of short fragments of DNA in parallel. The global leading DNA sequencing company is Illumina, and the technology used by Illumina is also most popular by palaeogeneticists. Therefore I will describe how the various technologies behind Illumina next-generation sequencing machines.\nI will also describe some important differences in the way different models of Illumina sequences work, and how this can influence ancient DNA research. Finally I will introduce the structure of ‚ÄòFASTQ‚Äô files, the most popular file format for representing the DNA sequence output of NGS sequencing machines."
  },
  {
    "objectID": "introduction-to-ngs-sequencing.html#lecture",
    "href": "introduction-to-ngs-sequencing.html#lecture",
    "title": "3¬† Introduction to NGS Sequencing",
    "section": "3.2 Lecture",
    "text": "3.2 Lecture\n\n\nPDF version of the slide lectures can be downloaded from here."
  },
  {
    "objectID": "introduction-to-ngs-sequencing.html#readings",
    "href": "introduction-to-ngs-sequencing.html#readings",
    "title": "3¬† Introduction to NGS Sequencing",
    "section": "3.3 Readings",
    "text": "3.3 Readings\n\nReviews\n(Schuster 2008)\n(Shendure and Ji 2008)\n(Slatko, Gardner, and Ausubel 2018)\n(Dijk et al. 2014)\n\n\nSequencing Library Construction\n(Kircher, Sawyer, and Meyer 2012)\n(Meyer and Kircher 2010)\n\n\nErrors and Considerations\n(Ma et al. 2019)\n(Sinha et al. 2017)\n(Valk et al. 2019)"
  },
  {
    "objectID": "introduction-to-ngs-sequencing.html#questions-to-think-about",
    "href": "introduction-to-ngs-sequencing.html#questions-to-think-about",
    "title": "3¬† Introduction to NGS Sequencing",
    "section": "3.4 Questions to think about",
    "text": "3.4 Questions to think about\n\nWhy is Illumina sequencing technologies useful for aDNA?\nWhat problems can the 2-colour chemistry technology of NextSeq and NovaSeqs cause in downstream analysis?\nWhy is ‚ÄòIndex-Hopping‚Äô a problem?\nWhat is good software to evaluate the quality of your sequencing runs?\n\n\n\n\n\nDijk, Erwin L van, H√©l√®ne Auger, Yan Jaszczyszyn, and Claude Thermes. 2014. ‚ÄúTen Years of Next-Generation Sequencing Technology.‚Äù Trends in Genetics 30 (9): 418‚Äì26. https://doi.org/10.1016/j.tig.2014.07.001.\n\n\nKircher, Martin, Susanna Sawyer, and Matthias Meyer. 2012. ‚ÄúDouble Indexing Overcomes Inaccuracies in Multiplex Sequencing on the Illumina Platform.‚Äù Nucleic Acids Research 40 (1): e3. https://doi.org/10.1093/nar/gkr771.\n\n\nMa, Xiaotu, Ying Shao, Liqing Tian, Diane A Flasch, Heather L Mulder, Michael N Edmonson, Yu Liu, et al. 2019. ‚ÄúAnalysis of Error Profiles in Deep Next-Generation Sequencing Data.‚Äù Genome Biology 20 (1): 50. https://doi.org/10.1186/s13059-019-1659-6.\n\n\nMeyer, Matthias, and Martin Kircher. 2010. ‚ÄúIllumina Sequencing Library Preparation for Highly Multiplexed Target Capture and Sequencing.‚Äù Cold Spring Harbor Protocols 2010 (6): db.prot5448. https://doi.org/10.1101/pdb.prot5448.\n\n\nSchuster, Stephan C. 2008. ‚ÄúNext-Generation Sequencing Transforms Today‚Äôs Biology.‚Äù Nature Methods 5 (1): 16‚Äì18. https://doi.org/10.1038/nmeth1156.\n\n\nShendure, Jay, and Hanlee Ji. 2008. ‚ÄúNext-Generation DNA Sequencing.‚Äù Nature Biotechnology 26 (10): 1135‚Äì45. https://doi.org/10.1038/nbt1486.\n\n\nSinha, Rahul, Geoff Stanley, Gunsagar Singh Gulati, Camille Ezran, Kyle Joseph Travaglini, Eric Wei, Charles Kwok Fai Chan, et al. 2017. ‚ÄúIndex Switching Causes ‚ÄòSpreading-of-Signal‚Äô Among Multiplexed Samples in Illumina HiSeq 4000 DNA Sequencing.‚Äù bioRxiv. https://doi.org/10.1101/125724.\n\n\nSlatko, Barton E, Andrew F Gardner, and Frederick M Ausubel. 2018. ‚ÄúOverview of Next-Generation Sequencing Technologies.‚Äù Current Protocols in Molecular Biology / Edited by Frederick M. Ausubel ... [Et Al.] 122 (1): e59. https://doi.org/10.1002/cpmb.59.\n\n\nValk, Tom van der, Francesco Vezzi, Mattias Ormestad, Love Dal√©n, and Katerina Guschanski. 2019. ‚ÄúIndex Hopping on the Illumina HiseqX Platform and Its Consequences for Ancient DNA Studies.‚Äù Molecular Ecology Resources, March. https://doi.org/10.1111/1755-0998.13009."
  },
  {
    "objectID": "introduction-to-ancient-dna.html#introduction",
    "href": "introduction-to-ancient-dna.html#introduction",
    "title": "4¬† Introduction to Ancient DNA",
    "section": "4.1 Introduction",
    "text": "4.1 Introduction\nThis chapter introduces you to ancient DNA and the enormous technological changes that have taken place since the field‚Äôs origins in 1984. Starting with the quagga and proceeding to microbes, we discuss where ancient microbial DNA can be found in the archaeological record and examime how ancient DNA is defined by its condition, not by a fixed age. We next cover genome basics and take an in-depth look at the way DNA degrades over time. We detail the fundamentals of DNA damage, including the specific chemical processes that lead to DNA fragmentation and C-&gt;T miscoding lesions. We then demystify the DNA damage ‚Äúsmile plot‚Äù and explain the how the plot‚Äôs symmetry or asymmetry is related to the specific enzymes used to repair DNA during library construction. We discuss how DNA damage is and is not clock-like, how to interpret and troubleshoot DNA damage plots, and how DNA damage patters can be used to authenticate ancient samples, specific taxa, and even sequences. We cover laboratory strategies for removing or reducing damage for greater accuracy for genotype calling, and we discuss the pros and cons of single-stranded library protocols. We then take a closer look at proofreading and non-proofreading polymerases and note key steps in NGS library preparation during which enzyme selection is critical in ancient DNA studies. Finally, we examine the big picture of why DNA damage matters in ancient microbial studies, and its effects on taxonomic identification of sequences, accurate genome mapping, and metagenomic assembly."
  },
  {
    "objectID": "introduction-to-ancient-dna.html#lecture",
    "href": "introduction-to-ancient-dna.html#lecture",
    "title": "4¬† Introduction to Ancient DNA",
    "section": "4.2 Lecture",
    "text": "4.2 Lecture\n\n\nPDF version of these slides can be downloaded from here."
  },
  {
    "objectID": "introduction-to-ancient-dna.html#questions-to-think-about",
    "href": "introduction-to-ancient-dna.html#questions-to-think-about",
    "title": "4¬† Introduction to Ancient DNA",
    "section": "4.3 Questions to think about",
    "text": "4.3 Questions to think about\n\nWhat is ancient DNA?\nWhere do we find ancient DNA from microbes?\nHow does DNA degrade?\nHow do I interpret a DNA damage plot?\nHow is DNA damage used to authenticate ancient genomes and samples?\nWhat methods are available for managing DNA damage?\nHow does DNA damage matter for my analyses?"
  },
  {
    "objectID": "introduction-to-metagenomics.html#introduction",
    "href": "introduction-to-metagenomics.html#introduction",
    "title": "5¬† Introduction to Metagenomics",
    "section": "5.1 Introduction",
    "text": "5.1 Introduction\nThis chapter introduces you to the basics of metagenomics, with an emphasis on tools and approaches that are used to study ancient metagenomes. We begin by covering the basic terminology used in metagenomics and microbiome research and discuss how the field has changed over time. We examine the species concept for microbes and challenges that arise in classifying microbial species with respect to taxonomy and phylogeny. We then proceed to taxonomic profiling and discuss the pros and cons of different taxonomic profilers. Afterwards, we explain how to estimate preservation in ancient metagenomic samples and how to clean up your datasets and remove contaminants. Finally, we discuss strategies for exploring and comparing the ecological diversity in your samples, including different strategies for data normalization, distance calculation, and ordination."
  },
  {
    "objectID": "introduction-to-metagenomics.html#lecture",
    "href": "introduction-to-metagenomics.html#lecture",
    "title": "5¬† Introduction to Metagenomics",
    "section": "5.2 Lecture",
    "text": "5.2 Lecture\n\n\nPDF version of these slides can be downloaded from here."
  },
  {
    "objectID": "introduction-to-metagenomics.html#questions-to-think-about",
    "href": "introduction-to-metagenomics.html#questions-to-think-about",
    "title": "5¬† Introduction to Metagenomics",
    "section": "5.3 Questions to think about",
    "text": "5.3 Questions to think about\n\nWhat is a metagenome? a microbiota? a microbiome?\nWhat is ancient metagenomics?\nWhat challenges do DNA degradation and sample decay pose for ancient metagenomics\nHow do you find out ‚Äúwho‚Äôs there‚Äù in your samples?\nHow do alignment based and k-mer based taxonomic profilers differ? What are the advantages and disadvantages of each?\nWhy does database selection matter?\nHow do you estimate the preservation and integrity of your ancient metagenome?\nWhat are tools you can use to identify poorly preserved samples and remove contaminant taxa?\nWhat aspects of diversity are important in investigating microbial communities?\nWhich distance metrics are commonly used to compare the beta-diversity of microbial communities and why? What are some advantages and disadvantages to these different approaches?"
  },
  {
    "objectID": "introduction-to-microbial-genomics.html#introduction",
    "href": "introduction-to-microbial-genomics.html#introduction",
    "title": "6¬† Introduction to Microbial Genomics",
    "section": "6.1 Introduction",
    "text": "6.1 Introduction\nThe field of microbial genomics aims at the reconstruction and comparative analyses of genomes for gaining insights into the genetic foundation and evolution of various functional aspects such as virulence mechanisms in pathogens.\nIncluding data from ancient samples into this comparative assessment allows for studying these evolutionary changes through time. This, for example, provides insights into the emergence of human pathogens and their development in conjunction with human cultural transitions.\nIn this lecture I will provide examples for how to utilise data from ancient genomes in comparative studies of human pathogens and today‚Äôs practical sessions will highlight methodologies for the reconstruction of microbial genomes."
  },
  {
    "objectID": "introduction-to-microbial-genomics.html#lecture",
    "href": "introduction-to-microbial-genomics.html#lecture",
    "title": "6¬† Introduction to Microbial Genomics",
    "section": "6.2 Lecture",
    "text": "6.2 Lecture\n\n\nPDF version of these slides can be downloaded from here."
  },
  {
    "objectID": "introduction-to-microbial-genomics.html#questions-to-think-about",
    "href": "introduction-to-microbial-genomics.html#questions-to-think-about",
    "title": "6¬† Introduction to Microbial Genomics",
    "section": "6.3 Questions to think about",
    "text": "6.3 Questions to think about"
  },
  {
    "objectID": "introduction-to-evolutionary-biology.html#introduction",
    "href": "introduction-to-evolutionary-biology.html#introduction",
    "title": "7¬† Introduction to Evolutionary Biology",
    "section": "7.1 Introduction",
    "text": "7.1 Introduction\nPathogen genome data are an invaluable source of information about the evolution and spread of these organisms. This chapter will focus on molecular phylogenetic methods and the insight that they can reveal from improving our understanding of ancient evolution to the epidemiological dynamics of current outbreaks.\nThe first section will introduce phylognenetic trees and a set of core terms and concepts for their interpretation. Next, it will focus on some of the most popular approaches to inferring phylogenetic trees; those based on genetic distance, maximum likelihood, and Bayesian inference. These methods carry important considerations regarding the process that generated the data, computational capability, and data quality, all of which will be discussed here. Finally, we will direct our attention to examples of analyses of ancient and modern pathogens (e.g.¬†Yersinia pestis, Hepatitis B virus, SARS-CoV-2) and critically assess appropriate choice of models and methods.\n\n7.1.1 Lecture\n\n\nPDF version of these slides can be downloaded from here."
  },
  {
    "objectID": "bare-bones-bash.html",
    "href": "bare-bones-bash.html",
    "title": "8¬† Bare Bones Bash",
    "section": "",
    "text": "9 Lecture"
  },
  {
    "objectID": "bare-bones-bash.html#introduction",
    "href": "bare-bones-bash.html#introduction",
    "title": "8¬† Bare Bones Bash",
    "section": "8.1 Introduction",
    "text": "8.1 Introduction\nComputational work in metagenomics often involves connecting to remote servers to run analyses via the use of command line tools. Bash is a programming language that is used as the main command line interface of most UNIX systems, and hence most remote servers a user will encounter. By learning bash, users can work more efficiently and reproducibly on these remote servers.\nIn this chapter we will introduce the basic concepts of bash and the command line. Students will learn how to move around the filesystem and interact with files, how to chain multiple commands together using ‚Äúpipes‚Äù, and how to use loops and regular expressions to simplify the running of repetitive tasks.\nFinally, readers will learn how to create a bash script of their own, that can run a set of commands in sequence. This session requires no prior knowledge of bash or the command line and is meant to serve as an entry-level introduction to basic programming concepts that can be applicable in other programming languages too."
  },
  {
    "objectID": "bare-bones-bash.html#session-1",
    "href": "bare-bones-bash.html#session-1",
    "title": "8¬† Bare Bones Bash",
    "section": "9.1 Session 1",
    "text": "9.1 Session 1\nFor a full screen version on the presentation and press f on your keyboard.\nIntro to Bash\nPDF version of these slides can be downloaded from here.\nThe teaching material for the FULL BareBonesBash course can be found on the BareBonesBash website"
  },
  {
    "objectID": "bare-bones-bash.html#session-2",
    "href": "bare-bones-bash.html#session-2",
    "title": "8¬† Bare Bones Bash",
    "section": "9.2 Session 2",
    "text": "9.2 Session 2\nFor a full screen version click on the presentation and press f on your keyboard.\n[Intro to Bash](https://spaam-community.github.io/wss-summer-school/assets/slides/2022/1bc-barebonesbash/bbb2/session2.html ‚Äú:include :type=iframe width=100% height=400px)\nPDF version of these slides can be downloaded from here.\nThe teaching material for the FULL BareBonesBash course can be found on the BareBonesBash website"
  },
  {
    "objectID": "introduction-to-r.html#introduction",
    "href": "introduction-to-r.html#introduction",
    "title": "9¬† Introduction to R and the Tidyverse",
    "section": "9.1 Introduction",
    "text": "9.1 Introduction\nR is an interpreted programming language with a particular focus on data manipulation and analysis. It is very well established for scientific computing and supported by an active community developing and maintaining a huge ecosystem of software packages for both general and highly derived applications.\nIn this session we will explore how to use R for a simple, standard data science workflow. We will import, clean, and visualise context and summary data for and from our ancient metagenomics analysis workflow. On the way we will learn about the RStudio integrated development environment, dip into the basic logic and syntax of R and finally write some first useful code within the tidyverse framework for tidy, readable and reproducible data analysis.\nThis session will be targeted at beginners without much previous experience with R or programming and will kickstart your journey to master this powerful tool.\n\n\n\n\n\n\nNote\n\n\n\nThis session is typically ran held in parallel to the Introduction to Python and Pandas. Participants of the summer schools chose which to attend based on their prior experience. We recommend the introduction to R session if you have no experience with neither R nor Python."
  },
  {
    "objectID": "introduction-to-r.html#lecture",
    "href": "introduction-to-r.html#lecture",
    "title": "9¬† Introduction to R and the Tidyverse",
    "section": "9.2 Lecture",
    "text": "9.2 Lecture\n\n\nPDF version of these slides can be downloaded from here."
  },
  {
    "objectID": "introduction-to-r.html#the-working-environment",
    "href": "introduction-to-r.html#the-working-environment",
    "title": "9¬† Introduction to R and the Tidyverse",
    "section": "9.3 The working environment",
    "text": "9.3 The working environment\n\n9.3.1 R, RStudio and the tidyverse\n\nR is a fully featured programming language, but it excels as an environment for (statistical) data analysis (https://www.r-project.org)\nRStudio is an integrated development environment (IDE) for R (and other languages): (https://www.rstudio.com/products/rstudio)\nThe tidyverse is a collection of R packages with well-designed and consistent interfaces for the main steps of data analysis: loading, transforming and plotting data (https://www.tidyverse.org)\n\nThis introduction works with tidyverse ~v1.3.0\nWe will learn about readr, tibble, ggplot2, dplyr, magrittr and tidyr\nforcats will be briefly mentioned\npurrr and stringr are left out"
  },
  {
    "objectID": "introduction-to-r.html#loading-data-into-tibbles",
    "href": "introduction-to-r.html#loading-data-into-tibbles",
    "title": "9¬† Introduction to R and the Tidyverse",
    "section": "9.4 Loading data into tibbles",
    "text": "9.4 Loading data into tibbles\n\n9.4.1 Reading data with readr\n\nWith R we usually operate on data in our computer‚Äôs memory\nThe tidyverse provides the package readr to read data from text files into the memory\nreadr can read from our file system or the internet\nIt provides functions to read data in almost any (text) format:\nreadr::read_csv()   # .csv files\nreadr::read_tsv()   # .tsv files\nreadr::read_delim() # tabular files with an arbitrary separator\nreadr::read_fwf()   # fixed width files\nreadr::read_lines() # read linewise to parse yourself\nreadr automatically detects column types ‚Äì but you can also define them manually\n\n\n\n9.4.2 How does the interface of read_csv work\n\nWe can learn more about a function with ?. To open a help file: ?readr::read_csv\nreadr::read_csv has many options to specify how to read a text file\nread_csv(\nfile,                      # The path to the file we want to read\ncol_names = TRUE,          # Are there column names?\ncol_types = NULL,          # Which types do the columns have? NULL -&gt; auto\nlocale = default_locale(), # How is information encoded in this file?\nna = c(\"\", \"NA\"),          # Which values mean \"no data\"\ntrim_ws = TRUE,            # Should superfluous white-spaces be removed?\nskip = 0,                  # Skip X lines at the beginning of the file\nn_max = Inf,               # Only read X lines\nskip_empty_rows = TRUE,    # Should empty lines be ignored?\ncomment = \"\",              # Should comment lines be ignored?\nname_repair = \"unique\",    # How should \"broken\" column names be fixed\n...\n)\n\n\n\n9.4.3 What does readr produce? The tibble\nsample_table_path &lt;- \"/vol/volume/3b-1-introduction-to-r-and-the-tidyverse/ancientmetagenome-hostassociated_samples.tsv\"\nsample_table_url &lt;-\n\"https://raw.githubusercontent.com/SPAAM-community/AncientMetagenomeDir/b187df6ebd23dfeb42935fd5020cb615ead3f164/\nancientmetagenome-hostassociated/samples/ancientmetagenome-hostassociated_samples.tsv\"\nsamples &lt;- readr::read_tsv(sample_table_url)\n\nThe tibble is a ‚Äúdata frame‚Äù, a tabular data structure with rows and columns\nUnlike a simple array, each column can have another data type\n\nprint(samples, n = 3)\n\n\n9.4.4 How to look at a tibble\nsamples          # Typing the name of an object will print it to the console\nstr(samples)     # A structural overview of an object\nsummary(samples) # A human-readable summary of an object\nView(samples)    # RStudio's interactive data browser\n\nR provides a very flexible indexing operation for data.frames and tibbles\nsamples[1,1]                         # Access the first row and column\nsamples[1,]                          # Access the first row\nsamples[,1]                          # Access the first column\nsamples[c(1,2,3),c(2,3,4)]           # Access values from rows and columns\nsamples[,-c(1,2)]                    # Remove the first two columns\nsamples[,c(\"site_name\", \"material\")] # Columns can be selected by name\ntibbles are mutable data structures, so their content can be overwritten\nsamples[1,1] &lt;- \"Cheesecake2015\"     # replace the first value in the first column"
  },
  {
    "objectID": "introduction-to-r.html#plotting-data-in-tibbles",
    "href": "introduction-to-r.html#plotting-data-in-tibbles",
    "title": "9¬† Introduction to R and the Tidyverse",
    "section": "9.5 Plotting data in tibbles",
    "text": "9.5 Plotting data in tibbles\n\n9.5.1 ggplot2 and the ‚Äúgrammar of graphics‚Äù\n\nggplot2 offers an unusual, but powerful and logical interface\nThe following example describes a stacked bar chart\nlibrary(ggplot2) # Loading a library to use its functions without ::\n\nggplot(          # Every plot starts with a call to the ggplot() function\ndata = samples # This function can also take the input tibble\n) +              # The plot consists of functions linked with +\ngeom_bar(        # \"geoms\" define the plot layers we want to draw\nmapping = aes( # The aes() function maps variables to visual properties\n    x = publication_year, # publication_year -&gt; x-axis\n    fill = community_type # community_type -&gt; fill color\n)\n)\ngeom_*: data + geometry (bars) + statistical transformation (sum)\n\n\n\n9.5.2 ggplot2 and the ‚Äúgrammar of graphics‚Äù\n\nThis is the plot described above: number of samples per community type through time\nggplot(samples) +\ngeom_bar(aes(x = publication_year, fill = community_type))\n\n\n\n9.5.3 ggplot2 features many geoms\n(){width=55%}\n\nRStudio shares helpful cheatsheets for the tidyverse and beyond: https://www.rstudio.com/resources/cheatsheets\n\n\n\n9.5.4 scales control the behaviour of visual elements\n\nAnother plot: Boxplots of sample age through time\nggplot(samples) +\ngeom_boxplot(aes(x = as.factor(publication_year), y = sample_age))\nThis is not well readable, because extreme outliers dictate the scale\n\n\n\n9.5.5 scales control the behaviour of visual elements\n\nWe can change the scale of different visual elements - e.g.¬†the y-axis\nggplot(samples) +\ngeom_boxplot(aes(x = as.factor(publication_year), y = sample_age)) +\nscale_y_log10()\nThe log-scale improves readability\n\n\n\n9.5.6 scales control the behaviour of visual elements\n\n(Fill) color is a visual element of the plot and its scaling can be adjusted\nggplot(samples) +\ngeom_boxplot(aes(x = as.factor(publication_year), y = sample_age,\n                fill = as.factor(publication_year))) +\nscale_y_log10() + scale_fill_viridis_d(option = \"C\")\n\n\n\n9.5.7 Defining plot matrices via facets\n\nSplitting up the plot by categories into facets is another way to visualize more variables at once\nggplot(samples) +\ngeom_count(aes(x = as.factor(publication_year), y = material)) +\nfacet_wrap(~archive)\nUnfortunately the x-axis became unreadable\n\n\n\n9.5.8 Setting purely aesthetic settings with theme\n\nAesthetic changes like this can be applied as part of the theme\nggplot(samples) +\ngeom_count(aes(x = as.factor(publication_year), y = material)) +\nfacet_wrap(~archive) +\ntheme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1))\n\n\n\n9.5.9 Exercise 1\n\nLook at the mtcars dataset and read up on the meaning of its variables\n\nVisualize the relationship between Gross horsepower and 1/4 mile time\n\nIntegrate the Number of cylinders into your plot\n\n\n\n\n9.5.10 Possible solutions 1\n\nLook at the mtcars dataset and read up on the meaning of its variables\n?mtcars\nVisualize the relationship between Gross horsepower and 1/4 mile time\nggplot(mtcars) + geom_point(aes(x = hp, y = qsec))\nIntegrate the Number of cylinders into your plot\nggplot(mtcars) + geom_point(aes(x = hp, y = qsec, color = as.factor(cyl)))"
  },
  {
    "objectID": "introduction-to-r.html#conditional-queries-on-tibbles",
    "href": "introduction-to-r.html#conditional-queries-on-tibbles",
    "title": "9¬† Introduction to R and the Tidyverse",
    "section": "9.6 Conditional queries on tibbles",
    "text": "9.6 Conditional queries on tibbles\n\n9.6.1 Selecting columns and filtering rows with select and filter\n\nThe dplyr package includes powerful functions to subset data in tibbles based on conditions\ndplyr::select allows to select columns\ndplyr::select(samples, project_name, sample_age)   # reduce to two columns\ndplyr::select(samples, -project_name, -sample_age) # remove two columns\ndplyr::filter allows for conditional filtering of rows\ndplyr::filter(samples, publication_year == 2014)  # samples published in 2014\ndplyr::filter(samples, publication_year == 2014 |\n                    publication_year == 2018)  # samples from 2015 OR 2018\ndplyr::filter(samples, publication_year %in% c(2014, 2018)) # match operator: %in%\ndplyr::filter(samples, sample_host == \"Homo sapiens\" &\n                    community_type == \"oral\")  # oral samples from modern humans\n\n\n\n9.6.2 Chaining functions together with the pipe %&gt;%\n\nThe pipe %&gt;% in the magrittr package is a clever infix operator to chain data and operations\nlibrary(magrittr)\nsamples %&gt;% dplyr::filter(publication_year == 2014)\nIt forwards the LHS as the first argument of the function appearing on the RHS\nThat allows for sequences of functions (‚Äútidyverse style‚Äù)\nsamples %&gt;%\ndplyr::select(sample_host, community_type) %&gt;%\ndplyr::filter(sample_host == \"Homo sapiens\" & community_type == \"oral\") %&gt;%\nnrow() # count the rows\nmagrittr also offers some more operators, among which the extraction %$% is particularly useful\nsamples %&gt;%\ndplyr::filter(material == \"tooth\") %$%\nsample_age %&gt;% # extract the sample_age column as a vector\nmax()          # get the maximum of said vector\n\n\n\n9.6.3 Summary statistics in base R\n\nSummarising and counting data is indispensable and R offers all operations you would expect in its base package\nnrow(samples)              # number of rows in a tibble\nlength(samples$site_name)  # length/size of a vector\nunique(samples$material)   # unique elements of a vector\nmin(samples$sample_age)    # minimum\nmax(samples$sample_age)    # maximum\nmean(samples$sample_age)   # mean\nmedian(samples$sample_age) # median\nvar(samples$sample_age)    # variance\nsd(samples$sample_age)     # standard deviation\nquantile(samples$sample_age, probs = 0.75) # sample quantiles for the given probs\nmany of these functions can ignore missing values with an option na.rm = TRUE\n\n\n\n9.6.4 Group-wise summaries with group_by and summarise\n\nThese summary statistics are particular useful when applied to conditional subsets of a dataset\ndplyr allows such summary operations with a combination of group_by and summarise\nsamples %&gt;%\ndplyr::group_by(material) %&gt;%  # group the tibble by the material column\ndplyr::summarise(\n    min_age = min(sample_age),   # a new column: min age for each group\n    median_age = median(sample_age), # a new column: median age for each group\n    max_age = max(sample_age)    # a new column: max age for each group\n)\ngrouping can be applied across multiple columns\nsamples %&gt;%\ndplyr::group_by(material, sample_host) %&gt;% # group by material and host\ndplyr::summarise(\n    n = dplyr::n(),  # a new column: number of samples for each group\n    .groups = \"drop\" # drop the grouping after this summary operation\n)\n\n\n\n9.6.5 Sorting and slicing tibbles with arrange and slice\n\ndplyr allows to arrange tibbles by one or multiple columns\nsamples %&gt;% dplyr::arrange(publication_year)        # sort by publication year\nsamples %&gt;% dplyr::arrange(publication_year,\n                        sample_age)              # ... and sample age\nsamples %&gt;% dplyr::arrange(dplyr::desc(sample_age)) # sort descending on sample age\nSorting also works within groups and can be paired with slice to extract extreme values per group\nsamples %&gt;%\ndplyr::group_by(publication_year) %&gt;%       # group by publication year\ndplyr::arrange(dplyr::desc(sample_age)) %&gt;% # sort by age within (!) groups\ndplyr::slice_head(n = 2) %&gt;%                # keep the first two samples per group\ndplyr::ungroup()                            # remove the still lingering grouping\nSlicing is also the relevant operation to take random samples from the observations in a tibble\nsamples %&gt;% dplyr::slice_sample(n = 20)\n\n\n\n9.6.6 Exercise 2\n\nDetermine the number of cars with four forward gears (gear) in the mtcars dataset\n\nDetermine the mean 1/4 mile time (qsec) per Number of cylinders (cyl) group\n\nIdentify the least efficient cars for both transmission types (am)\n\n\n\n\n9.6.7 Possible solutions 2\n\nDetermine the number of cars with four forward gears (gear) in the mtcars dataset\nmtcars %&gt;% dplyr::filter(gear == 4) %&gt;% nrow()\nDetermine the mean 1/4 mile time (qsec) per Number of cylinders (cyl) group\nmtcars %&gt;% dplyr::group_by(cyl) %&gt;% dplyr::summarise(qsec_mean = mean(qsec))\nIdentify the least efficient cars for both transmission types (am)\n#mtcars3 &lt;- tibble::rownames_to_column(mtcars, var = \"car\") %&gt;% tibble::as_tibble()\nmtcars %&gt;% dplyr::group_by(am) %&gt;% dplyr::arrange(mpg) %&gt;% dplyr::slice_head()"
  },
  {
    "objectID": "introduction-to-r.html#transforming-and-manipulating-tibbles",
    "href": "introduction-to-r.html#transforming-and-manipulating-tibbles",
    "title": "9¬† Introduction to R and the Tidyverse",
    "section": "9.7 Transforming and manipulating tibbles",
    "text": "9.7 Transforming and manipulating tibbles\n\n9.7.1 Renaming and reordering columns and values with rename, relocate and recode\n\nColumns in tibbles can be renamed with dplyr::rename and reordered with dplyr::relocate\nsamples %&gt;% dplyr::rename(country = geo_loc_name) # rename a column\nsamples %&gt;% dplyr::relocate(site_name, .before = project_name) # reorder columns\nValues in columns can also be changed with dplyr::recode\nsamples$sample_host %&gt;% dplyr::recode(`Homo sapiens` = \"modern human\")\nR supports explicitly ordinal data with factors, which can be reordered as well\nfactors can be handeld more easily with the forcats package\nggplot(samples) + geom_bar(aes(x = community_type)) # bars are alphabetically ordered\nsa2 &lt;- samples\nsa2$cto &lt;- forcats::fct_reorder(sa2$community_type, sa2$community_type, length)\n# fct_reorder: reorder the input factor by a summary statistic on an other vector\nggplot(sa2) + geom_bar(aes(x = community_type)) # bars are ordered by size\n\n\n\n9.7.2 Adding columns to tibbles with mutate and transmute\n\nA common application of data manipulation is adding derived columns. dplyr offers that with mutate\nsamples %&gt;%\ndplyr::mutate(                                               # add a column that\n    archive_summary = paste0(archive, \": \", archive_accession) # combines two other\n) %$% archive_summary                                        # columns\ndplyr::transmute removes all columns but the newly created ones\nsamples %&gt;%\ndplyr::transmute(\n    sample_name = tolower(sample_name), # overwrite this columns\n    publication_doi                     # select this column\n)\ntibble::add_column behaves as dplyr::mutate, but gives more control over column position\nsamples %&gt;% tibble::add_column(., id = 1:nrow(.), .before = \"project_name\")\n\n\n\n9.7.3 Conditional operations with ifelse and case_when\n\nifelse allows to implement conditional mutate operations, that consider information from other columns, but that gets cumbersome easily\nsamples %&gt;% dplyr::mutate(hemi = ifelse(latitude &gt;= 0, \"North\", \"South\")) %$% hemi\n\nsamples %&gt;% dplyr::mutate(\nhemi = ifelse(is.na(latitude), \"unknown\", ifelse(latitude &gt;= 0, \"North\", \"South\"))\n) %$% hemi\ndplyr::case_when is a much more readable solution for this application\nsamples %&gt;% dplyr::mutate(\nhemi = dplyr::case_when(\n    latitude &gt;= 0 ~ \"North\",\n    latitude &lt; 0  ~ \"South\",\n    TRUE          ~ \"unknown\" # TRUE catches all remaining cases\n)\n) %$% hemi\n\n\n\n9.7.4 Long and wide data formats\n\nFor different applications or to simplify certain analysis or plotting operations data often has to be transformed from a wide to a long format or vice versa\n\n\n\nA table in wide format has N key columns and N value columns\nA table in long format has N key columns, one descriptor column and one value column\n\n\n\n9.7.5 A wide dataset\ncarsales &lt;- tibble::tribble(\n  ~brand, ~`2014`, ~`2015`, ~`2016`, ~`2017`,\n  \"BMW\",  20,      25,      30,      45,\n  \"VW\",   67,      40,     120,      55\n)\n\ncarsales\n\nWide format becomes a problem, when the columns are semantically identical. This dataset is in wide format and we can not easily plot it\nWe generally prefer data in long format, although it is more verbose with more duplication. ‚ÄúLong‚Äù format data is more ‚Äútidy‚Äù\n\n\n\n9.7.6 Making a wide dataset long with pivot_longer\ncarsales_long &lt;- carsales %&gt;% tidyr::pivot_longer(\n  cols = tidyselect::num_range(\"\", range = 2014:2017), # set of columns to transform\n  names_to = \"year\",            # the name of the descriptor column we want\n  names_transform = as.integer, # a transformation function to apply to the names\n  values_to = \"sales\"           # the name of the value column we want\n)\n\ncarsales_long\n\n\n9.7.7 Making a long dataset wide with pivot_wider\ncarsales_wide &lt;- carsales_long %&gt;% tidyr::pivot_wider(\n  id_cols = \"brand\",  # the set of id columns that should not be changed\n  names_from = year,  # the descriptor column with the names of the new columns\n  values_from = sales # the value column from which the values should be extracted\n)\n\ncarsales_wide\n\nApplications of wide datasets are adjacency matrices to represent graphs, covariance matrices or other pairwise statistics\nWhen data gets big, then wide formats can be significantly more efficient (e.g.¬†for spatial data)\n\n\n\n9.7.8 Exercise 3\n\nMove the column gear to the first position of the mtcars dataset\n\nMake a new dataset mtcars2 with the column mpg and an additional column am_v, which encodes the transmission type (am) as either \"manual\" or \"automatic\"\n\nCount the number of cars per transmission type (am_v) and number of gears (gear). Then transform the result to a wide format, with one column per transmission type.\n\n\n\n\n9.7.9 Possible solutions 3\n\nMove the column gear to the first position of the mtcars dataset\nmtcars %&gt;% dplyr::relocate(gear, .before = mpg)\nMake a new dataset mtcars2 with the column gear and an additional column am_v, which encodes the transmission type (am) as either \"manual\" or \"automatic\"\nmtcars2 &lt;- mtcars %&gt;% dplyr::mutate(\ngear, am_v = dplyr::case_when(am == 0 ~ \"automatic\", am == 1 ~ \"manual\")\n)\nCount the number of cars in mtcars2 per transmission type (am_v) and number of gears (gear). Then transform the result to a wide format, with one column per transmission type.\nmtcars2 %&gt;% dplyr::group_by(am_v, gear) %&gt;% dplyr::tally() %&gt;%\ntidyr::pivot_wider(names_from = am_v, values_from = n)"
  },
  {
    "objectID": "introduction-to-r.html#combining-tibbles-with-join-operations",
    "href": "introduction-to-r.html#combining-tibbles-with-join-operations",
    "title": "9¬† Introduction to R and the Tidyverse",
    "section": "9.8 Combining tibbles with join operations",
    "text": "9.8 Combining tibbles with join operations\n\n9.8.1 Types of joins\nJoins combine two datasets x and y based on key columns\n\nMutating joins add columns from one dataset to the other\n\nLeft join: Take observations from x and add fitting information from y\nRight join: Take observations from y and add fitting information from x\nInner join: Join the overlapping observations from x and y\nFull join: Join all observations from x and y, even if information is missing\n\nFiltering joins remove observations from x based on their presence in y\n\nSemi join: Keep every observation in x that is in y\nAnti join: Keep every observation in x that is not in y\n\n\n\n\n9.8.2 A second dataset\nlibrary_table_path &lt;- \"/vol/volume/3b-1-introduction-to-r-and-the-tidyverse/ancientmetagenome-hostassociated_libraries.tsv\"\nlibrary_table_url &lt;-\n\"https://raw.githubusercontent.com/SPAAM-community/AncientMetagenomeDir/b187df6ebd23dfeb42935fd5020cb615ead3f164/\nancientmetagenome-hostassociated/libraries/ancientmetagenome-hostassociated_libraries.tsv\"\n\nlibraries &lt;- readr::read_tsv(library_table_url)\nprint(libraries, n = 3)\n\n\n9.8.3 Meaningful subsets\nsamsub &lt;- samples %&gt;% dplyr::select(project_name, sample_name, sample_age)\nlibsub &lt;- libraries %&gt;% dplyr::select(project_name, sample_name, library_name, read_count)\nprint(samsub, n = 3)\nprint(libsub, n = 3)\n\n\n9.8.4 Left join\nTake observations from x and add fitting information from y\n\nleft &lt;- dplyr::left_join(\nx = samsub,                           # 1060 observations\ny = libsub,                           # 1657 observations\nby = c(\"project_name\", \"sample_name\") # the key columns by which to join\n)\n\nprint(left, n = 1)\n\nLeft joins are the most common join operation: Add information from another dataset\n\n\n\n9.8.5 Right join\nTake observations from y and add fitting information from x\n\nright &lt;- dplyr::right_join(\n  x = samsub,                           # 1060 observations\n  y = libsub,                           # 1657 observations\n  by = c(\"project_name\", \"sample_name\")\n)\n\nprint(right, n = 1)\n\nRight joins are almost identical to left joins ‚Äì only x and y have reversed roles\n\n\n\n9.8.6 Inner join\nJoin the overlapping observations from x and y\n\ninner &lt;- dplyr::inner_join(\nx = samsub,                           # 1060 observations\ny = libsub,                           # 1657 observations\nby = c(\"project_name\", \"sample_name\")\n)\n\nprint(inner, n = 1)\n\nInner joins are a fast and easy way to check, to which degree two dataset overlap\n\n\n\n9.8.7 Full join\nJoin all observations from x and y, even if information is missing\n\nfull &lt;- dplyr::full_join(\n  x = samsub,                           # 1060 observations\n  y = libsub,                           # 1657 observations\n  by = c(\"project_name\", \"sample_name\")\n)\n\nprint(full, n = 1)\n\nFull joins allow to preserve every bit of information\n\n\n\n9.8.8 Semi join\nKeep every observation in x that is in y\n\nsemi &lt;- dplyr::semi_join(\n  x = samsub,                           # 1060 observations\n  y = libsub,                           # 1657 observations\n  by = c(\"project_name\", \"sample_name\")\n)\nprint(semi, n = 1)\n\nSemi joins are underused operations to filter datasets\n\n\n\n9.8.9 Anti join\nKeep every observation in x that is not in y\n\nanti &lt;- dplyr::anti_join(\n  x = samsub,                           # 1060 observations\n  y = libsub,                           # 1657 observations\n  by = c(\"project_name\", \"sample_name\")\n)\nprint(anti, n = 1)\n\nAnti joins allow to quickly specify incomplete datasets and missing information\n\n\n\n9.8.10 Exercise 4\nConsider the following additional dataset:\ngear_opinions &lt;- tibble::tibble(gear = c(3, 5), opinion = c(\"boring\", \"wow\"))\n\nAdd my opinions about gears to the mtcars dataset\n\nRemove all cars from the dataset for which I don‚Äôt have an opinion\n\n\n\n\n9.8.11 Possible Solutions 4\n\nAdd my opinions about gears to the mtcars dataset\ndplyr::left_join(mtcars, gear_opinions, by = \"gear\")\nRemove all cars from the dataset for which I don‚Äôt have an opinion\ndplyr::anti_join(mtcars, gear_opinions, by = \"gear\")"
  },
  {
    "objectID": "introduction-to-python.html#abstract",
    "href": "introduction-to-python.html#abstract",
    "title": "10¬† Introduction to Python and Pandas",
    "section": "10.1 Abstract",
    "text": "10.1 Abstract\nWhile R has traditionally been the language of choice for statistical programming for many years, Python has taken away some of the hegemony thanks to its numerous available libraries for machine and deep learning. With its ever increasing collection of libraries for statistics and bioinformatics, Python has now become one the most used language in the bioinformatics community.\nIn this tutorial mirroring to the R session, we will learn how to use the Python libraries Pandas for importing, cleaning, and manipulating data tables, and producing simple plots with the Python sister library of ggplot2, plotnine.\nWe will also get ourselves familiar with the Jupyter notebook environment, often used by many high performance computing clusters as an interactive scripting interface. This session is meant for participants with a basic experience in R/tidyverse, but assumes no prior knowledge of Python/Jupyter.\n\n\n\n\n\n\nNote\n\n\n\nThis session is typically ran held in parallel to the Introduction to R and Tidyverse. Participants of the summer schools chose which to attend based on their prior experience. We recommend the introduction to R session if you have no experience with neither R nor Python."
  },
  {
    "objectID": "introduction-to-python.html#lecture",
    "href": "introduction-to-python.html#lecture",
    "title": "10¬† Introduction to Python and Pandas",
    "section": "10.2 Lecture",
    "text": "10.2 Lecture\n\n\nPDF version of these slides can be downloaded from here.\nThis session is run using a Jupyter notebook. This can be found here. However, it will already be installed on compute nodes during the summer school.\n\n\n\n‚ö†Ô∏è We highly recommend viewing this walkthrough via the Jupyter notebook above! The output of commands on the website for this walkthrough are displayed in their own code blocks - be wary of what you copy-paste!\n\nfrom IPython.core.display import SVG"
  },
  {
    "objectID": "introduction-to-python.html#introduction-to-data-manipulation-in-python-with-pandas-and-visulization-with-plotnine",
    "href": "introduction-to-python.html#introduction-to-data-manipulation-in-python-with-pandas-and-visulization-with-plotnine",
    "title": "10¬† Introduction to Python and Pandas",
    "section": "10.3 Introduction to data manipulation in Python with Pandas and visulization with plotnine",
    "text": "10.3 Introduction to data manipulation in Python with Pandas and visulization with plotnine\nMaxime Borry\nSPAAM Summer School 2022\nSVG(filename='img/whoami.svg')\n\n\n\nsvg\n\n\nOver the last few years, Python has gained an immense amount of popularity thanks to its numerous libraries in the field of machine learning, statistical data analysis, and bioinformatics. While a few years ago, it was often necessary to go back to R for performing routine data manipulation and analysis tasks, nowadays Python has a vast ecosystem of libraries for doing just that.\nToday, we will do a quick introduction of the most popular libraries for data analysis:\n\npandas, for reading and manipulation tabular data\nplotnine, the Python clone of ggplot2"
  },
  {
    "objectID": "introduction-to-python.html#overview",
    "href": "introduction-to-python.html#overview",
    "title": "10¬† Introduction to Python and Pandas",
    "section": "10.4 Overview:",
    "text": "10.4 Overview:\n\n0 - Foreword, working in a jupyter environment\n1 - Loading required libraries\n2 - Foreword on Pandas\n3 - Reading data with Pandas\n4 - Dealing with missing data\n5 - Computing basic statistics\n6 - Filtering\n8 - GroupBy operations\n9 - Joining different tables\n10 - Visualization with Plotnine"
  },
  {
    "objectID": "introduction-to-python.html#foreword-working-in-a-jupyter-environment",
    "href": "introduction-to-python.html#foreword-working-in-a-jupyter-environment",
    "title": "10¬† Introduction to Python and Pandas",
    "section": "10.5 0 - Foreword, working in a jupyter environment",
    "text": "10.5 0 - Foreword, working in a jupyter environment\n\n10.5.1 This is a markdown cell\nWith some features of the markdown syntax, such as:\n\nbold **bold**\nitalic *italic*\ninline code\n\n`inline code`\n\nlinks [links](https://www.google.com/)\nImages\n\n![](https://maximeborry.com/authors/maxime/avatar_hu4dc3c23d5a8c195732bbca11d7ce61be_114670_270x270_fill_lanczos_center_2.png)\nLatex code $ y = ax + b$\n$y = ax + b$\n\nprint(\"This is a code cell in Python\")\nThis is a code cell in Python\n! echo \"This is code cell in bash\"\nThis is code cell in bash\n%%bash\n\necho \"This a multiline code cell\"\necho \"in bash\"\nThis a multiline code cell\nin bash"
  },
  {
    "objectID": "introduction-to-python.html#loading-required-libraries",
    "href": "introduction-to-python.html#loading-required-libraries",
    "title": "10¬† Introduction to Python and Pandas",
    "section": "10.6 1 - Loading required libraries",
    "text": "10.6 1 - Loading required libraries\nimport pandas as pd\nimport numpy as np\nfrom plotnine import *\npd.__version__\n'1.4.3'\nnp.__version__\n'1.23.1'\n! conda list | grep plotnine\nplotnine                  0.9.0              pyhd8ed1ab_0    conda-forge"
  },
  {
    "objectID": "introduction-to-python.html#foreword-on-pandas",
    "href": "introduction-to-python.html#foreword-on-pandas",
    "title": "10¬† Introduction to Python and Pandas",
    "section": "10.7 2 - Foreword on Pandas",
    "text": "10.7 2 - Foreword on Pandas\n\n10.7.1 Pandas terminology\n\n\nThe pandas getting started tutorial: pandas.pydata.org/docs/getting_started"
  },
  {
    "objectID": "introduction-to-python.html#reading-data-with-pandas",
    "href": "introduction-to-python.html#reading-data-with-pandas",
    "title": "10¬† Introduction to Python and Pandas",
    "section": "10.8 3 - Reading data with Pandas",
    "text": "10.8 3 - Reading data with Pandas\nsample_table_url = \"https://raw.githubusercontent.com/SPAAM-community/AncientMetagenomeDir/b187df6ebd23dfeb42935fd5020cb615ead3f164/\nancientmetagenome-hostassociated/samples/ancientmetagenome-hostassociated_samples.tsv\"\nlibrary_table_url = \"https://raw.githubusercontent.com/SPAAM-community/AncientMetagenomeDir/b187df6ebd23dfeb42935fd5020cb615ead3f164/\nancientmetagenome-hostassociated/libraries/ancientmetagenome-hostassociated_libraries.tsv\"\nGetting help in Python\nhelp(pd.read_csv)\nHelp on function read_csv in module pandas.io.parsers.readers:\n\nread_csv(filepath_or_buffer: 'FilePath | ReadCsvBuffer[bytes] | ReadCsvBuffer[str]',\nsep=&lt;no_default&gt;, delimiter=None, header='infer', names=&lt;no_default&gt;, index_col=None,\nusecols=None, squeeze=None, prefix=&lt;no_default&gt;, mangle_dupe_cols=True,\ndtype: 'DtypeArg | None' = None, engine: 'CSVEngine | None' = None, converters=None,\ntrue_values=None, false_values=None, skipinitialspace=False, skiprows=None, skipfooter=0,\nnrows=None, na_values=None, keep_default_na=True, na_filter=True, verbose=False,\nskip_blank_lines=True, parse_dates=None, infer_datetime_format=False, keep_date_col=False,\n date_parser=None, dayfirst=False, cache_dates=True, iterator=False, chunksize=None,\n compression: 'CompressionOptions' = 'infer', thousands=None, decimal: 'str' = '.',\n lineterminator=None, quotechar='\"', quoting=0, doublequote=True, escapechar=None,\n comment=None, encoding=None, encoding_errors: 'str | None' = 'strict', dialect=None,\n error_bad_lines=None, warn_bad_lines=None, on_bad_lines=None, delim_whitespace=False,\n low_memory=True, memory_map=False, float_precision=None, storage_options: 'StorageOptions' = None)\n    Read a comma-separated values (csv) file into DataFrame.\n\n    Also supports optionally iterating or breaking of the file\n    into chunks.\n\n    Additional help can be found in the online docs for\n    `IO Tools &lt;https://pandas.pydata.org/pandas-docs/stable/user_guide/io.html&gt;`_.\n\n    Parameters\n    ----------\n    filepath_or_buffer : str, path object or file-like object\n        Any valid string path is acceptable. The string could be a URL. Valid\n        URL schemes include http, ftp, s3, gs, and file. For file URLs, a host is\n        expected. A local file could be: file://localhost/path/to/table.csv.\n\n        If you want to pass in a path object, pandas accepts any ``os.PathLike``.\n\n        By file-like object, we refer to objects with a ``read()`` method, such as\n        a file handle (e.g. via builtin ``open`` function) or ``StringIO``.\n    sep : str, default ','\n        Delimiter to use. If sep is None, the C engine cannot automatically detect\n        the separator, but the Python parsing engine can, meaning the latter will\n        be used and automatically detect the separator by Python's builtin sniffer\n        tool, ``csv.Sniffer``. In addition, separators longer than 1 character and\n        different from ``'\\s+'`` will be interpreted as regular expressions and\n        will also force the use of the Python parsing engine. Note that regex\n        delimiters are prone to ignoring quoted data. Regex example: ``'\\r\\t'``.\n    delimiter : str, default ``None``\n        Alias for sep.\n    header : int, list of int, None, default 'infer'\n        Row number(s) to use as the column names, and the start of the\n        data.  Default behavior is to infer the column names: if no names\n        are passed the behavior is identical to ``header=0`` and column\n        names are inferred from the first line of the file, if column\n        names are passed explicitly then the behavior is identical to\n        ``header=None``. Explicitly pass ``header=0`` to be able to\n        replace existing names. The header can be a list of integers that\n        specify row locations for a multi-index on the columns\n        e.g. [0,1,3]. Intervening rows that are not specified will be\n        skipped (e.g. 2 in this example is skipped). Note that this\n        parameter ignores commented lines and empty lines if\n        ``skip_blank_lines=True``, so ``header=0`` denotes the first line of\n        data rather than the first line of the file.\n    names : array-like, optional\n        List of column names to use. If the file contains a header row,\n        then you should explicitly pass ``header=0`` to override the column names.\n        Duplicates in this list are not allowed.\n    index_col : int, str, sequence of int / str, or False, optional, default ``None``\n      Column(s) to use as the row labels of the ``DataFrame``, either given as\n      string name or column index. If a sequence of int / str is given, a\n      MultiIndex is used.\n\n      Note: ``index_col=False`` can be used to force pandas to *not* use the first\n      column as the index, e.g. when you have a malformed file with delimiters at\n      the end of each line.\n    usecols : list-like or callable, optional\n        Return a subset of the columns. If list-like, all elements must either\n        be positional (i.e. integer indices into the document columns) or strings\n        that correspond to column names provided either by the user in `names` or\n        inferred from the document header row(s). If ``names`` are given, the document\n        header row(s) are not taken into account. For example, a valid list-like\n        `usecols` parameter would be ``[0, 1, 2]`` or ``['foo', 'bar', 'baz']``.\n        Element order is ignored, so ``usecols=[0, 1]`` is the same as ``[1, 0]``.\n        To instantiate a DataFrame from ``data`` with element order preserved use\n        ``pd.read_csv(data, usecols=['foo', 'bar'])[['foo', 'bar']]`` for columns\n        in ``['foo', 'bar']`` order or\n        ``pd.read_csv(data, usecols=['foo', 'bar'])[['bar', 'foo']]``\n        for ``['bar', 'foo']`` order.\n\n        If callable, the callable function will be evaluated against the column\n        names, returning names where the callable function evaluates to True. An\n        example of a valid callable argument would be ``lambda x: x.upper() in\n        ['AAA', 'BBB', 'DDD']``. Using this parameter results in much faster\n        parsing time and lower memory usage.\n    squeeze : bool, default False\n        If the parsed data only contains one column then return a Series.\n\n        .. deprecated:: 1.4.0\n            Append ``.squeeze(\"columns\")`` to the call to ``read_csv`` to squeeze\n            the data.\n    prefix : str, optional\n        Prefix to add to column numbers when no header, e.g. 'X' for X0, X1, ...\n\n        .. deprecated:: 1.4.0\n           Use a list comprehension on the DataFrame's columns after calling ``read_csv``.\n    mangle_dupe_cols : bool, default True\n        Duplicate columns will be specified as 'X', 'X.1', ...'X.N', rather than\n        'X'...'X'. Passing in False will cause data to be overwritten if there\n        are duplicate names in the columns.\n    dtype : Type name or dict of column -&gt; type, optional\n        Data type for data or columns. E.g. {'a': np.float64, 'b': np.int32,\n        'c': 'Int64'}\n        Use `str` or `object` together with suitable `na_values` settings\n        to preserve and not interpret dtype.\n        If converters are specified, they will be applied INSTEAD\n        of dtype conversion.\n    engine : {'c', 'python', 'pyarrow'}, optional\n        Parser engine to use. The C and pyarrow engines are faster, while the python engine\n        is currently more feature-complete. Multithreading is currently only supported by\n        the pyarrow engine.\n\n        .. versionadded:: 1.4.0\n\n            The \"pyarrow\" engine was added as an *experimental* engine, and some features\n            are unsupported, or may not work correctly, with this engine.\n    converters : dict, optional\n        Dict of functions for converting values in certain columns. Keys can either\n        be integers or column labels.\n    true_values : list, optional\n        Values to consider as True.\n    false_values : list, optional\n        Values to consider as False.\n    skipinitialspace : bool, default False\n        Skip spaces after delimiter.\n    skiprows : list-like, int or callable, optional\n        Line numbers to skip (0-indexed) or number of lines to skip (int)\n        at the start of the file.\n\n        If callable, the callable function will be evaluated against the row\n        indices, returning True if the row should be skipped and False otherwise.\n        An example of a valid callable argument would be ``lambda x: x in [0, 2]``.\n    skipfooter : int, default 0\n        Number of lines at bottom of file to skip (Unsupported with engine='c').\n    nrows : int, optional\n        Number of rows of file to read. Useful for reading pieces of large files.\n    na_values : scalar, str, list-like, or dict, optional\n        Additional strings to recognize as NA/NaN. If dict passed, specific\n        per-column NA values.  By default the following values are interpreted as\n        NaN: '', '#N/A', '#N/A N/A', '#NA', '-1.#IND', '-1.#QNAN', '-NaN', '-nan',\n        '1.#IND', '1.#QNAN', '&lt;NA&gt;', 'N/A', 'NA', 'NULL', 'NaN', 'n/a',\n        'nan', 'null'.\n    keep_default_na : bool, default True\n        Whether or not to include the default NaN values when parsing the data.\n        Depending on whether `na_values` is passed in, the behavior is as follows:\n\n        * If `keep_default_na` is True, and `na_values` are specified, `na_values`\n          is appended to the default NaN values used for parsing.\n        * If `keep_default_na` is True, and `na_values` are not specified, only\n          the default NaN values are used for parsing.\n        * If `keep_default_na` is False, and `na_values` are specified, only\n          the NaN values specified `na_values` are used for parsing.\n        * If `keep_default_na` is False, and `na_values` are not specified, no\n          strings will be parsed as NaN.\n\n        Note that if `na_filter` is passed in as False, the `keep_default_na` and\n        `na_values` parameters will be ignored.\n    na_filter : bool, default True\n        Detect missing value markers (empty strings and the value of na_values). In\n        data without any NAs, passing na_filter=False can improve the performance\n        of reading a large file.\n    verbose : bool, default False\n        Indicate number of NA values placed in non-numeric columns.\n    skip_blank_lines : bool, default True\n        If True, skip over blank lines rather than interpreting as NaN values.\n    parse_dates : bool or list of int or names or list of lists or dict, default False\n        The behavior is as follows:\n\n        * boolean. If True -&gt; try parsing the index.\n        * list of int or names. e.g. If [1, 2, 3] -&gt; try parsing columns 1, 2, 3\n          each as a separate date column.\n        * list of lists. e.g.  If [[1, 3]] -&gt; combine columns 1 and 3 and parse as\n          a single date column.\n        * dict, e.g. {'foo' : [1, 3]} -&gt; parse columns 1, 3 as date and call\n          result 'foo'\n\n        If a column or index cannot be represented as an array of datetimes,\n        say because of an unparsable value or a mixture of timezones, the column\n        or index will be returned unaltered as an object data type. For\n        non-standard datetime parsing, use ``pd.to_datetime`` after\n        ``pd.read_csv``. To parse an index or column with a mixture of timezones,\n        specify ``date_parser`` to be a partially-applied\n        :func:`pandas.to_datetime` with ``utc=True``. See\n        :ref:`io.csv.mixed_timezones` for more.\n\n        Note: A fast-path exists for iso8601-formatted dates.\n    infer_datetime_format : bool, default False\n        If True and `parse_dates` is enabled, pandas will attempt to infer the\n        format of the datetime strings in the columns, and if it can be inferred,\n        switch to a faster method of parsing them. In some cases this can increase\n        the parsing speed by 5-10x.\n    keep_date_col : bool, default False\n        If True and `parse_dates` specifies combining multiple columns then\n        keep the original columns.\n    date_parser : function, optional\n        Function to use for converting a sequence of string columns to an array of\n        datetime instances. The default uses ``dateutil.parser.parser`` to do the\n        conversion. Pandas will try to call `date_parser` in three different ways,\n        advancing to the next if an exception occurs: 1) Pass one or more arrays\n        (as defined by `parse_dates`) as arguments; 2) concatenate (row-wise) the\n        string values from the columns defined by `parse_dates` into a single array\n        and pass that; and 3) call `date_parser` once for each row using one or\n        more strings (corresponding to the columns defined by `parse_dates`) as\n        arguments.\n    dayfirst : bool, default False\n        DD/MM format dates, international and European format.\n    cache_dates : bool, default True\n        If True, use a cache of unique, converted dates to apply the datetime\n        conversion. May produce significant speed-up when parsing duplicate\n        date strings, especially ones with timezone offsets.\n\n        .. versionadded:: 0.25.0\n    iterator : bool, default False\n        Return TextFileReader object for iteration or getting chunks with\n        ``get_chunk()``.\n\n        .. versionchanged:: 1.2\n\n           ``TextFileReader`` is a context manager.\n    chunksize : int, optional\n        Return TextFileReader object for iteration.\n        See the `IO Tools docs\n        &lt;https://pandas.pydata.org/pandas-docs/stable/io.html#io-chunking&gt;`_\n        for more information on ``iterator`` and ``chunksize``.\n\n        .. versionchanged:: 1.2\n\n           ``TextFileReader`` is a context manager.\n    compression : str or dict, default 'infer'\n        For on-the-fly decompression of on-disk data. If 'infer' and '%s' is\n        path-like, then detect compression from the following extensions: '.gz',\n        '.bz2', '.zip', '.xz', or '.zst' (otherwise no compression). If using\n        'zip', the ZIP file must contain only one data file to be read in. Set to\n        ``None`` for no decompression. Can also be a dict with key ``'method'`` set\n        to one of {``'zip'``, ``'gzip'``, ``'bz2'``, ``'zstd'``} and other\n        key-value pairs are forwarded to ``zipfile.ZipFile``, ``gzip.GzipFile``,\n        ``bz2.BZ2File``, or ``zstandard.ZstdDecompressor``, respectively. As an\n        example, the following could be passed for Zstandard decompression using a\n        custom compression dictionary:\n        ``compression={'method': 'zstd', 'dict_data': my_compression_dict}``.\n\n        .. versionchanged:: 1.4.0 Zstandard support.\n\n    thousands : str, optional\n        Thousands separator.\n    decimal : str, default '.'\n        Character to recognize as decimal point (e.g. use ',' for European data).\n    lineterminator : str (length 1), optional\n        Character to break file into lines. Only valid with C parser.\n    quotechar : str (length 1), optional\n        The character used to denote the start and end of a quoted item. Quoted\n        items can include the delimiter and it will be ignored.\n    quoting : int or csv.QUOTE_* instance, default 0\n        Control field quoting behavior per ``csv.QUOTE_*`` constants. Use one of\n        QUOTE_MINIMAL (0), QUOTE_ALL (1), QUOTE_NONNUMERIC (2) or QUOTE_NONE (3).\n    doublequote : bool, default ``True``\n       When quotechar is specified and quoting is not ``QUOTE_NONE``, indicate\n       whether or not to interpret two consecutive quotechar elements INSIDE a\n       field as a single ``quotechar`` element.\n    escapechar : str (length 1), optional\n        One-character string used to escape other characters.\n    comment : str, optional\n        Indicates remainder of line should not be parsed. If found at the beginning\n        of a line, the line will be ignored altogether. This parameter must be a\n        single character. Like empty lines (as long as ``skip_blank_lines=True``),\n        fully commented lines are ignored by the parameter `header` but not by\n        `skiprows`. For example, if ``comment='#'``, parsing\n        ``#empty\\na,b,c\\n1,2,3`` with ``header=0`` will result in 'a,b,c' being\n        treated as the header.\n    encoding : str, optional\n        Encoding to use for UTF when reading/writing (ex. 'utf-8'). `List of Python\n        standard encodings\n        &lt;https://docs.python.org/3/library/codecs.html#standard-encodings&gt;`_ .\n\n        .. versionchanged:: 1.2\n\n           When ``encoding`` is ``None``, ``errors=\"replace\"`` is passed to\n           ``open()``. Otherwise, ``errors=\"strict\"`` is passed to ``open()``.\n           This behavior was previously only the case for ``engine=\"python\"``.\n\n        .. versionchanged:: 1.3.0\n\n           ``encoding_errors`` is a new argument. ``encoding`` has no longer an\n           influence on how encoding errors are handled.\n\n    encoding_errors : str, optional, default \"strict\"\n        How encoding errors are treated. `List of possible values\n        &lt;https://docs.python.org/3/library/codecs.html#error-handlers&gt;`_ .\n\n        .. versionadded:: 1.3.0\n\n    dialect : str or csv.Dialect, optional\n        If provided, this parameter will override values (default or not) for the\n        following parameters: `delimiter`, `doublequote`, `escapechar`,\n        `skipinitialspace`, `quotechar`, and `quoting`. If it is necessary to\n        override values, a ParserWarning will be issued. See csv.Dialect\n        documentation for more details.\n    error_bad_lines : bool, optional, default ``None``\n        Lines with too many fields (e.g. a csv line with too many commas) will by\n        default cause an exception to be raised, and no DataFrame will be returned.\n        If False, then these \"bad lines\" will be dropped from the DataFrame that is\n        returned.\n\n        .. deprecated:: 1.3.0\n           The ``on_bad_lines`` parameter should be used instead to specify behavior upon\n           encountering a bad line instead.\n    warn_bad_lines : bool, optional, default ``None``\n        If error_bad_lines is False, and warn_bad_lines is True, a warning for each\n        \"bad line\" will be output.\n\n        .. deprecated:: 1.3.0\n           The ``on_bad_lines`` parameter should be used instead to specify behavior upon\n           encountering a bad line instead.\n    on_bad_lines : {'error', 'warn', 'skip'} or callable, default 'error'\n        Specifies what to do upon encountering a bad line (a line with too many fields).\n        Allowed values are :\n\n            - 'error', raise an Exception when a bad line is encountered.\n            - 'warn', raise a warning when a bad line is encountered and skip that line.\n            - 'skip', skip bad lines without raising or warning when they are encountered.\n\n        .. versionadded:: 1.3.0\n\n            - callable, function with signature\n              ``(bad_line: list[str]) -&gt; list[str] | None`` that will process a single\n              bad line. ``bad_line`` is a list of strings split by the ``sep``.\n              If the function returns ``None``, the bad line will be ignored.\n              If the function returns a new list of strings with more elements than\n              expected, a ``ParserWarning`` will be emitted while dropping extra elements.\n              Only supported when ``engine=\"python\"``\n\n        .. versionadded:: 1.4.0\n\n    delim_whitespace : bool, default False\n        Specifies whether or not whitespace (e.g. ``' '`` or ``'    '``) will be\n        used as the sep. Equivalent to setting ``sep='\\s+'``. If this option\n        is set to True, nothing should be passed in for the ``delimiter``\n        parameter.\n    low_memory : bool, default True\n        Internally process the file in chunks, resulting in lower memory use\n        while parsing, but possibly mixed type inference.  To ensure no mixed\n        types either set False, or specify the type with the `dtype` parameter.\n        Note that the entire file is read into a single DataFrame regardless,\n        use the `chunksize` or `iterator` parameter to return the data in chunks.\n        (Only valid with C parser).\n    memory_map : bool, default False\n        If a filepath is provided for `filepath_or_buffer`, map the file object\n        directly onto memory and access the data directly from there. Using this\n        option can improve performance because there is no longer any I/O overhead.\n    float_precision : str, optional\n        Specifies which converter the C engine should use for floating-point\n        values. The options are ``None`` or 'high' for the ordinary converter,\n        'legacy' for the original lower precision pandas converter, and\n        'round_trip' for the round-trip converter.\n\n        .. versionchanged:: 1.2\n\n    storage_options : dict, optional\n        Extra options that make sense for a particular storage connection, e.g.\n        host, port, username, password, etc. For HTTP(S) URLs the key-value pairs\n        are forwarded to ``urllib`` as header options. For other URLs (e.g.\n        starting with \"s3://\", and \"gcs://\") the key-value pairs are forwarded to\n        ``fsspec``. Please see ``fsspec`` and ``urllib`` for more details.\n\n        .. versionadded:: 1.2\n\n    Returns\n    -------\n    DataFrame or TextParser\n        A comma-separated values (csv) file is returned as two-dimensional\n        data structure with labeled axes.\n\n    See Also\n    --------\n    DataFrame.to_csv : Write DataFrame to a comma-separated values (csv) file.\n    read_csv : Read a comma-separated values (csv) file into DataFrame.\n    read_fwf : Read a table of fixed-width formatted lines into DataFrame.\n\n    Examples\n    --------\n    &gt;&gt;&gt; pd.read_csv('data.csv')  # doctest: +SKIP\nsample_df = pd.read_csv(sample_table_url, sep=\"\\t\")\nlibrary_df = pd.read_csv(library_table_url, sep=\"\\t\")\nsample_df.project_name.nunique()\n45\nlibrary_df.project_name.nunique()\n43\n\n10.8.1 Listing the columns of the sample dataframe\nsample_df.columns\nIndex(['project_name', 'publication_year', 'publication_doi', 'site_name',\n       'latitude', 'longitude', 'geo_loc_name', 'sample_name', 'sample_host',\n       'sample_age', 'sample_age_doi', 'community_type', 'material', 'archive',\n       'archive_project', 'archive_accession'],\n      dtype='object')\n\n\n10.8.2 Looking at the data type of the sample dataframe\nsample_df.dtypes\nproject_name          object\npublication_year       int64\npublication_doi       object\nsite_name             object\nlatitude             float64\nlongitude            float64\ngeo_loc_name          object\nsample_name           object\nsample_host           object\nsample_age             int64\nsample_age_doi        object\ncommunity_type        object\nmaterial              object\narchive               object\narchive_project       object\narchive_accession     object\ndtype: object\n\nint64 is for integers\nfloating64 is for floating point precision numbers, also known as double in some other programing languages\nobject is a general type in pandas for everything that is not a number, interval, categorical, or date\n\n\n\n10.8.3 Let‚Äôs inspect our data\nWhat is the size of our dataframe ?\nsample_df.shape\n(1060, 16)\nThis dataframe has 1060 rows, and 16 columns\nLet‚Äôs look at the first 5 rows\nsample_df.head()\n\n\n\n\n\n\n\n\n\nproject_name\n\n\npublication_year\n\n\npublication_doi\n\n\nsite_name\n\n\nlatitude\n\n\nlongitude\n\n\ngeo_loc_name\n\n\nsample_name\n\n\nsample_host\n\n\nsample_age\n\n\nsample_age_doi\n\n\ncommunity_type\n\n\nmaterial\n\n\narchive\n\n\narchive_project\n\n\narchive_accession\n\n\n\n\n\n\n0\n\n\nWarinner2014\n\n\n2014\n\n\n10.1038/ng.2906\n\n\nDalheim\n\n\n51.565\n\n\n8.840\n\n\nGermany\n\n\nB61\n\n\nHomo sapiens\n\n\n900\n\n\n10.1038/ng.2906\n\n\noral\n\n\ndental calculus\n\n\nSRA\n\n\nPRJNA216965\n\n\nSRS473742,SRS473743,SRS473744,SRS473745\n\n\n\n\n1\n\n\nWarinner2014\n\n\n2014\n\n\n10.1038/ng.2906\n\n\nDalheim\n\n\n51.565\n\n\n8.840\n\n\nGermany\n\n\nG12\n\n\nHomo sapiens\n\n\n900\n\n\n10.1038/ng.2906\n\n\noral\n\n\ndental calculus\n\n\nSRA\n\n\nPRJNA216965\n\n\nSRS473747,SRS473746,SRS473748,SRS473749,SRS473750\n\n\n\n\n2\n\n\nWeyrich2017\n\n\n2017\n\n\n10.1038/nature21674\n\n\nGola Forest\n\n\n7.657\n\n\n-10.841\n\n\nSierra Leone\n\n\nChimp\n\n\nPan troglodytes\n\n\n100\n\n\n10.1038/nature21674\n\n\noral\n\n\ndental calculus\n\n\nSRA\n\n\nPRJNA685265\n\n\nSRS7890499\n\n\n\n\n3\n\n\nWeyrich2017\n\n\n2017\n\n\n10.1038/nature21674\n\n\nEl Sidr√≥n Cave\n\n\n43.386\n\n\n-5.328\n\n\nSpain\n\n\nElSidron1\n\n\nHomo sapiens neanderthalensis\n\n\n49000\n\n\n10.1038/nature21674\n\n\noral\n\n\ndental calculus\n\n\nSRA\n\n\nPRJNA685265\n\n\nSRS7890498\n\n\n\n\n4\n\n\nWeyrich2017\n\n\n2017\n\n\n10.1038/nature21674\n\n\nEl Sidr√≥n Cave\n\n\n43.386\n\n\n-5.329\n\n\nSpain\n\n\nElSidron2\n\n\nHomo sapiens neanderthalensis\n\n\n49000\n\n\n10.1038/nature21674\n\n\noral\n\n\ndental calculus\n\n\nSRA\n\n\nPRJNA685265\n\n\nSRS7890496\n\n\n\n\n\n\nUnlike R, Python is 0 based language, meaning the first element is of index 0, not like R where it is 1.\nLet‚Äôs look at the last 5 rows\nsample_df.tail()\n\n\n\n\n\n\n\n\n\nproject_name\n\n\npublication_year\n\n\npublication_doi\n\n\nsite_name\n\n\nlatitude\n\n\nlongitude\n\n\ngeo_loc_name\n\n\nsample_name\n\n\nsample_host\n\n\nsample_age\n\n\nsample_age_doi\n\n\ncommunity_type\n\n\nmaterial\n\n\narchive\n\n\narchive_project\n\n\narchive_accession\n\n\n\n\n\n\n1055\n\n\nKazarina2021b\n\n\n2021\n\n\n10.1016/j.jasrep.2021.103213\n\n\nSt.¬†Gertrude‚Äôs Church, Riga\n\n\n56.958\n\n\n24.121\n\n\nLatvia\n\n\nT2\n\n\nHomo sapiens\n\n\n400\n\n\n10.1016/j.jasrep.2021.103213\n\n\noral\n\n\ntooth\n\n\nENA\n\n\nPRJEB47251\n\n\nERS7283094,ERS7283095\n\n\n\n\n1056\n\n\nKazarina2021b\n\n\n2021\n\n\n10.1016/j.jasrep.2021.103213\n\n\nSt.¬†Gertrude‚Äôs Church, Riga\n\n\n56.958\n\n\n24.121\n\n\nLatvia\n\n\nT3\n\n\nHomo sapiens\n\n\n400\n\n\n10.1016/j.jasrep.2021.103213\n\n\noral\n\n\ntooth\n\n\nENA\n\n\nPRJEB47251\n\n\nERS7283096,ERS7283097\n\n\n\n\n1057\n\n\nKazarina2021b\n\n\n2021\n\n\n10.1016/j.jasrep.2021.103213\n\n\nSt.¬†Gertrude‚Äôs Church, Riga\n\n\n56.958\n\n\n24.121\n\n\nLatvia\n\n\nT9\n\n\nHomo sapiens\n\n\n400\n\n\n10.1016/j.jasrep.2021.103213\n\n\noral\n\n\ntooth\n\n\nENA\n\n\nPRJEB47251\n\n\nERS7283098,ERS7283099\n\n\n\n\n1058\n\n\nKazarina2021b\n\n\n2021\n\n\n10.1016/j.jasrep.2021.103213\n\n\nDom Square, Riga\n\n\n56.949\n\n\n24.104\n\n\nLatvia\n\n\nTZA3\n\n\nHomo sapiens\n\n\n400\n\n\n10.1016/j.jasrep.2021.103213\n\n\noral\n\n\ntooth\n\n\nENA\n\n\nPRJEB47251\n\n\nERS7283100,ERS7283101\n\n\n\n\n1059\n\n\nKazarina2021b\n\n\n2021\n\n\n10.1016/j.jasrep.2021.103213\n\n\nSt.¬†Peter‚Äôs Church, Riga\n\n\n56.947\n\n\n24.109\n\n\nLatvia\n\n\nTZA4\n\n\nHomo sapiens\n\n\n500\n\n\n10.1016/j.jasrep.2021.103213\n\n\noral\n\n\ntooth\n\n\nENA\n\n\nPRJEB47251\n\n\nERS7283102,ERS7283103\n\n\n\n\n\n\nLet‚Äôs randomly inspect 5 rows\nsample_df.sample(n=5)\n\n\n\n\n\n\n\n\n\nproject_name\n\n\npublication_year\n\n\npublication_doi\n\n\nsite_name\n\n\nlatitude\n\n\nlongitude\n\n\ngeo_loc_name\n\n\nsample_name\n\n\nsample_host\n\n\nsample_age\n\n\nsample_age_doi\n\n\ncommunity_type\n\n\nmaterial\n\n\narchive\n\n\narchive_project\n\n\narchive_accession\n\n\n\n\n\n\n413\n\n\nNeukamm2020\n\n\n2020\n\n\n10.1186/s12915-020-00839-8\n\n\nAbusir el-Meleq\n\n\n29.240\n\n\n31.100\n\n\nEgypt\n\n\nAbusir1576\n\n\nHomo sapiens\n\n\n2200\n\n\n10.1038/ncomms15694\n\n\nskeletal tissue\n\n\nbone\n\n\nENA\n\n\nPRJEB33848\n\n\nERS3635981\n\n\n\n\n754\n\n\nRampelli2021\n\n\n2021\n\n\n10.1038/s42003-021-01689-y\n\n\nEl Salt\n\n\n38.687\n\n\n-0.508\n\n\nSpain\n\n\nV3\n\n\nHomo sapiens neanderthalensis\n\n\n44700\n\n\n10.1038/s42003-021-01689-y\n\n\ngut\n\n\nsediment\n\n\nENA\n\n\nPRJEB41665\n\n\nERS5428042\n\n\n\n\n436\n\n\nNeukamm2020\n\n\n2020\n\n\n10.1186/s12915-020-00839-8\n\n\nAbusir el-Meleq\n\n\n29.240\n\n\n31.100\n\n\nEgypt\n\n\nAbusir1606\n\n\nHomo sapiens\n\n\n2600\n\n\n10.1186/s12915-020-00839-8\n\n\nskeletal tissue\n\n\nbone\n\n\nENA\n\n\nPRJEB33848\n\n\nERS3635928\n\n\n\n\n474\n\n\nNeukamm2020\n\n\n2020\n\n\n10.1186/s12915-020-00839-8\n\n\nAbusir el-Meleq\n\n\n29.240\n\n\n31.100\n\n\nEgypt\n\n\nAbusir1654\n\n\nHomo sapiens\n\n\n2300\n\n\n10.1038/ncomms15694\n\n\noral\n\n\ntooth\n\n\nENA\n\n\nPRJEB33848\n\n\nERS3635960\n\n\n\n\n573\n\n\nPhilips2017\n\n\n2017\n\n\n10.1186/s12864-020-06810-9\n\n\nKowalewko\n\n\n52.699\n\n\n17.605\n\n\nPoland\n\n\nPCA0040\n\n\nHomo sapiens\n\n\n1900\n\n\n10.1186/s12864-020-06810-9\n\n\noral\n\n\ntooth\n\n\nSRA\n\n\nPRJNA354503\n\n\nSRS1815407\n\n\n\n\n\n\n\n10.8.3.0.0.1 Accessing the data by index/columns\nThe are different way of selecting of subset of a dataframe\nSelecting by the row index\n# selecting the 10th row, and all columns\nsample_df.iloc[9, :]\nproject_name                    Weyrich2017\npublication_year                       2017\npublication_doi         10.1038/nature21674\nsite_name            Stuttgart-M√ºhlhausen I\nlatitude                             48.839\nlongitude                             9.227\ngeo_loc_name                        Germany\nsample_name                        EuroLBK1\nsample_host                    Homo sapiens\nsample_age                             7400\nsample_age_doi          10.1038/nature21674\ncommunity_type                         oral\nmaterial                    dental calculus\narchive                                 SRA\narchive_project                 PRJNA685265\narchive_accession                SRS7890488\nName: 9, dtype: object\n# selecting the 10th to 12th row, and all columns\nsample_df.iloc[9:12, :]\n\n\n\n\n\n\n\n\n\nproject_name\n\n\npublication_year\n\n\npublication_doi\n\n\nsite_name\n\n\nlatitude\n\n\nlongitude\n\n\ngeo_loc_name\n\n\nsample_name\n\n\nsample_host\n\n\nsample_age\n\n\nsample_age_doi\n\n\ncommunity_type\n\n\nmaterial\n\n\narchive\n\n\narchive_project\n\n\narchive_accession\n\n\n\n\n\n\n9\n\n\nWeyrich2017\n\n\n2017\n\n\n10.1038/nature21674\n\n\nStuttgart-M√ºhlhausen I\n\n\n48.839\n\n\n9.227\n\n\nGermany\n\n\nEuroLBK1\n\n\nHomo sapiens\n\n\n7400\n\n\n10.1038/nature21674\n\n\noral\n\n\ndental calculus\n\n\nSRA\n\n\nPRJNA685265\n\n\nSRS7890488\n\n\n\n\n10\n\n\nWeyrich2017\n\n\n2017\n\n\n10.1038/nature21674\n\n\nStuttgart-M√ºhlhausen I\n\n\n48.839\n\n\n9.227\n\n\nGermany\n\n\nEuroLBK2\n\n\nHomo sapiens\n\n\n7400\n\n\n10.1038/nature21674\n\n\noral\n\n\ndental calculus\n\n\nSRA\n\n\nPRJNA685265\n\n\nSRS7890485\n\n\n\n\n11\n\n\nWeyrich2017\n\n\n2017\n\n\n10.1038/nature21674\n\n\nStuttgart-M√ºhlhausen I\n\n\n48.839\n\n\n9.227\n\n\nGermany\n\n\nEuroLBK3\n\n\nHomo sapiens\n\n\n7400\n\n\n10.1038/nature21674\n\n\noral\n\n\ndental calculus\n\n\nSRA\n\n\nPRJNA685265\n\n\nSRS7890490\n\n\n\n\n\n\n# selecting the 10th to 12th row, and the first to the 4th column\nsample_df.iloc[9:12, 0:4]\n\n\n\n\n\n\n\n\n\nproject_name\n\n\npublication_year\n\n\npublication_doi\n\n\nsite_name\n\n\n\n\n\n\n9\n\n\nWeyrich2017\n\n\n2017\n\n\n10.1038/nature21674\n\n\nStuttgart-M√ºhlhausen I\n\n\n\n\n10\n\n\nWeyrich2017\n\n\n2017\n\n\n10.1038/nature21674\n\n\nStuttgart-M√ºhlhausen I\n\n\n\n\n11\n\n\nWeyrich2017\n\n\n2017\n\n\n10.1038/nature21674\n\n\nStuttgart-M√ºhlhausen I\n\n\n\n\n\n\n# selecting the column site_name\nsample_df['site_name']\n0                           Dalheim\n1                           Dalheim\n2                       Gola Forest\n3                    El Sidr√≥n Cave\n4                    El Sidr√≥n Cave\n                   ...\n1055    St. Gertrude‚Äôs Church, Riga\n1056    St. Gertrude‚Äôs Church, Riga\n1057    St. Gertrude‚Äôs Church, Riga\n1058               Dom Square, Riga\n1059       St. Peter‚Äôs Church, Riga\nName: site_name, Length: 1060, dtype: object\n# Also valid, but less preferred\nsample_df.site_name\n0                           Dalheim\n1                           Dalheim\n2                       Gola Forest\n3                    El Sidr√≥n Cave\n4                    El Sidr√≥n Cave\n                   ...\n1055    St. Gertrude‚Äôs Church, Riga\n1056    St. Gertrude‚Äôs Church, Riga\n1057    St. Gertrude‚Äôs Church, Riga\n1058               Dom Square, Riga\n1059       St. Peter‚Äôs Church, Riga\nName: site_name, Length: 1060, dtype: object\n# Removing a row\nsample_df.drop(0)\n\n\n\n\n\n\n\n\n\nproject_name\n\n\npublication_year\n\n\npublication_doi\n\n\nsite_name\n\n\nlatitude\n\n\nlongitude\n\n\ngeo_loc_name\n\n\nsample_name\n\n\nsample_host\n\n\nsample_age\n\n\nsample_age_doi\n\n\ncommunity_type\n\n\nmaterial\n\n\narchive\n\n\narchive_project\n\n\narchive_accession\n\n\n\n\n\n\n1\n\n\nWarinner2014\n\n\n2014\n\n\n10.1038/ng.2906\n\n\nDalheim\n\n\n51.565\n\n\n8.840\n\n\nGermany\n\n\nG12\n\n\nHomo sapiens\n\n\n900\n\n\n10.1038/ng.2906\n\n\noral\n\n\ndental calculus\n\n\nSRA\n\n\nPRJNA216965\n\n\nSRS473747,SRS473746,SRS473748,SRS473749,SRS473750\n\n\n\n\n2\n\n\nWeyrich2017\n\n\n2017\n\n\n10.1038/nature21674\n\n\nGola Forest\n\n\n7.657\n\n\n-10.841\n\n\nSierra Leone\n\n\nChimp\n\n\nPan troglodytes\n\n\n100\n\n\n10.1038/nature21674\n\n\noral\n\n\ndental calculus\n\n\nSRA\n\n\nPRJNA685265\n\n\nSRS7890499\n\n\n\n\n3\n\n\nWeyrich2017\n\n\n2017\n\n\n10.1038/nature21674\n\n\nEl Sidr√≥n Cave\n\n\n43.386\n\n\n-5.328\n\n\nSpain\n\n\nElSidron1\n\n\nHomo sapiens neanderthalensis\n\n\n49000\n\n\n10.1038/nature21674\n\n\noral\n\n\ndental calculus\n\n\nSRA\n\n\nPRJNA685265\n\n\nSRS7890498\n\n\n\n\n4\n\n\nWeyrich2017\n\n\n2017\n\n\n10.1038/nature21674\n\n\nEl Sidr√≥n Cave\n\n\n43.386\n\n\n-5.329\n\n\nSpain\n\n\nElSidron2\n\n\nHomo sapiens neanderthalensis\n\n\n49000\n\n\n10.1038/nature21674\n\n\noral\n\n\ndental calculus\n\n\nSRA\n\n\nPRJNA685265\n\n\nSRS7890496\n\n\n\n\n5\n\n\nWeyrich2017\n\n\n2017\n\n\n10.1038/nature21674\n\n\nSpy Cave\n\n\n50.480\n\n\n4.674\n\n\nBelgium\n\n\nSpy1\n\n\nHomo sapiens neanderthalensis\n\n\n35800\n\n\n10.1038/nature21674\n\n\noral\n\n\ndental calculus\n\n\nSRA\n\n\nPRJNA685265\n\n\nSRS7890491\n\n\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n\n\n1055\n\n\nKazarina2021b\n\n\n2021\n\n\n10.1016/j.jasrep.2021.103213\n\n\nSt.¬†Gertrude‚Äôs Church, Riga\n\n\n56.958\n\n\n24.121\n\n\nLatvia\n\n\nT2\n\n\nHomo sapiens\n\n\n400\n\n\n10.1016/j.jasrep.2021.103213\n\n\noral\n\n\ntooth\n\n\nENA\n\n\nPRJEB47251\n\n\nERS7283094,ERS7283095\n\n\n\n\n1056\n\n\nKazarina2021b\n\n\n2021\n\n\n10.1016/j.jasrep.2021.103213\n\n\nSt.¬†Gertrude‚Äôs Church, Riga\n\n\n56.958\n\n\n24.121\n\n\nLatvia\n\n\nT3\n\n\nHomo sapiens\n\n\n400\n\n\n10.1016/j.jasrep.2021.103213\n\n\noral\n\n\ntooth\n\n\nENA\n\n\nPRJEB47251\n\n\nERS7283096,ERS7283097\n\n\n\n\n1057\n\n\nKazarina2021b\n\n\n2021\n\n\n10.1016/j.jasrep.2021.103213\n\n\nSt.¬†Gertrude‚Äôs Church, Riga\n\n\n56.958\n\n\n24.121\n\n\nLatvia\n\n\nT9\n\n\nHomo sapiens\n\n\n400\n\n\n10.1016/j.jasrep.2021.103213\n\n\noral\n\n\ntooth\n\n\nENA\n\n\nPRJEB47251\n\n\nERS7283098,ERS7283099\n\n\n\n\n1058\n\n\nKazarina2021b\n\n\n2021\n\n\n10.1016/j.jasrep.2021.103213\n\n\nDom Square, Riga\n\n\n56.949\n\n\n24.104\n\n\nLatvia\n\n\nTZA3\n\n\nHomo sapiens\n\n\n400\n\n\n10.1016/j.jasrep.2021.103213\n\n\noral\n\n\ntooth\n\n\nENA\n\n\nPRJEB47251\n\n\nERS7283100,ERS7283101\n\n\n\n\n1059\n\n\nKazarina2021b\n\n\n2021\n\n\n10.1016/j.jasrep.2021.103213\n\n\nSt.¬†Peter‚Äôs Church, Riga\n\n\n56.947\n\n\n24.109\n\n\nLatvia\n\n\nTZA4\n\n\nHomo sapiens\n\n\n500\n\n\n10.1016/j.jasrep.2021.103213\n\n\noral\n\n\ntooth\n\n\nENA\n\n\nPRJEB47251\n\n\nERS7283102,ERS7283103\n\n\n\n\n\n\n1059 rows √ó 16 columns\n\n\n# Removing a columm\nsample_df.drop('project_name', axis=1)\n\n\n\n\n\n\n\n\n\npublication_year\n\n\npublication_doi\n\n\nsite_name\n\n\nlatitude\n\n\nlongitude\n\n\ngeo_loc_name\n\n\nsample_name\n\n\nsample_host\n\n\nsample_age\n\n\nsample_age_doi\n\n\ncommunity_type\n\n\nmaterial\n\n\narchive\n\n\narchive_project\n\n\narchive_accession\n\n\n\n\n\n\n0\n\n\n2014\n\n\n10.1038/ng.2906\n\n\nDalheim\n\n\n51.565\n\n\n8.840\n\n\nGermany\n\n\nB61\n\n\nHomo sapiens\n\n\n900\n\n\n10.1038/ng.2906\n\n\noral\n\n\ndental calculus\n\n\nSRA\n\n\nPRJNA216965\n\n\nSRS473742,SRS473743,SRS473744,SRS473745\n\n\n\n\n1\n\n\n2014\n\n\n10.1038/ng.2906\n\n\nDalheim\n\n\n51.565\n\n\n8.840\n\n\nGermany\n\n\nG12\n\n\nHomo sapiens\n\n\n900\n\n\n10.1038/ng.2906\n\n\noral\n\n\ndental calculus\n\n\nSRA\n\n\nPRJNA216965\n\n\nSRS473747,SRS473746,SRS473748,SRS473749,SRS473750\n\n\n\n\n2\n\n\n2017\n\n\n10.1038/nature21674\n\n\nGola Forest\n\n\n7.657\n\n\n-10.841\n\n\nSierra Leone\n\n\nChimp\n\n\nPan troglodytes\n\n\n100\n\n\n10.1038/nature21674\n\n\noral\n\n\ndental calculus\n\n\nSRA\n\n\nPRJNA685265\n\n\nSRS7890499\n\n\n\n\n3\n\n\n2017\n\n\n10.1038/nature21674\n\n\nEl Sidr√≥n Cave\n\n\n43.386\n\n\n-5.328\n\n\nSpain\n\n\nElSidron1\n\n\nHomo sapiens neanderthalensis\n\n\n49000\n\n\n10.1038/nature21674\n\n\noral\n\n\ndental calculus\n\n\nSRA\n\n\nPRJNA685265\n\n\nSRS7890498\n\n\n\n\n4\n\n\n2017\n\n\n10.1038/nature21674\n\n\nEl Sidr√≥n Cave\n\n\n43.386\n\n\n-5.329\n\n\nSpain\n\n\nElSidron2\n\n\nHomo sapiens neanderthalensis\n\n\n49000\n\n\n10.1038/nature21674\n\n\noral\n\n\ndental calculus\n\n\nSRA\n\n\nPRJNA685265\n\n\nSRS7890496\n\n\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n\n\n1055\n\n\n2021\n\n\n10.1016/j.jasrep.2021.103213\n\n\nSt.¬†Gertrude‚Äôs Church, Riga\n\n\n56.958\n\n\n24.121\n\n\nLatvia\n\n\nT2\n\n\nHomo sapiens\n\n\n400\n\n\n10.1016/j.jasrep.2021.103213\n\n\noral\n\n\ntooth\n\n\nENA\n\n\nPRJEB47251\n\n\nERS7283094,ERS7283095\n\n\n\n\n1056\n\n\n2021\n\n\n10.1016/j.jasrep.2021.103213\n\n\nSt.¬†Gertrude‚Äôs Church, Riga\n\n\n56.958\n\n\n24.121\n\n\nLatvia\n\n\nT3\n\n\nHomo sapiens\n\n\n400\n\n\n10.1016/j.jasrep.2021.103213\n\n\noral\n\n\ntooth\n\n\nENA\n\n\nPRJEB47251\n\n\nERS7283096,ERS7283097\n\n\n\n\n1057\n\n\n2021\n\n\n10.1016/j.jasrep.2021.103213\n\n\nSt.¬†Gertrude‚Äôs Church, Riga\n\n\n56.958\n\n\n24.121\n\n\nLatvia\n\n\nT9\n\n\nHomo sapiens\n\n\n400\n\n\n10.1016/j.jasrep.2021.103213\n\n\noral\n\n\ntooth\n\n\nENA\n\n\nPRJEB47251\n\n\nERS7283098,ERS7283099\n\n\n\n\n1058\n\n\n2021\n\n\n10.1016/j.jasrep.2021.103213\n\n\nDom Square, Riga\n\n\n56.949\n\n\n24.104\n\n\nLatvia\n\n\nTZA3\n\n\nHomo sapiens\n\n\n400\n\n\n10.1016/j.jasrep.2021.103213\n\n\noral\n\n\ntooth\n\n\nENA\n\n\nPRJEB47251\n\n\nERS7283100,ERS7283101\n\n\n\n\n1059\n\n\n2021\n\n\n10.1016/j.jasrep.2021.103213\n\n\nSt.¬†Peter‚Äôs Church, Riga\n\n\n56.947\n\n\n24.109\n\n\nLatvia\n\n\nTZA4\n\n\nHomo sapiens\n\n\n500\n\n\n10.1016/j.jasrep.2021.103213\n\n\noral\n\n\ntooth\n\n\nENA\n\n\nPRJEB47251\n\n\nERS7283102,ERS7283103\n\n\n\n\n\n\n1060 rows √ó 15 columns\n\n\n\n\n10.8.3.0.1 4 - Dealing with missing data\nChecking is some entries if the table have missing data (NA or NaN)\nsample_df.isna()\n\n\n\n\n\n\n\n\n\nproject_name\n\n\npublication_year\n\n\npublication_doi\n\n\nsite_name\n\n\nlatitude\n\n\nlongitude\n\n\ngeo_loc_name\n\n\nsample_name\n\n\nsample_host\n\n\nsample_age\n\n\nsample_age_doi\n\n\ncommunity_type\n\n\nmaterial\n\n\narchive\n\n\narchive_project\n\n\narchive_accession\n\n\n\n\n\n\n0\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\n\n\n1\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\n\n\n2\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\n\n\n3\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\n\n\n4\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n\n\n1055\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\n\n\n1056\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\n\n\n1057\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\n\n\n1058\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\n\n\n1059\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\nFalse\n\n\n\n\n\n\n1060 rows √ó 16 columns\n\n\n# making the sum by row - axis=1\nsample_df.isna().sum(axis=1)\n0       0\n1       0\n2       0\n3       0\n4       0\n       ..\n1055    0\n1056    0\n1057    0\n1058    0\n1059    0\nLength: 1060, dtype: int64\nSorting by decreasing order to check which rows have missing values\nsample_df.isna().sum(axis=1).sort_values(ascending=False)\n800     2\n962     2\n992     2\n801     2\n802     2\n       ..\n362     0\n363     0\n364     0\n365     0\n1059    0\nLength: 1060, dtype: int64\nsample_df.iloc[800,:]\nproject_name                         FellowsYates2021\npublication_year                                 2021\npublication_doi               10.1073/pnas.2021655118\nsite_name                               Not specified\nlatitude                                          NaN\nlongitude                                         NaN\ngeo_loc_name         Democratic Republic of the Congo\nsample_name                                  GDC002.A\nsample_host                   Gorilla gorilla gorilla\nsample_age                                        200\nsample_age_doi                10.1073/pnas.2021655118\ncommunity_type                                   oral\nmaterial                              dental calculus\narchive                                           ENA\narchive_project                            PRJEB34569\narchive_accession                          ERS3774403\nName: 800, dtype: object\nWhat to do now ? The ideal scenario would be to correct or impute the data.\nHowever, sometimes, the only thing we can do is remove the row with missing data, with the .dropna() function.\nHere, we‚Äôre just going to ignore them, and deal with it individually if necessary"
  },
  {
    "objectID": "introduction-to-python.html#computing-basic-statistics",
    "href": "introduction-to-python.html#computing-basic-statistics",
    "title": "10¬† Introduction to Python and Pandas",
    "section": "10.9 5 - Computing basic statistics",
    "text": "10.9 5 - Computing basic statistics\nTLDR: use the describe() function, the equivalent of summarize in R\nsample_df.describe()\n\n\n\n\n\n\n\n\n\npublication_year\n\n\nlatitude\n\n\nlongitude\n\n\nsample_age\n\n\n\n\n\n\ncount\n\n\n1060.000000\n\n\n1021.000000\n\n\n1021.000000\n\n\n1060.000000\n\n\n\n\nmean\n\n\n2019.377358\n\n\n40.600493\n\n\n3.749624\n\n\n3588.443396\n\n\n\n\nstd\n\n\n1.633877\n\n\n18.469421\n\n\n43.790316\n\n\n9862.416855\n\n\n\n\nmin\n\n\n2014.000000\n\n\n-34.030000\n\n\n-121.800000\n\n\n100.000000\n\n\n\n\n25%\n\n\n2018.000000\n\n\n29.240000\n\n\n-1.257000\n\n\n200.000000\n\n\n\n\n50%\n\n\n2020.000000\n\n\n45.450000\n\n\n14.381000\n\n\n1000.000000\n\n\n\n\n75%\n\n\n2021.000000\n\n\n52.699000\n\n\n23.892000\n\n\n2200.000000\n\n\n\n\nmax\n\n\n2021.000000\n\n\n79.000000\n\n\n159.346000\n\n\n102000.000000\n\n\n\n\n\n\nLet‚Äôs look at various individual summary statistics We can run them on the whole dataframe (for int or float columns), or on a subset of columns\nsample_df.mean()\n/var/folders/1c/l1qb09f15jddsh65f6xv1n_r0000gp/T/ipykernel_69168/2260452167.py:1:\nFutureWarning: Dropping of nuisance columns in DataFrame reductions (with 'numeric_only=None')\nis deprecated; in a future version this will raise TypeError.  Select only valid columns\nbefore calling the reduction.\n\n\n\n\n\npublication_year    2019.377358\nlatitude              40.600493\nlongitude              3.749624\nsample_age          3588.443396\ndtype: float64\nsample_df['publication_year'].describe()\ncount    1060.000000\nmean     2019.377358\nstd         1.633877\nmin      2014.000000\n25%      2018.000000\n50%      2020.000000\n75%      2021.000000\nmax      2021.000000\nName: publication_year, dtype: float64\n# The average publication year\nsample_df['publication_year'].mean()\n2019.377358490566\n# The median publication year\nsample_df['publication_year'].median()\n2020.0\n# The minimum, or oldest publication year\nsample_df['publication_year'].min()\n2014\n# The maximum, or most recent publication year\nsample_df['publication_year'].max()\n2021\n# The number of sites\nsample_df['site_name'].nunique()\n246\n# The number of samples from the different hosts\nsample_df['sample_host'].value_counts()\nHomo sapiens                      741\nUrsus arctos                       85\nAmbrosia artemisiifolia            46\nArabidopsis thaliana               34\nHomo sapiens neanderthalensis      32\nPan troglodytes schweinfurthii     26\nGorilla beringei beringei          15\nCanis lupus                        12\nGorilla gorilla gorilla             8\nMammuthus primigenius               8\nPan troglodytes verus               7\nRangifer tarandus                   6\nGorilla beringei graueri            6\nPan troglodytes ellioti             6\nPapio hamadryas                     5\nAlouatta palliata                   5\nConepatus chinga                    4\nGerbilliscus boehmi                 4\nStrigocuscus celebensis             4\nPapio anubis                        2\nGorilla beringei                    2\nPapio sp.                           1\nPan troglodytes                     1\nName: sample_host, dtype: int64\n# The quantile of the publication years\nsample_df['publication_year'].quantile(np.arange(0,1,0.1))\n0.0    2014.0\n0.1    2017.0\n0.2    2018.0\n0.3    2018.0\n0.4    2020.0\n0.5    2020.0\n0.6    2020.0\n0.7    2021.0\n0.8    2021.0\n0.9    2021.0\nName: publication_year, dtype: float64\n# We can also visualize it with built-in plot functions of pandas\nsample_df['publication_year'].plot.hist()\n&lt;AxesSubplot:ylabel='Frequency'&gt;\n\n\n\npng"
  },
  {
    "objectID": "introduction-to-python.html#filtering",
    "href": "introduction-to-python.html#filtering",
    "title": "10¬† Introduction to Python and Pandas",
    "section": "10.10 6 - Filtering",
    "text": "10.10 6 - Filtering\nThere are different ways of filtering data with Pandas:\n\nThe classic method with bracket indexing/subsetting\nThe query() method\n\nThe classic method\n# Getting all the publications before 2015\nsample_df[sample_df['publication_year']  &lt; 2015 ]\n\n\n\n\n\n\n\n\n\nproject_name\n\n\npublication_year\n\n\npublication_doi\n\n\nsite_name\n\n\nlatitude\n\n\nlongitude\n\n\ngeo_loc_name\n\n\nsample_name\n\n\nsample_host\n\n\nsample_age\n\n\nsample_age_doi\n\n\ncommunity_type\n\n\nmaterial\n\n\narchive\n\n\narchive_project\n\n\narchive_accession\n\n\n\n\n\n\n0\n\n\nWarinner2014\n\n\n2014\n\n\n10.1038/ng.2906\n\n\nDalheim\n\n\n51.565\n\n\n8.84\n\n\nGermany\n\n\nB61\n\n\nHomo sapiens\n\n\n900\n\n\n10.1038/ng.2906\n\n\noral\n\n\ndental calculus\n\n\nSRA\n\n\nPRJNA216965\n\n\nSRS473742,SRS473743,SRS473744,SRS473745\n\n\n\n\n1\n\n\nWarinner2014\n\n\n2014\n\n\n10.1038/ng.2906\n\n\nDalheim\n\n\n51.565\n\n\n8.84\n\n\nGermany\n\n\nG12\n\n\nHomo sapiens\n\n\n900\n\n\n10.1038/ng.2906\n\n\noral\n\n\ndental calculus\n\n\nSRA\n\n\nPRJNA216965\n\n\nSRS473747,SRS473746,SRS473748,SRS473749,SRS473750\n\n\n\n\n272\n\n\nCampana2014\n\n\n2014\n\n\n10.1186/1756-0500-7-111\n\n\nTeposcolula Yucundaa\n\n\n17.490\n\n\n-97.46\n\n\nMexico\n\n\nTP4\n\n\nHomo sapiens\n\n\n400\n\n\n10.7183/1045-6635.23.4.467\n\n\nskeletal tissue\n\n\nbone\n\n\nSRA\n\n\nPRJNA205039\n\n\nSRS428959\n\n\n\n\n273\n\n\nCampana2014\n\n\n2014\n\n\n10.1186/1756-0500-7-111\n\n\nTeposcolula Yucundaa\n\n\n17.490\n\n\n-97.46\n\n\nMexico\n\n\nTP10\n\n\nHomo sapiens\n\n\n400\n\n\n10.7183/1045-6635.23.4.467\n\n\nskeletal tissue\n\n\nbone\n\n\nSRA\n\n\nPRJNA205039\n\n\nSRS428961\n\n\n\n\n274\n\n\nCampana2014\n\n\n2014\n\n\n10.1186/1756-0500-7-111\n\n\nTeposcolula Yucundaa\n\n\n17.490\n\n\n-97.46\n\n\nMexico\n\n\nTP18\n\n\nHomo sapiens\n\n\n400\n\n\n10.7183/1045-6635.23.4.467\n\n\nskeletal tissue\n\n\nbone\n\n\nSRA\n\n\nPRJNA205039\n\n\nSRS428962\n\n\n\n\n275\n\n\nCampana2014\n\n\n2014\n\n\n10.1186/1756-0500-7-111\n\n\nTeposcolula Yucundaa\n\n\n17.490\n\n\n-97.46\n\n\nMexico\n\n\nTP37\n\n\nHomo sapiens\n\n\n400\n\n\n10.7183/1045-6635.23.4.467\n\n\nskeletal tissue\n\n\nbone\n\n\nSRA\n\n\nPRJNA205039\n\n\nSRS428963\n\n\n\n\n276\n\n\nCampana2014\n\n\n2014\n\n\n10.1186/1756-0500-7-111\n\n\nTeposcolula Yucundaa\n\n\n17.490\n\n\n-97.46\n\n\nMexico\n\n\nTP9\n\n\nHomo sapiens\n\n\n400\n\n\n10.7183/1045-6635.23.4.467\n\n\nskeletal tissue\n\n\nbone\n\n\nSRA\n\n\nPRJNA205039\n\n\nSRS428960\n\n\n\n\n277\n\n\nCampana2014\n\n\n2014\n\n\n10.1186/1756-0500-7-111\n\n\nTeposcolula Yucundaa\n\n\n17.490\n\n\n-97.46\n\n\nMexico\n\n\nTP48\n\n\nHomo sapiens\n\n\n400\n\n\n10.7183/1045-6635.23.4.467\n\n\nskeletal tissue\n\n\nbone\n\n\nSRA\n\n\nPRJNA205039\n\n\nSRS428964\n\n\n\n\n278\n\n\nCampana2014\n\n\n2014\n\n\n10.1186/1756-0500-7-111\n\n\nTeposcolula Yucundaa\n\n\n17.490\n\n\n-97.46\n\n\nMexico\n\n\nTP02,TP10,TP15,TP26\n\n\nHomo sapiens\n\n\n400\n\n\n10.7183/1045-6635.23.4.467\n\n\nskeletal tissue\n\n\nbone\n\n\nSRA\n\n\nPRJNA205039\n\n\nSRS428958\n\n\n\n\n279\n\n\nCampana2014\n\n\n2014\n\n\n10.1186/1756-0500-7-111\n\n\nTeposcolula Yucundaa\n\n\n17.490\n\n\n-97.46\n\n\nMexico\n\n\nTP32,TP42,TP45,TP48\n\n\nHomo sapiens\n\n\n400\n\n\n10.7183/1045-6635.23.4.467\n\n\nskeletal tissue\n\n\nbone\n\n\nSRA\n\n\nPRJNA205039\n\n\nSRS428972\n\n\n\n\n500\n\n\nAppelt2014\n\n\n2014\n\n\n10.1128/AEM.03242-13\n\n\nPlace d‚ÄôArmes, Namur\n\n\n50.460\n\n\n4.86\n\n\nBelgium\n\n\n4.453\n\n\nHomo sapiens\n\n\n600\n\n\n10.1128/AEM.03242-13\n\n\ngut\n\n\npalaeofaeces\n\n\nSRA\n\n\nPRJNA230469\n\n\nSRS510175\n\n\n\n\n\n\n# Getting all the publications before 2015, only in the Northern hemisphere\nsample_df[(sample_df['publication_year']  &lt; 2015) & (sample_df['longitude'] &gt; 0)]\n\n\n\n\n\n\n\n\n\nproject_name\n\n\npublication_year\n\n\npublication_doi\n\n\nsite_name\n\n\nlatitude\n\n\nlongitude\n\n\ngeo_loc_name\n\n\nsample_name\n\n\nsample_host\n\n\nsample_age\n\n\nsample_age_doi\n\n\ncommunity_type\n\n\nmaterial\n\n\narchive\n\n\narchive_project\n\n\narchive_accession\n\n\n\n\n\n\n0\n\n\nWarinner2014\n\n\n2014\n\n\n10.1038/ng.2906\n\n\nDalheim\n\n\n51.565\n\n\n8.84\n\n\nGermany\n\n\nB61\n\n\nHomo sapiens\n\n\n900\n\n\n10.1038/ng.2906\n\n\noral\n\n\ndental calculus\n\n\nSRA\n\n\nPRJNA216965\n\n\nSRS473742,SRS473743,SRS473744,SRS473745\n\n\n\n\n1\n\n\nWarinner2014\n\n\n2014\n\n\n10.1038/ng.2906\n\n\nDalheim\n\n\n51.565\n\n\n8.84\n\n\nGermany\n\n\nG12\n\n\nHomo sapiens\n\n\n900\n\n\n10.1038/ng.2906\n\n\noral\n\n\ndental calculus\n\n\nSRA\n\n\nPRJNA216965\n\n\nSRS473747,SRS473746,SRS473748,SRS473749,SRS473750\n\n\n\n\n500\n\n\nAppelt2014\n\n\n2014\n\n\n10.1128/AEM.03242-13\n\n\nPlace d‚ÄôArmes, Namur\n\n\n50.460\n\n\n4.86\n\n\nBelgium\n\n\n4.453\n\n\nHomo sapiens\n\n\n600\n\n\n10.1128/AEM.03242-13\n\n\ngut\n\n\npalaeofaeces\n\n\nSRA\n\n\nPRJNA230469\n\n\nSRS510175\n\n\n\n\n\n\nThis syntax can rapidly become quite cumbersome, which is why we can also use the query() method\n# Getting all the publications before 2015\nsample_df.query(\"publication_year &lt; 2015\")\n\n\n\n\n\n\n\n\n\nproject_name\n\n\npublication_year\n\n\npublication_doi\n\n\nsite_name\n\n\nlatitude\n\n\nlongitude\n\n\ngeo_loc_name\n\n\nsample_name\n\n\nsample_host\n\n\nsample_age\n\n\nsample_age_doi\n\n\ncommunity_type\n\n\nmaterial\n\n\narchive\n\n\narchive_project\n\n\narchive_accession\n\n\n\n\n\n\n0\n\n\nWarinner2014\n\n\n2014\n\n\n10.1038/ng.2906\n\n\nDalheim\n\n\n51.565\n\n\n8.84\n\n\nGermany\n\n\nB61\n\n\nHomo sapiens\n\n\n900\n\n\n10.1038/ng.2906\n\n\noral\n\n\ndental calculus\n\n\nSRA\n\n\nPRJNA216965\n\n\nSRS473742,SRS473743,SRS473744,SRS473745\n\n\n\n\n1\n\n\nWarinner2014\n\n\n2014\n\n\n10.1038/ng.2906\n\n\nDalheim\n\n\n51.565\n\n\n8.84\n\n\nGermany\n\n\nG12\n\n\nHomo sapiens\n\n\n900\n\n\n10.1038/ng.2906\n\n\noral\n\n\ndental calculus\n\n\nSRA\n\n\nPRJNA216965\n\n\nSRS473747,SRS473746,SRS473748,SRS473749,SRS473750\n\n\n\n\n272\n\n\nCampana2014\n\n\n2014\n\n\n10.1186/1756-0500-7-111\n\n\nTeposcolula Yucundaa\n\n\n17.490\n\n\n-97.46\n\n\nMexico\n\n\nTP4\n\n\nHomo sapiens\n\n\n400\n\n\n10.7183/1045-6635.23.4.467\n\n\nskeletal tissue\n\n\nbone\n\n\nSRA\n\n\nPRJNA205039\n\n\nSRS428959\n\n\n\n\n273\n\n\nCampana2014\n\n\n2014\n\n\n10.1186/1756-0500-7-111\n\n\nTeposcolula Yucundaa\n\n\n17.490\n\n\n-97.46\n\n\nMexico\n\n\nTP10\n\n\nHomo sapiens\n\n\n400\n\n\n10.7183/1045-6635.23.4.467\n\n\nskeletal tissue\n\n\nbone\n\n\nSRA\n\n\nPRJNA205039\n\n\nSRS428961\n\n\n\n\n274\n\n\nCampana2014\n\n\n2014\n\n\n10.1186/1756-0500-7-111\n\n\nTeposcolula Yucundaa\n\n\n17.490\n\n\n-97.46\n\n\nMexico\n\n\nTP18\n\n\nHomo sapiens\n\n\n400\n\n\n10.7183/1045-6635.23.4.467\n\n\nskeletal tissue\n\n\nbone\n\n\nSRA\n\n\nPRJNA205039\n\n\nSRS428962\n\n\n\n\n275\n\n\nCampana2014\n\n\n2014\n\n\n10.1186/1756-0500-7-111\n\n\nTeposcolula Yucundaa\n\n\n17.490\n\n\n-97.46\n\n\nMexico\n\n\nTP37\n\n\nHomo sapiens\n\n\n400\n\n\n10.7183/1045-6635.23.4.467\n\n\nskeletal tissue\n\n\nbone\n\n\nSRA\n\n\nPRJNA205039\n\n\nSRS428963\n\n\n\n\n276\n\n\nCampana2014\n\n\n2014\n\n\n10.1186/1756-0500-7-111\n\n\nTeposcolula Yucundaa\n\n\n17.490\n\n\n-97.46\n\n\nMexico\n\n\nTP9\n\n\nHomo sapiens\n\n\n400\n\n\n10.7183/1045-6635.23.4.467\n\n\nskeletal tissue\n\n\nbone\n\n\nSRA\n\n\nPRJNA205039\n\n\nSRS428960\n\n\n\n\n277\n\n\nCampana2014\n\n\n2014\n\n\n10.1186/1756-0500-7-111\n\n\nTeposcolula Yucundaa\n\n\n17.490\n\n\n-97.46\n\n\nMexico\n\n\nTP48\n\n\nHomo sapiens\n\n\n400\n\n\n10.7183/1045-6635.23.4.467\n\n\nskeletal tissue\n\n\nbone\n\n\nSRA\n\n\nPRJNA205039\n\n\nSRS428964\n\n\n\n\n278\n\n\nCampana2014\n\n\n2014\n\n\n10.1186/1756-0500-7-111\n\n\nTeposcolula Yucundaa\n\n\n17.490\n\n\n-97.46\n\n\nMexico\n\n\nTP02,TP10,TP15,TP26\n\n\nHomo sapiens\n\n\n400\n\n\n10.7183/1045-6635.23.4.467\n\n\nskeletal tissue\n\n\nbone\n\n\nSRA\n\n\nPRJNA205039\n\n\nSRS428958\n\n\n\n\n279\n\n\nCampana2014\n\n\n2014\n\n\n10.1186/1756-0500-7-111\n\n\nTeposcolula Yucundaa\n\n\n17.490\n\n\n-97.46\n\n\nMexico\n\n\nTP32,TP42,TP45,TP48\n\n\nHomo sapiens\n\n\n400\n\n\n10.7183/1045-6635.23.4.467\n\n\nskeletal tissue\n\n\nbone\n\n\nSRA\n\n\nPRJNA205039\n\n\nSRS428972\n\n\n\n\n500\n\n\nAppelt2014\n\n\n2014\n\n\n10.1128/AEM.03242-13\n\n\nPlace d‚ÄôArmes, Namur\n\n\n50.460\n\n\n4.86\n\n\nBelgium\n\n\n4.453\n\n\nHomo sapiens\n\n\n600\n\n\n10.1128/AEM.03242-13\n\n\ngut\n\n\npalaeofaeces\n\n\nSRA\n\n\nPRJNA230469\n\n\nSRS510175\n\n\n\n\n\n\n# Getting all the publications before 2015, only the Northern hemisphere\nsample_df.query(\"publication_year &lt; 2015 and longitude &gt; 0 \")\n\n\n\n\n\n\n\n\n\nproject_name\n\n\npublication_year\n\n\npublication_doi\n\n\nsite_name\n\n\nlatitude\n\n\nlongitude\n\n\ngeo_loc_name\n\n\nsample_name\n\n\nsample_host\n\n\nsample_age\n\n\nsample_age_doi\n\n\ncommunity_type\n\n\nmaterial\n\n\narchive\n\n\narchive_project\n\n\narchive_accession\n\n\n\n\n\n\n0\n\n\nWarinner2014\n\n\n2014\n\n\n10.1038/ng.2906\n\n\nDalheim\n\n\n51.565\n\n\n8.84\n\n\nGermany\n\n\nB61\n\n\nHomo sapiens\n\n\n900\n\n\n10.1038/ng.2906\n\n\noral\n\n\ndental calculus\n\n\nSRA\n\n\nPRJNA216965\n\n\nSRS473742,SRS473743,SRS473744,SRS473745\n\n\n\n\n1\n\n\nWarinner2014\n\n\n2014\n\n\n10.1038/ng.2906\n\n\nDalheim\n\n\n51.565\n\n\n8.84\n\n\nGermany\n\n\nG12\n\n\nHomo sapiens\n\n\n900\n\n\n10.1038/ng.2906\n\n\noral\n\n\ndental calculus\n\n\nSRA\n\n\nPRJNA216965\n\n\nSRS473747,SRS473746,SRS473748,SRS473749,SRS473750\n\n\n\n\n500\n\n\nAppelt2014\n\n\n2014\n\n\n10.1128/AEM.03242-13\n\n\nPlace d‚ÄôArmes, Namur\n\n\n50.460\n\n\n4.86\n\n\nBelgium\n\n\n4.453\n\n\nHomo sapiens\n\n\n600\n\n\n10.1128/AEM.03242-13\n\n\ngut\n\n\npalaeofaeces\n\n\nSRA\n\n\nPRJNA230469\n\n\nSRS510175"
  },
  {
    "objectID": "introduction-to-python.html#groupby-operations-and-computing-statistics-on-grouped-values",
    "href": "introduction-to-python.html#groupby-operations-and-computing-statistics-on-grouped-values",
    "title": "10¬† Introduction to Python and Pandas",
    "section": "10.11 7 - GroupBy operations, and computing statistics on grouped values",
    "text": "10.11 7 - GroupBy operations, and computing statistics on grouped values\nThe ‚ÄúgroupBy‚Äù operation, as the name suggests, allows us to group values by a grouping key, and perform a groupwise operation.\nFor example, we can group by the sample_host and get the age of the youngest sample in each group\nsample_df.groupby(\"sample_host\")['sample_age'].min()\nsample_host\nAlouatta palliata                   200\nAmbrosia artemisiifolia             100\nArabidopsis thaliana                100\nCanis lupus                         400\nConepatus chinga                    100\nGerbilliscus boehmi                 100\nGorilla beringei                    100\nGorilla beringei beringei           200\nGorilla beringei graueri            200\nGorilla gorilla gorilla             200\nHomo sapiens                        100\nHomo sapiens neanderthalensis     35800\nMammuthus primigenius             41800\nPan troglodytes                     100\nPan troglodytes ellioti             200\nPan troglodytes schweinfurthii      100\nPan troglodytes verus               200\nPapio anubis                        100\nPapio hamadryas                     100\nPapio sp.                           100\nRangifer tarandus                   100\nStrigocuscus celebensis             100\nUrsus arctos                        100\nName: sample_age, dtype: int64\nHere min() is a so-called aggregation function\n\nNotice that .value_counts() is actually a special case of .groupby()\nsample_df.groupby(\"sample_host\")[\"sample_host\"].count()\nsample_host\nAlouatta palliata                   5\nAmbrosia artemisiifolia            46\nArabidopsis thaliana               34\nCanis lupus                        12\nConepatus chinga                    4\nGerbilliscus boehmi                 4\nGorilla beringei                    2\nGorilla beringei beringei          15\nGorilla beringei graueri            6\nGorilla gorilla gorilla             8\nHomo sapiens                      741\nHomo sapiens neanderthalensis      32\nMammuthus primigenius               8\nPan troglodytes                     1\nPan troglodytes ellioti             6\nPan troglodytes schweinfurthii     26\nPan troglodytes verus               7\nPapio anubis                        2\nPapio hamadryas                     5\nPapio sp.                           1\nRangifer tarandus                   6\nStrigocuscus celebensis             4\nUrsus arctos                       85\nName: sample_host, dtype: int64"
  },
  {
    "objectID": "introduction-to-python.html#reshaping-data-from-wide-to-long-and-back",
    "href": "introduction-to-python.html#reshaping-data-from-wide-to-long-and-back",
    "title": "10¬† Introduction to Python and Pandas",
    "section": "10.12 8 - Reshaping data, from wide to long and back",
    "text": "10.12 8 - Reshaping data, from wide to long and back\n\n\n10.12.1 From wide to long/tidy\nThe tidy format, or long format idea is that one column = one kind of data.\nUnfortunately for this tutorial, the AncientMetagenomeDir tables are already in the tidy format (good), so we‚Äôll see an example or the wide format just below\nwide_df = pd.DataFrame(\n    [\n    [150,155,157,160],\n    [149,153,154,155]\n    ]\n    , index = ['John','Jack']\n    , columns = [1991,1992,1993, 1994]\n).rename_axis('individual').reset_index()\nwide_df\n\n\n\n\n\n\n\n\n\nindividual\n\n\n1991\n\n\n1992\n\n\n1993\n\n\n1994\n\n\n\n\n\n\n0\n\n\nJohn\n\n\n150\n\n\n155\n\n\n157\n\n\n160\n\n\n\n\n1\n\n\nJack\n\n\n149\n\n\n153\n\n\n154\n\n\n155\n\n\n\n\n\n\nIn this hypothetic dataframe, we have the years as column, the individual as index, and their height as value.\nWe‚Äôll reformat to the tidy/long format using the .melt() function\ntidy_df = wide_df.melt(id_vars='individual', var_name='birthyear', value_name='height')\ntidy_df\n\n\n\n\n\n\n\n\n\nindividual\n\n\nbirthyear\n\n\nheight\n\n\n\n\n\n\n0\n\n\nJohn\n\n\n1991\n\n\n150\n\n\n\n\n1\n\n\nJack\n\n\n1991\n\n\n149\n\n\n\n\n2\n\n\nJohn\n\n\n1992\n\n\n155\n\n\n\n\n3\n\n\nJack\n\n\n1992\n\n\n153\n\n\n\n\n4\n\n\nJohn\n\n\n1993\n\n\n157\n\n\n\n\n5\n\n\nJack\n\n\n1993\n\n\n154\n\n\n\n\n6\n\n\nJohn\n\n\n1994\n\n\n160\n\n\n\n\n7\n\n\nJack\n\n\n1994\n\n\n155\n\n\n\n\n\n\n\nBonus: How to deal with a dataframe with the kind of data indicated in the column name, typically like so\n\nwide_df = pd.DataFrame(\n    [\n    [150,155,157,160],\n    [149,153,154,155]\n    ]\n    , index = ['John','Jack']\n    , columns = [\"year-1991\",\"year-1992\",\"year-1993\", \"year-1994\"]\n).rename_axis('individual').reset_index()\nwide_df\n\n\n\n\n\n\n\n\n\nindividual\n\n\nyear-1991\n\n\nyear-1992\n\n\nyear-1993\n\n\nyear-1994\n\n\n\n\n\n\n0\n\n\nJohn\n\n\n150\n\n\n155\n\n\n157\n\n\n160\n\n\n\n\n1\n\n\nJack\n\n\n149\n\n\n153\n\n\n154\n\n\n155\n\n\n\n\n\n\npd.wide_to_long(wide_df, ['year'], i='individual', j='birthyear', sep=\"-\").rename(columns={'year':'height'})\n\n\n\n\n\n\n\n\n\n\n\nheight\n\n\n\n\nindividual\n\n\nbirthyear\n\n\n\n\n\n\n\n\nJohn\n\n\n1991\n\n\n150\n\n\n\n\nJack\n\n\n1991\n\n\n149\n\n\n\n\nJohn\n\n\n1992\n\n\n155\n\n\n\n\nJack\n\n\n1992\n\n\n153\n\n\n\n\nJohn\n\n\n1993\n\n\n157\n\n\n\n\nJack\n\n\n1993\n\n\n154\n\n\n\n\nJohn\n\n\n1994\n\n\n160\n\n\n\n\nJack\n\n\n1994\n\n\n155\n\n\n\n\n\n\n\n\n10.12.2 From long/tidy to wide format using the .pivot() function.\ntidy_df.pivot(index='individual', columns='birthyear', values='height')\n/Users/maxime/mambaforge/envs/intro-data/lib/python3.10/site-packages/pandas/core/algorithms.py:798: FutureWarning: In a future version, the Index constructor will not infer numeric dtypes when passed object-dtype sequences (matching Series behavior)\n\n\n\n\n\n\n\nbirthyear\n\n\n1991\n\n\n1992\n\n\n1993\n\n\n1994\n\n\n\n\nindividual\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nJack\n\n\n149\n\n\n153\n\n\n154\n\n\n155\n\n\n\n\nJohn\n\n\n150\n\n\n155\n\n\n157\n\n\n160"
  },
  {
    "objectID": "introduction-to-python.html#joining-two-different-tables",
    "href": "introduction-to-python.html#joining-two-different-tables",
    "title": "10¬† Introduction to Python and Pandas",
    "section": "10.13 9 - Joining two different tables",
    "text": "10.13 9 - Joining two different tables\nIn AncientMetagenomeDir, the information about each sample is located in sample table, and about the library in the library table.\nTo match these two together, we need to join the tables together.\nTo do so, we need a column in common between the two tables, the so-called joining key (this key can be the index)\n\nFor the samples and libraries dataframe, the joining key is the column sample_name\nsample_df.merge(library_df, on='sample_name').columns\nIndex(['project_name_x', 'publication_year_x', 'publication_doi', 'site_name',\n       'latitude', 'longitude', 'geo_loc_name', 'sample_name', 'sample_host',\n       'sample_age', 'sample_age_doi', 'community_type', 'material',\n       'archive_x', 'archive_project_x', 'archive_accession', 'project_name_y',\n       'publication_year_y', 'data_publication_doi', 'archive_y',\n       'archive_project_y', 'archive_sample_accession', 'library_name',\n       'strand_type', 'library_polymerase', 'library_treatment',\n       'library_concentration', 'instrument_model', 'library_layout',\n       'library_strategy', 'read_count', 'archive_data_accession',\n       'download_links', 'download_md5s', 'download_sizes'],\n      dtype='object')\nWe have some duplicate columns that we can get rid of:\nmerged_df = sample_df.merge(library_df.drop(['project_name', 'publication_year', 'archive_project', 'archive'], axis=1), on='sample_name')\nmerged_df\n\n\n\n\n\n\n\n\n\nproject_name\n\n\npublication_year\n\n\npublication_doi\n\n\nsite_name\n\n\nlatitude\n\n\nlongitude\n\n\ngeo_loc_name\n\n\nsample_name\n\n\nsample_host\n\n\nsample_age\n\n\n‚Ä¶\n\n\nlibrary_treatment\n\n\nlibrary_concentration\n\n\ninstrument_model\n\n\nlibrary_layout\n\n\nlibrary_strategy\n\n\nread_count\n\n\narchive_data_accession\n\n\ndownload_links\n\n\ndownload_md5s\n\n\ndownload_sizes\n\n\n\n\n\n\n0\n\n\nWarinner2014\n\n\n2014\n\n\n10.1038/ng.2906\n\n\nDalheim\n\n\n51.565\n\n\n8.84\n\n\nGermany\n\n\nB61\n\n\nHomo sapiens\n\n\n900\n\n\n‚Ä¶\n\n\nnone\n\n\nNaN\n\n\nIllumina HiSeq 2000\n\n\nSINGLE\n\n\nWGS\n\n\n13228381\n\n\nSRR957738\n\n\nftp.sra.ebi.ac.uk/vol1/fastq/SRR957/SRR957738/‚Ä¶\n\n\n9c40c43b5d455e760ae8db924347f0b2\n\n\n953396663\n\n\n\n\n1\n\n\nWarinner2014\n\n\n2014\n\n\n10.1038/ng.2906\n\n\nDalheim\n\n\n51.565\n\n\n8.84\n\n\nGermany\n\n\nB61\n\n\nHomo sapiens\n\n\n900\n\n\n‚Ä¶\n\n\nnone\n\n\nNaN\n\n\nIllumina HiSeq 2000\n\n\nSINGLE\n\n\nWGS\n\n\n13260566\n\n\nSRR957739\n\n\nftp.sra.ebi.ac.uk/vol1/fastq/SRR957/SRR957739/‚Ä¶\n\n\ndec1507f742de109529638bf00e0732f\n\n\n1026825795\n\n\n\n\n2\n\n\nWarinner2014\n\n\n2014\n\n\n10.1038/ng.2906\n\n\nDalheim\n\n\n51.565\n\n\n8.84\n\n\nGermany\n\n\nB61\n\n\nHomo sapiens\n\n\n900\n\n\n‚Ä¶\n\n\nnone\n\n\nNaN\n\n\nIllumina HiSeq 2000\n\n\nSINGLE\n\n\nWGS\n\n\n8869866\n\n\nSRR957740\n\n\nftp.sra.ebi.ac.uk/vol1/fastq/SRR957/SRR957740/‚Ä¶\n\n\nbc49c59f489b4009206f8abcb737d55d\n\n\n661500786\n\n\n\n\n3\n\n\nWarinner2014\n\n\n2014\n\n\n10.1038/ng.2906\n\n\nDalheim\n\n\n51.565\n\n\n8.84\n\n\nGermany\n\n\nB61\n\n\nHomo sapiens\n\n\n900\n\n\n‚Ä¶\n\n\nnone\n\n\nNaN\n\n\nIllumina HiSeq 2000\n\n\nSINGLE\n\n\nWGS\n\n\n11275013\n\n\nSRR957741\n\n\nftp.sra.ebi.ac.uk/vol1/fastq/SRR957/SRR957741/‚Ä¶\n\n\ne02e3549ddd3ba6dc278a7f573c07321\n\n\n877360302\n\n\n\n\n4\n\n\nWarinner2014\n\n\n2014\n\n\n10.1038/ng.2906\n\n\nDalheim\n\n\n51.565\n\n\n8.84\n\n\nGermany\n\n\nG12\n\n\nHomo sapiens\n\n\n900\n\n\n‚Ä¶\n\n\nnone\n\n\nNaN\n\n\nIllumina HiSeq 2000\n\n\nSINGLE\n\n\nWGS\n\n\n8978974\n\n\nSRR957742\n\n\nftp.sra.ebi.ac.uk/vol1/fastq/SRR957/SRR957742/‚Ä¶\n\n\nb7c620b8ee165c08bee204529341ca5b\n\n\n690614774\n\n\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n\n\n1802\n\n\nMaixner2021\n\n\n2021\n\n\n10.1016/j.cub.2021.09.031\n\n\nEdlersbergwerk - oben, Hallstatt\n\n\n47.560\n\n\n13.63\n\n\nAustria\n\n\n2612\n\n\nHomo sapiens\n\n\n150\n\n\n‚Ä¶\n\n\nnone\n\n\nNaN\n\n\nIllumina MiSeq\n\n\nPAIRED\n\n\nWGS\n\n\n1858404\n\n\nERR5766179\n\n\nftp.sra.ebi.ac.uk/vol1/fastq/ERR576/009/ERR576‚Ä¶\n\n\n542787c645b0aeebe15c66cc926d3f69;0bc58d56be3c3‚Ä¶\n\n\n86783041;98100690\n\n\n\n\n1803\n\n\nMaixner2021\n\n\n2021\n\n\n10.1016/j.cub.2021.09.031\n\n\nEdlersbergwerk - oben, Hallstatt\n\n\n47.560\n\n\n13.63\n\n\nAustria\n\n\n2612\n\n\nHomo sapiens\n\n\n150\n\n\n‚Ä¶\n\n\nnone\n\n\nNaN\n\n\nIllumina MiSeq\n\n\nPAIRED\n\n\nWGS\n\n\n1603064\n\n\nERR5766180\n\n\nftp.sra.ebi.ac.uk/vol1/fastq/ERR576/000/ERR576‚Ä¶\n\n\n022bb28da460e66590e974b4135bdd2e;f88acec67b648‚Ä¶\n\n\n74375931;77621627\n\n\n\n\n1804\n\n\nMaixner2021\n\n\n2021\n\n\n10.1016/j.cub.2021.09.031\n\n\nEdlersbergwerk - oben, Hallstatt\n\n\n47.560\n\n\n13.63\n\n\nAustria\n\n\n2612\n\n\nHomo sapiens\n\n\n150\n\n\n‚Ä¶\n\n\nnone\n\n\nNaN\n\n\nIllumina MiSeq\n\n\nPAIRED\n\n\nWGS\n\n\n1075088\n\n\nERR5766181\n\n\nftp.sra.ebi.ac.uk/vol1/fastq/ERR576/001/ERR576‚Ä¶\n\n\n57fc575d32db14f1d5c1ed7f6a106e91;4f57b9d978b53‚Ä¶\n\n\n51852071;56288763\n\n\n\n\n1805\n\n\nMaixner2021\n\n\n2021\n\n\n10.1016/j.cub.2021.09.031\n\n\nEdlersbergwerk - oben, Hallstatt\n\n\n47.560\n\n\n13.63\n\n\nAustria\n\n\n2612\n\n\nHomo sapiens\n\n\n150\n\n\n‚Ä¶\n\n\nnone\n\n\nNaN\n\n\nIllumina HiSeq 2500\n\n\nPAIRED\n\n\nWGS\n\n\n138836358\n\n\nERR5766182\n\n\nftp.sra.ebi.ac.uk/vol1/fastq/ERR576/002/ERR576‚Ä¶\n\n\n64e63df8da7542957d1d9eb08e764d38;3fc6cba02c74d‚Ä¶\n\n\n4332353625;4420486328\n\n\n\n\n1806\n\n\nMaixner2021\n\n\n2021\n\n\n10.1016/j.cub.2021.09.031\n\n\nEdlersbergwerk - oben, Hallstatt\n\n\n47.560\n\n\n13.63\n\n\nAustria\n\n\n2612\n\n\nHomo sapiens\n\n\n150\n\n\n‚Ä¶\n\n\nnone\n\n\nNaN\n\n\nHiSeq X Ten\n\n\nPAIRED\n\n\nWGS\n\n\n84192332\n\n\nERR5766183\n\n\nftp.sra.ebi.ac.uk/vol1/fastq/ERR576/003/ERR576‚Ä¶\n\n\n43ac661c4e211ed6ee2940dcab8b13cb;88de66a85df92‚Ä¶\n\n\n3128863954;3460789287\n\n\n\n\n\n\n1807 rows √ó 31 columns"
  },
  {
    "objectID": "introduction-to-python.html#visualizing-some-of-the-results-with-plotnine",
    "href": "introduction-to-python.html#visualizing-some-of-the-results-with-plotnine",
    "title": "10¬† Introduction to Python and Pandas",
    "section": "10.14 10 - Visualizing some of the results with Plotnine",
    "text": "10.14 10 - Visualizing some of the results with Plotnine\nPlotnine is the Python clone of ggplot2, the syntax is identical, which makes it great if you‚Äôre working with data in tidy/long format, and are already familiar with the ggplot2 syntax\nggplot(merged_df, aes(x='publication_year')) + geom_histogram() + theme_classic()\n/Users/maxime/mambaforge/envs/intro-data/lib/python3.10/\nsite-packages/plotnine/stats/stat_bin.py:95:\nPlotnineWarning: 'stat_bin()' using 'bins = 15'. Pick better value with 'binwidth'.\n\n\n\npng\n\n\n&lt;ggplot: (366051178)&gt;\nWe can start to ask some questions, for example, is the sequencing depth increasing with the years ?\nmerged_df['publication_year'] = merged_df['publication_year'].astype('category')\nggplot(merged_df, aes(x='publication_year', y='np.log10(read_count)', fill='publication_year')) +\ngeom_jitter(alpha=0.1) + geom_boxplot(alpha=0.8) + theme_classic()\n\n\n\npng\n\n\n&lt;ggplot: (366112582)&gt;\nWe could ask the same question, but first grouping the samples by publication year\navg_read_count_by_year = merged_df.groupby('publication_year')['read_count'].mean().to_frame().reset_index()\navg_read_count_by_year\n\n\n\n\n\n\n\n\n\npublication_year\n\n\nread_count\n\n\n\n\n\n\n0\n\n\n2014\n\n\n1.437173e+07\n\n\n\n\n1\n\n\n2016\n\n\n3.653450e+04\n\n\n\n\n2\n\n\n2017\n\n\n5.712598e+06\n\n\n\n\n3\n\n\n2018\n\n\n9.273287e+06\n\n\n\n\n4\n\n\n2019\n\n\n2.211632e+07\n\n\n\n\n5\n\n\n2020\n\n\n1.111819e+07\n\n\n\n\n6\n\n\n2021\n\n\n2.547655e+07\n\n\n\n\n\n\nggplot(avg_read_count_by_year, aes(x='publication_year', y='np.log10(read_count)', fill='publication_year')) + geom_point()\n\n\n\npng\n\n\n&lt;ggplot: (366206706)&gt;\nYour turn ! Make a plot to investigate the relation between the type of library treatment throughout the publication years"
  },
  {
    "objectID": "introduction-to-python.html#bonus-dealing-with-ill-formatted-columns",
    "href": "introduction-to-python.html#bonus-dealing-with-ill-formatted-columns",
    "title": "10¬† Introduction to Python and Pandas",
    "section": "10.15 11 - Bonus, dealing with ill-formatted columns",
    "text": "10.15 11 - Bonus, dealing with ill-formatted columns\nSometimes, colums can contains entries which could be split in multiple columns, typically values separated by a comma. In AncientMetagenomeDir, this is the case with the archive accession column.\nHere is how we would solve it with pandas\nsample_df.assign(archive_accession = sample_df.archive_accession.str.split(\",\")).explode('archive_accession')\n\n\n\n\n\n\n\n\n\nproject_name\n\n\npublication_year\n\n\npublication_doi\n\n\nsite_name\n\n\nlatitude\n\n\nlongitude\n\n\ngeo_loc_name\n\n\nsample_name\n\n\nsample_host\n\n\nsample_age\n\n\nsample_age_doi\n\n\ncommunity_type\n\n\nmaterial\n\n\narchive\n\n\narchive_project\n\n\narchive_accession\n\n\n\n\n\n\n0\n\n\nWarinner2014\n\n\n2014\n\n\n10.1038/ng.2906\n\n\nDalheim\n\n\n51.565\n\n\n8.840\n\n\nGermany\n\n\nB61\n\n\nHomo sapiens\n\n\n900\n\n\n10.1038/ng.2906\n\n\noral\n\n\ndental calculus\n\n\nSRA\n\n\nPRJNA216965\n\n\nSRS473742\n\n\n\n\n0\n\n\nWarinner2014\n\n\n2014\n\n\n10.1038/ng.2906\n\n\nDalheim\n\n\n51.565\n\n\n8.840\n\n\nGermany\n\n\nB61\n\n\nHomo sapiens\n\n\n900\n\n\n10.1038/ng.2906\n\n\noral\n\n\ndental calculus\n\n\nSRA\n\n\nPRJNA216965\n\n\nSRS473743\n\n\n\n\n0\n\n\nWarinner2014\n\n\n2014\n\n\n10.1038/ng.2906\n\n\nDalheim\n\n\n51.565\n\n\n8.840\n\n\nGermany\n\n\nB61\n\n\nHomo sapiens\n\n\n900\n\n\n10.1038/ng.2906\n\n\noral\n\n\ndental calculus\n\n\nSRA\n\n\nPRJNA216965\n\n\nSRS473744\n\n\n\n\n0\n\n\nWarinner2014\n\n\n2014\n\n\n10.1038/ng.2906\n\n\nDalheim\n\n\n51.565\n\n\n8.840\n\n\nGermany\n\n\nB61\n\n\nHomo sapiens\n\n\n900\n\n\n10.1038/ng.2906\n\n\noral\n\n\ndental calculus\n\n\nSRA\n\n\nPRJNA216965\n\n\nSRS473745\n\n\n\n\n1\n\n\nWarinner2014\n\n\n2014\n\n\n10.1038/ng.2906\n\n\nDalheim\n\n\n51.565\n\n\n8.840\n\n\nGermany\n\n\nG12\n\n\nHomo sapiens\n\n\n900\n\n\n10.1038/ng.2906\n\n\noral\n\n\ndental calculus\n\n\nSRA\n\n\nPRJNA216965\n\n\nSRS473747\n\n\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n‚Ä¶\n\n\n\n\n1057\n\n\nKazarina2021b\n\n\n2021\n\n\n10.1016/j.jasrep.2021.103213\n\n\nSt.¬†Gertrude‚Äôs Church, Riga\n\n\n56.958\n\n\n24.121\n\n\nLatvia\n\n\nT9\n\n\nHomo sapiens\n\n\n400\n\n\n10.1016/j.jasrep.2021.103213\n\n\noral\n\n\ntooth\n\n\nENA\n\n\nPRJEB47251\n\n\nERS7283099\n\n\n\n\n1058\n\n\nKazarina2021b\n\n\n2021\n\n\n10.1016/j.jasrep.2021.103213\n\n\nDom Square, Riga\n\n\n56.949\n\n\n24.104\n\n\nLatvia\n\n\nTZA3\n\n\nHomo sapiens\n\n\n400\n\n\n10.1016/j.jasrep.2021.103213\n\n\noral\n\n\ntooth\n\n\nENA\n\n\nPRJEB47251\n\n\nERS7283100\n\n\n\n\n1058\n\n\nKazarina2021b\n\n\n2021\n\n\n10.1016/j.jasrep.2021.103213\n\n\nDom Square, Riga\n\n\n56.949\n\n\n24.104\n\n\nLatvia\n\n\nTZA3\n\n\nHomo sapiens\n\n\n400\n\n\n10.1016/j.jasrep.2021.103213\n\n\noral\n\n\ntooth\n\n\nENA\n\n\nPRJEB47251\n\n\nERS7283101\n\n\n\n\n1059\n\n\nKazarina2021b\n\n\n2021\n\n\n10.1016/j.jasrep.2021.103213\n\n\nSt.¬†Peter‚Äôs Church, Riga\n\n\n56.947\n\n\n24.109\n\n\nLatvia\n\n\nTZA4\n\n\nHomo sapiens\n\n\n500\n\n\n10.1016/j.jasrep.2021.103213\n\n\noral\n\n\ntooth\n\n\nENA\n\n\nPRJEB47251\n\n\nERS7283102\n\n\n\n\n1059\n\n\nKazarina2021b\n\n\n2021\n\n\n10.1016/j.jasrep.2021.103213\n\n\nSt.¬†Peter‚Äôs Church, Riga\n\n\n56.947\n\n\n24.109\n\n\nLatvia\n\n\nTZA4\n\n\nHomo sapiens\n\n\n500\n\n\n10.1016/j.jasrep.2021.103213\n\n\noral\n\n\ntooth\n\n\nENA\n\n\nPRJEB47251\n\n\nERS7283103\n\n\n\n\n\n\n1262 rows √ó 16 columns"
  },
  {
    "objectID": "introduction-to-git.html#introduction",
    "href": "introduction-to-git.html#introduction",
    "title": "11¬† Introduction to Git(Hub)",
    "section": "11.1 Introduction",
    "text": "11.1 Introduction\nAs the size and complexity of metagenomic analyses continues to expand, effectively organizing and tracking changes to scripts, code, and even data, continues to be a critical part of ancient metagenomic analyses. Furthermore, this complexity is leading to ever more collaborative projects, with input from multiple researchers.\nIn this chapter, we will introduce ‚ÄòGit‚Äô, an extremely popular version control system used in bioinformatics and software development to store, track changes, and collaborate on scripts and code. We will also introduce, GitHub, a cloud-based service for Git repositories for sharing data and code, and where many bioinformatic tools are stored. We will learn how to access and navigate course materials stored on GitHub through the web interface as well as the command line, and we will create our own repositories to store and share the output of upcoming sessions."
  },
  {
    "objectID": "introduction-to-git.html#lecture",
    "href": "introduction-to-git.html#lecture",
    "title": "11¬† Introduction to Git(Hub)",
    "section": "11.2 Lecture",
    "text": "11.2 Lecture\n\n\nPDF version of these slides can be downloaded from here."
  },
  {
    "objectID": "introduction-to-git.html#ssh-setup",
    "href": "introduction-to-git.html#ssh-setup",
    "title": "11¬† Introduction to Git(Hub)",
    "section": "11.3 SSH setup",
    "text": "11.3 SSH setup\nTo begin, you will set up an SSH key to facilitate easier authentication when transferring data between local and remote repositories. In other words, follow this section of the tutorial so that you never have to type in your github password again! Begin by activating the conda environment for this section (see Preparation above).\nconda activate git-eager\nNext, generate your own ssh key, replacing the email below with your own address.\nssh-keygen -t ed25519 -C \"your_email@example.com\"\nI recommend saving the file to the default location and skipping passphrase setup. To do this, simply press enter without typing anything.\nYou should now (hopefully!) have generated an ssh key. To check that it worked, run the following commands to list the files containing your public and private keys and check that the ssh program is running.\ncd ~/.ssh/\nls id*\neval \"$(ssh-agent -s)\"\nNow you need to give ssh your key to record:\nssh-add ~/.ssh/id_ed15519\nNext, open your webbrowser and navigate to your github account. Go to settings -&gt; SSH & GPG Keys -&gt; New SSH Key. Give you key a title and paste the public key that you just generated on your local machine.\ncat ~/.ssh/id_ed15519\nFinally, press Add SSH key. To check that it worked, run the following command on your local machine. You should see a message telling you that you‚Äôve successfully authenticated.\nssh -T git@github.com\nFor more information about setting up the SSH key, including instructions for different operating systems, check out github‚Äôs documentation: https://docs.github.com/es/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent."
  },
  {
    "objectID": "introduction-to-git.html#the-only-6-commands-you-really-need-to-know",
    "href": "introduction-to-git.html#the-only-6-commands-you-really-need-to-know",
    "title": "11¬† Introduction to Git(Hub)",
    "section": "11.4 The only 6 commands you really need to know",
    "text": "11.4 The only 6 commands you really need to know\nNow that you have set up your own SSH key, we can begin working on some version controlled data! Navigate to your github homepage and create a new repository. You can choose any name for your new repo (including the default). Add a README file, then select Create Repository.\n  \n\n\n\n\n\n\nNote\n\n\n\nFor the remainder of the session, replace the name of my repository (vigilant-octo-journey) with your own repo name.\n\n\n\n\nChange into the directory where you would like to work, and let‚Äôs get started! First, we will learn to clone a remote repository onto your local machine. Navigate to your new repo, select the Code dropdown menu, select SSH, and copy the address as shown below.\n\nBack at your command line, clone the repo as follows:\ngit clone git@github.com:meganemichel/vigilant-octo-journey.git\nNext, let‚Äôs add a new or modified file to our ‚Äòstaging area‚Äô on our local machine.\ncd vigilant-octo-journey\necho \"test_file\" &gt; file_A.txt\necho \"Just an example repo\" &gt;&gt; README.md\ngit add file_A.txt\nNow we can check what files have been locally changed, staged, etc. with status.\ngit status\nYou should see that file_A.txt is staged to be committed, but README.md is NOT. Try adding README.md and check the status again.\nNow we need to package or save the changes into a commit with a message describing the changes we‚Äôve made. Each commit comes with a unique hash ID and will be stored forever in git history.\ngit commit -m \"Add example file\"\nFinally, let‚Äôs push our local commit back to our remote repository.\ngit push\nWhat if we want to download new commits from our remote to our local repository?\ngit pull\nYou should see that your repository is already up-to-date, since we have not made new changes to the remote repo. Let‚Äôs try making a change to the remote repository‚Äôs README file (as below). Then, back on the command line, pull the repository again."
  },
  {
    "objectID": "introduction-to-git.html#working-collaboratively",
    "href": "introduction-to-git.html#working-collaboratively",
    "title": "11¬† Introduction to Git(Hub)",
    "section": "11.5 Working collaboratively",
    "text": "11.5 Working collaboratively\nGithub facilitates simultaneous work by small teams through branching, which generates a copy of the main repository within the repository. This can be edited without breaking the ‚Äòmaster‚Äô version. First, back on github, make a new branch of your repository.\n\nFrom the command line, you can create a new branch as follows:\ngit switch -c new_branch\nTo switch back to the main branch, use\ngit switch main\nNote that you must commit changes for them to be saved to the desired branch!"
  },
  {
    "objectID": "introduction-to-git.html#pull-requests",
    "href": "introduction-to-git.html#pull-requests",
    "title": "11¬† Introduction to Git(Hub)",
    "section": "11.6 Pull requests",
    "text": "11.6 Pull requests\nA Pull request (aka PR) is used to propose changes to a branch from another branch. Others can comment and make suggestinos before your changes are merged into the main branch. For more information on creating a pull request, see github‚Äôs documentation: https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/creating-a-pull-request."
  },
  {
    "objectID": "introduction-to-git.html#questions-to-think-about",
    "href": "introduction-to-git.html#questions-to-think-about",
    "title": "11¬† Introduction to Git(Hub)",
    "section": "11.7 Questions to think about",
    "text": "11.7 Questions to think about\n\nWhy is using a version control software for tracking data and code important?\nHow can using Git(Hub) help me to collaborate on group projects?"
  },
  {
    "objectID": "accessing-ancientmetagenomic-data.html#abstract",
    "href": "accessing-ancientmetagenomic-data.html#abstract",
    "title": "12¬† Introduction to AncientMetagenomeDir",
    "section": "12.1 Abstract",
    "text": "12.1 Abstract\n\n\nFinding relevant comparative data for your ancient metagenomic analysis is not trivial. While palaeogenomicists are very good at uploading their raw sequencing data to large sequencing data repositories such as the EBI‚Äôs ENA or NCBI‚Äôs SRA archives in standardised file formats, these files often have limited metadata. This often makes it difficult for researchers to search for and download relevent published data they wish to use use to augment their own analysis.\nAncientMetagenomeDir is a community project from the SPAAM community to make ancient metagenomic data more accessible. We curate a list of standardised metadata of all published ancient metagenomic samples and libraries, hosted on GitHub. In this chapter we will go through how to use the AncientMetagenomeDir repository and associated tools to find and download data for your own analyses. We will also discuss important things to consider when publishing your own data to make it more accessible for other researchers."
  },
  {
    "objectID": "accessing-ancientmetagenomic-data.html#lecture",
    "href": "accessing-ancientmetagenomic-data.html#lecture",
    "title": "12¬† Introduction to AncientMetagenomeDir",
    "section": "12.2 Lecture",
    "text": "12.2 Lecture\n\n\nPDF version of these slides can be downloaded from here."
  },
  {
    "objectID": "accessing-ancientmetagenomic-data.html#introduction",
    "href": "accessing-ancientmetagenomic-data.html#introduction",
    "title": "12¬† Introduction to AncientMetagenomeDir",
    "section": "12.3 Introduction",
    "text": "12.3 Introduction\nIn most bioinformatic projects, we need to include publicly available comparative data to expand or compare our newly generated data with.\nIncluding public data can benefit ancient metagenomic studies in a variety of ways. It can help increase our sample sizes (a common problem when dealing with rare archaeological samples) - thus providing stronger statistical power. Comparison with a range of previously published data of different preservational levels can allow an estimate on the quality of the new samples. When considering solely (re)using public data, we can consider that this can also spawn new ideas, projects, and meta analyses to allow further deeper exploration of ancient metagenomic data (e.g., looking for correlations between various environmental factors and preservation).\nFortunately for us, genomicists and particularly palaeogenomicists have been very good at uploading raw sequencing data to well-established databases.\nIn the vast majority of cases you will be able to find publically available sequencing data on the INSDC association of databases, namely the EBI‚Äôs European Nucleotide Archive (ENA), and NCBI or DDBJ‚Äôs Sequence Read Archives (SRA). However, you may in some cases find ancient metagenomic data on institutional FTP servers, domain specific databases (e.g.¬†OAGR), Zenodo, Figshare, or GitHub.\nBut while the data is publicly available, we need to ask whether it is ‚ÄòFAIR‚Äô."
  },
  {
    "objectID": "accessing-ancientmetagenomic-data.html#finding-ancient-metagenomic-data",
    "href": "accessing-ancientmetagenomic-data.html#finding-ancient-metagenomic-data",
    "title": "12¬† Introduction to AncientMetagenomeDir",
    "section": "12.4 Finding Ancient Metagenomic Data",
    "text": "12.4 Finding Ancient Metagenomic Data\nFAIR principles were defined by researchers, librarians, and industry in 2016 to improve the quality of data uploads - primarily by making data uploads more ‚Äòmachine readable‚Äô. FAIR standards for:\n\nFindable\nAccessible\nInteroperable\nReproducible\n\nAnd when we consider ancient metagenomic data, we are pretty close to this. Sequencing data is in most cases accessible (via the public databases like ENA, SRA), interoperable and reproducible because we use field standard formats such as FASTQ or BAM files. However Findable remains an issue.\nThis is because the metadata about each data file is dispersed over many places, and very often not with the data files themselves.\nIn this case I am referring to metadata such as: What is the sample‚Äôs name? How old is it? Where is it from? Which enzymes were used for library construction? What sequencing machine was this library sequenced on?\nTo find this information about a given data file, you have to search many places (main text, supplementary information, the database itself), for different types of metadata (as authors report different things), and also in different formats (text, tables, figures.\nThis very heterogenous landscape makes it difficult for machines to index all this information (if at all), and thus means you cannot search for the data you want to use for your own reserch in online search engines."
  },
  {
    "objectID": "accessing-ancientmetagenomic-data.html#ancientmetagenomedir",
    "href": "accessing-ancientmetagenomic-data.html#ancientmetagenomedir",
    "title": "12¬† Introduction to AncientMetagenomeDir",
    "section": "12.5 AncientMetagenomeDir",
    "text": "12.5 AncientMetagenomeDir\nThis is where the SPAAM community project AncientMetagenomeDir comes in. AncientMetagenomeDir is a resource of lists of metadata of all publishing and publically available ancient metagenomes and microbial genome-level enriched samples.\nBy aggregating and standardising metadata and accession codes of ancient metagenomic samples, the project aims to make it easier for people to find comparative data for their own projects, as well as help track the field over time and facilitate meta analyses.\nCurrently the project is split over three main tables: host-associated metagenomes (e.g.¬†ancient microbiomes), host-associated single-genomes (e.g.¬†ancient pathogens), and environmental metagenomes (e.g.¬†lakebed cores or cave sediment sequences).\nThe repository already contains more than a thousand samples and span the entire globe and as far back as hundreds of thousands of years.\nTo make the lists of samples and their metadata as accessible and interoperable as possible, we utilise simple text (TSV - tab separate value) files - files that can be opened by pretty much all spreadsheet tools (e.g., Microsoft Office excel, LibreOffice Calc) and languages (R, Python etc.).\n\nCriticially, by standardising the recorded all metadata across all publications this makes it much easier for researchers to filter for particular time periods, geographical regions, or sample types of their interest - and then use the also recorded accession numbers to efficiently download the data.\nAt their core all different AncientMetagenomeDir tables must have at 6 minimum metadata sets:\n\nPublication information (doi)\nSample name(s)\nGeographic location (e.g.¬†country, coordinates)\nAge\nSample type (e.g.¬†bone, sediment, etc.)\nData Archive and accessions\n\nEach table then has additional columns depending on the context (e.g.¬†what time of microbiome is expected for host-associated metagenoes, or species name of the genome that was reconstructed).\nThe AncientMetagenomeDir project already has 3 releases, and will continued to be regularly updated as the community continues to submit new metadata of samples of new publications as they come out."
  },
  {
    "objectID": "accessing-ancientmetagenomic-data.html#further-improving-metadata-reporting-in-ancient-metagenomics",
    "href": "accessing-ancientmetagenomic-data.html#further-improving-metadata-reporting-in-ancient-metagenomics",
    "title": "12¬† Introduction to AncientMetagenomeDir",
    "section": "12.6 Further Improving Metadata Reporting in Ancient Metagenomics",
    "text": "12.6 Further Improving Metadata Reporting in Ancient Metagenomics\nHowever, for researchers, sample-level metadata likely will not include all the information that is needed to include and process public data in their own projects.\nThe SPAAM community have been busy over the last few months extending the types of metadata included in the AncientMetagenomeDir project, to include library level metadata.\nThis metadata includes things such as whether a given set of data files contain sequencing data sequenced on which platform, whether the libraries have undergone damage treatment in the lab, or whether the uploaded data contains all or only mapped reads.\nWe have also started a new project - a MIxS checklist currently entitled ‚ÄòMINAS‚Äô - which we aim to make the standard metadata reporting sheet for all ancient metagenomics and even for any ancient DNA sample. Such a checklist would be interegrated into services such as the ENA or SRA, and therefore would standardise metadata alongside the raw data, and make ancient metagenomic data much more findable with search engines.\nFinally, to make it easier for researchers who are not familiar with sequencing database infrastucture, we are in the process of building a new tool (something already in a usable state) called AMDirT. This allows a web browser-based GUI to filter and select data, and produce scripts for you to download all the selected data (without having to go to the databases themselves).\nThis is something we are going to try out now!"
  },
  {
    "objectID": "accessing-ancientmetagenomic-data.html#running-amdirt",
    "href": "accessing-ancientmetagenomic-data.html#running-amdirt",
    "title": "12¬† Introduction to AncientMetagenomeDir",
    "section": "12.7 Running AMDirT",
    "text": "12.7 Running AMDirT\n\nFirst, we will need to activate a conda environment, and then install the latest development version of the tool for you.\n\n‚ö†Ô∏è this tutorial will require a web-browser! Make sure to run on your local laptop/PC or on a server with X11 forwarding\n\nOpen your terminal, and run the following two commands:\nconda activate git-eager\npip install --upgrade --force-reinstall git+https://github.com/SPAAM-community/AMDirT.git@dev\nOnce that (hopefully) installs correctly, we can load the tool by running\nAMDirT filter\nYour web browser should now load, and you should see a two panel page.\n\nUnder Select a table use the dropdown menu to select ‚Äòancientsinglegenome-hostassociated‚Äô.\nYou should then see a table, pretty similar what you are familiar with with spreadsheet tools such as Microsoft Excel or LibreOffice calc.\n\nTo navigate, you can scroll down to see more rows, and press shift and scroll to see more columns, or use click on a cell and use your arrow keys (‚¨Ü,‚¨á,‚¨Ö,‚û°) to move around the table.\nYou can reorder columns by clicking on the column name, and also filter by pressing the little ‚Äòburger‚Äô icon that appears on the column header when you hover over a given column.\nAs an exercise, we will try filtering to a particular set of samples, then generate some download scripts, and download the files.\nFirst, filter the project_name column to ‚ÄòKocher2021‚Äô.\n\nThen scroll to the right, and filter the geo_loc_name to ‚ÄòUnited Kingdom‚Äô.\n\nYou should be left with 4 rows.\nFinally, scroll back to the first column and tick the boxes of these four samples.\n\nOnce you‚Äôve selected the samples you want, you can press Validate selection. You should then see a series loading-spinner, and new buttons should appear!\n\nYou should have three main buttons:\n\nDownload Curl sample download script\nDownload nf-core/eager input TSV\nDownload Citations as BibText\n\nThe first button is for generating a download script that will allow you to immediately download all sequencing data of the samples you selected. The second button is a pre-configured input file for use in the nf-core/eager ancient DNA pipeline, and finally, the third button generates a text file with (in most cases) all the citations of the data you downloaded, in a format accepted by most reference/citation managers.\nIt‚Äôs important to note you are not necessarily restricted to Curl for downloading the data, or nf-core/eager for running the files. AMDirT aims to add support for whatever tools or pipelines requested by the community. For example, an already supported download alternative is with the nf-core/fetchNGS pipeline. You can select these using the drop-down menus on the left hand-side.\nPress the three buttons to make sure you download the files. And once this is done, you can close the tab of the web browser, and in the terminal you can press ctrl + c to shutdown the tool."
  },
  {
    "objectID": "accessing-ancientmetagenomic-data.html#inspecting-amdirt-output",
    "href": "accessing-ancientmetagenomic-data.html#inspecting-amdirt-output",
    "title": "12¬† Introduction to AncientMetagenomeDir",
    "section": "12.8 Inspecting AMDirT Output",
    "text": "12.8 Inspecting AMDirT Output\nLets look at the files that AMDirT has generated for you.\nFirst you should cd into the directory that your web browser downloaded the files into (e.g.¬†cd ~/Downloads/), then look inside the directory. You should see the following three files\n$ ls\nancientMetagenomeDir_curl_download_script.sh\nancientMetagenomeDir_citations.bib\nancientMetagenomeDir_eager_input.csv\nWe can simple run cat on each file to look inside. If you run cat on the curl download script, you should see a series of curl commands with the correct ENA links for you for each of the samples you wish to download.\n$ cat ancientMetagenomeDir_curl_download_script.sh\n#!/usr/bin/env bash\ncurl -L ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR605/009/ERR6053619/ERR6053619.fastq.gz -o ERR6053619.fastq.gz\ncurl -L ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR605/008/ERR6053618/ERR6053618.fastq.gz -o ERR6053618.fastq.gz\ncurl -L ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR605/005/ERR6053675/ERR6053675.fastq.gz -o ERR6053675.fastq.gz\ncurl -L ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR605/006/ERR6053686/ERR6053686.fastq.gz -o ERR6053686.fastq.gz\nBy providing this script for you, AMDirT facilitates fast download of files of interest by replacing the one-by-one download commands for each sample with a single command!\n$ bash ancientMetagenomeDir_curl_download_script.sh\ncurl -L ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR605/009/ERR6053619/ERR6053619.fastq.gz -o ERR6053619.fastq.gz\ncurl -L ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR605/008/ERR6053618/ERR6053618.fastq.gz -o ERR6053618.fastq.gz\ncurl -L ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR605/005/ERR6053675/ERR6053675.fastq.gz -o ERR6053675.fastq.gz\ncurl -L ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR605/006/ERR6053686/ERR6053686.fastq.gz -o ERR6053686.fastq.gz\nRunning this command should result in progress logs of the downloading of the data of the four selected samples!\nOnce the four samples are downloaded, AMDirT then facilitates fast processing of the data, as the eager script can be given directly to nf-core/eager as input. Importantly by including the library metadata (mentioned above), researchers can leverage the complex automated processing that nf-core/eager can perform when given such relevant metadata.\n$ cat ancientMetagenomeDir_eager_input.csv\nSample_Name Library_ID  Lane    Colour_Chemistry    SeqType Organism    Strandedness    UDG_Treatment   R1  R2  BAM\nI0157   ERR6053618  0   4   SE  Homo sapiens    double  unknown ERX5692504_ERR6053618.fastq.gz  NA  NA\nI0161   ERR6053619  0   4   SE  Homo sapiens    double  unknown ERX5692505_ERR6053619.fastq.gz  NA  NA\nOAI017  ERR6053675  0   4   SE  Homo sapiens    double  half    ERX5692561_ERR6053675.fastq.gz  NA  NA\nSED009  ERR6053686  0   4   SE  Homo sapiens    double  half    ERX5692572_ERR6053686.fastq.gz  NA  NA\nFinally, we can look into the citations file which will provide you with the citation information of all the downloaded data and AncientMetagenomeDir itself.\n\n‚ö†Ô∏è the contents of this file is reliant on indexing of publications on CrossRef. In some cases not all citations will be present, so this should be double checked!\n\n$ cat ancientMetagenomeDir_citations.bib\n\n@article{Fellows_Yates_2021,\n    doi = {10.1038/s41597-021-00816-y},\n    url = {https://doi.org/10.1038%2Fs41597-021-00816-y},\n    year = 2021,\n    month = {jan},\n    publisher = {Springer Science and Business Media {LLC}},\n    volume = {8},\n    number = {1},\n    author = {James A. Fellows Yates and Aida Andrades Valtue{\\~{n}}a and {\\AA}shild J. V{\\aa}gene and\n    Becky Cribdon and Irina M. Velsko and Maxime Borry and Miriam J. Bravo-Lopez and Antonio Fernandez-Guerra\n    and Eleanor J. Green and Shreya L. Ramachandran and Peter D. Heintzman and Maria A. Spyrou and Alexander\n    H√ºbner and Abigail S. Gancz and Jessica Hider and Aurora F. Allshouse and Valentina Zaro and Christina Warinner},\n    title = {Community-curated and standardised metadata of published ancient metagenomic samples with {AncientMetagenomeDir}},\n    journal = {Scientific Data}\n}\nThis file can be easily loaded into most reference managers and then have all the citations quickly added to your manuscripts."
  },
  {
    "objectID": "accessing-ancientmetagenomic-data.html#git-practise",
    "href": "accessing-ancientmetagenomic-data.html#git-practise",
    "title": "12¬† Introduction to AncientMetagenomeDir",
    "section": "12.9 Git Practise",
    "text": "12.9 Git Practise\nA critical factor of AncientMetagenomeDir is that it is community-based. The community curates all new submissions to the repository, and this all occurs with Git.\nThe data is hosted and maintained on GitHub - new publications are evaluated on issues, submissions created on branches, made by pull requests, and PRs reviewed by other members of the community.\nYou can see the workflow in the image below from the AncientMetageomeDir publication, and read more about the workflow on the AncientMetagenomeDir wiki\n\nThis means we can also use this repository to practise git!\nYour task (with git terms removed):\n\nMake a ‚Äòcopy‚Äô the jfy133/AncientMetagenomeDir repository to your account\n‚ÄòDownload‚Äô the copied repo to your local machine\n‚ÄòChange‚Äô to the dev branch\nModify ‚Äòancientsinglegenome-hostassociated_samples.tsv‚Äô\n\nClick here to get some example data to copy in to the end of the TSV file\n\n‚ÄòSend‚Äô back to Git(Hub)\nOpen a ‚Äòrequest‚Äô adding changes to the original repo\n\nMake sure to put ‚ÄòSummer school‚Äô in the title of the ‚ÄòRequest‚Äô\n\n\n\n\nClick me to reveal the correct terminology\n\n\nFork the jfy133/AncientMetagenomeDir repository to your account\nClone the copied repo to your local machine\nSwitch to the dev branch\nModify ‚Äòancientsinglegenome-hostassociated_samples.tsv‚Äô\n\nClick here to get some example data to copy in to the end of the TSV file\n\nCommit and Push back to your Fork on Git(Hub)\nOpen a Pull Request adding changes to the original jfy133/AncientMetagenomeDir repo\n\nMake sure to put ‚ÄòSummer school‚Äô in the title of the pull request"
  },
  {
    "objectID": "accessing-ancientmetagenomic-data.html#summary",
    "href": "accessing-ancientmetagenomic-data.html#summary",
    "title": "12¬† Introduction to AncientMetagenomeDir",
    "section": "12.10 Summary",
    "text": "12.10 Summary\n\nReporting of metadata messy! Consider when publishing your own work!\n\nUse AncientMetagenomeDir as a template\n\nUse AncientMetagenomeDir and AMDirT (beta) to rapidly find public ancient metagenomic data\nContribute to AncientMetagenomeDir with git\n\nCommunity curated!"
  },
  {
    "objectID": "ancient-metagenomic-pipelines.html#abstract",
    "href": "ancient-metagenomic-pipelines.html#abstract",
    "title": "13¬† Ancient Metagenomic Pipelines",
    "section": "13.1 Abstract",
    "text": "13.1 Abstract\nAnalyses in the field of ancient DNA are growing, both in terms of the number of samples processed and in the diversity of our research questions and analytical methods. Computational pipelines are a solution to the challenges of big data, helping researchers to perform analyses efficiently and in a reproducible fashion. Today we will introduce nf-core/eager, one of several pipelines designed specifically for the preprocessing, analysis, and authentication of ancient next-generation sequencing data.\nIn this chapter we will learn how to practically perform basic analyses with nf-core/eager, starting from raw data and performing preprocessing, alignment, and genotyping of several Yersinia pestis-positive samples. We will gain an appreciation of the diversity of analyses that can be performed within nf-core eager, as well as where to find additional information for customizing your own nf-core/eager runs. Finally, we will learn how to use nf-core/eager to evaluate the quality and authenticity of our ancient samples. After this session, you will be ready to strike out into the world of nf-core/eager and build your own analyses from scratch!"
  },
  {
    "objectID": "ancient-metagenomic-pipelines.html#lecture",
    "href": "ancient-metagenomic-pipelines.html#lecture",
    "title": "13¬† Ancient Metagenomic Pipelines",
    "section": "13.2 Lecture",
    "text": "13.2 Lecture\n\n\nPDF version of these slides can be downloaded from here."
  },
  {
    "objectID": "ancient-metagenomic-pipelines.html#introduction",
    "href": "ancient-metagenomic-pipelines.html#introduction",
    "title": "13¬† Ancient Metagenomic Pipelines",
    "section": "13.3 Introduction",
    "text": "13.3 Introduction\nA pipeline is a series of linked computational steps, where the output of one process becomes the input of the next. Pipelines are critical for managing the huge quantities of data that are now being generated regularly as part of ancient DNA analyses. Today we will discuss one option for managing computational analyses of ancient next-generation sequencing datasets, nf-core/eager. Keep in mind that other tools, like the Paleomix pipeline, can also be used for similar applications."
  },
  {
    "objectID": "ancient-metagenomic-pipelines.html#what-is-nf-coreeager",
    "href": "ancient-metagenomic-pipelines.html#what-is-nf-coreeager",
    "title": "13¬† Ancient Metagenomic Pipelines",
    "section": "13.4 What is nf-core/eager?",
    "text": "13.4 What is nf-core/eager?\nnf-core/eager is a computational pipeline specifically designed for preprocessing and analysis of ancient DNA data. It is a reimplementation of the previously published EAGER (Efficient Ancient Genome Reconstruction) pipeline (Peltzer et al. 2016) using Nextflow. The nf-core/eager pipeline was designed with the following aims in mind:\n\nPortability- In order for our analyses to be reproducible, others should be able to easily implement our computational pipelines. nf-core/eager is highly portable, providing easy access to pipeline tools and facilitating use across multiple platforms. nf-core eager utilizes Docker, Conda, and Singularity for containerization, enabling distrubition of the pipeline in a self-contained bundle containing all the code, packages, and libraries needed to run it.\nReproducibility- nf-core/eager uses custom configuration profiles to specify both HPC-level parameters and analyses-specific options. These profiles can be shared alongside your publication, making it easier for others to reproduce your methodology!\nNew Tools- Finally, nf-core/eager includes additional, novel methods and tools for analysis of ancient DNA data that were not included in previous versions. This is especially good news for folks interested in microbial sciences, who can take advantage of new analytical pathways for metagenomic analysis and pathogen screening."
  },
  {
    "objectID": "ancient-metagenomic-pipelines.html#steps-in-the-pipeline",
    "href": "ancient-metagenomic-pipelines.html#steps-in-the-pipeline",
    "title": "13¬† Ancient Metagenomic Pipelines",
    "section": "13.5 Steps in the pipeline",
    "text": "13.5 Steps in the pipeline\n\nA detailed description of steps in the pipeline is available as part of nf-core/eager‚Äôs extensive documentation. For more information, check out the usage documentation here.\nBriefly, nf-core/eager takes standard input file types that are shared across the genomics field, including raw fastq files, aligned reads in bam format, and a reference fasta. nf-core/eager can perform preprocessing of this raw data, including adapter clipping, read merging, and quality control of adapter-trimmed data. Note that input files can be specified using wildcards OR a standardized tsv format file; the latter facilitates streamlined integration of multpile data types within a single EAGER run! More on this later.\nnf-core/eager facilitates mapping using a variety of field-standard alignment tools with configurable parameters. An exciting new addition in nf-core/eager also enables analysis of off-target host DNA for all of you metagenomics folks out there. Be sure to check out the functionality available for metagenomic profiling (blue route in the ‚Äòtube map‚Äô above).\nnf-core/eager incorporates field-standard quality control tools designed for use with ancient DNA so that you can easily evaluate the success of your experiments. Multiple genotyping approaches and additional analyses are available depending on your input datatype, organism, and research questions. Importantly, all of these processes generate data that we need to compile and analyze in a coherent way. nf-core eager uses MultiQC. to create an integrated html report that summarizes the output/results from each of the pipeline steps. Stay tuned for the practical portion of the walkthrough!"
  },
  {
    "objectID": "ancient-metagenomic-pipelines.html#how-to-build-an-nf-coreeager-command-a-practical-introduction",
    "href": "ancient-metagenomic-pipelines.html#how-to-build-an-nf-coreeager-command-a-practical-introduction",
    "title": "13¬† Ancient Metagenomic Pipelines",
    "section": "13.6 How to build an nf-core/eager command: A practical introduction",
    "text": "13.6 How to build an nf-core/eager command: A practical introduction\nFor the practical portion of the walkthrough, we will utilize sequencing data from four aDNA libraries, which you should have already downloaded from NCBI. If not, please see the Preparation section above.\nThese four libraries come from from two ancient individuals, GLZ002 and KZL002. GLZ002 comes from the Neolithic Siberian site of Glazkovskoe predmestie adn was radiocarbon dated to 3081-2913 calBCE. KZL002 is an Iron Age individual from Kazakhstan, radiocarbon dated to 2736-2457 calBCE. Both individuals were infected with the so-called ‚ÄòStone Age Plague‚Äô of Yersinia pestis, and libraries from these individuals were processed using hybridization capture to increase the number of Y. pestis sequences available for analysis.\nOur aims in the following tutorial are to:\n\nPreprocess the fastq files by trimming adapters and merging paired-end reads\nAlign reads to the Y. pestis reference and compute the endogenous DNA percentage\nFilter the aligned reads to remove host DNA\nRemove duplicate reads for accurate coverage estimation and genotyping\nMerge data by sample and perform genotyping on the combined dataset\nReview quality control data to evaluate the success of the previous steps\n\nLet‚Äôs get started!\nFirst, activate the conda environment that we downloaded during setup:\nconda activate git-eager\nNext, download the latest version of the nf-core/eager repo (or check for updates if you have a previously-installed version):\nnextflow pull nf-core/eager\nFinally, we will build our eager command:\nnextflow run nf-core/eager \\ #Tells nextflow to execute the EAGER pipeline\n-r 2.4.5 -ds1l \\ #Specifies which pipeline and Nextflow versions to run for reproducibility\n-profile conda  \\ #Profiles configure your analysis for specific computing environments/analyses\n--fasta ../reference/GCF_001293415.1_ASM129341v1_genomic.fna \\ #Specify reference in fasta format\n--input ancientMetagenomeDir_eager_input.tsv \\ #Specify input in tsv format or wildcards\n--run_bam_filtering --bam_unmapped_type fastq \\ #Filter unmapped reads and save in fastq format\n--run_genotyping --genotyping_tool ug --gatk_ug_out_mode EMIT_ALL_SITES \\ #Run genotyping with the GATK UnifiedGenotyper\n--run_bcftools_stats #Generate variant calling statistics\nFor full parameter documentation, click here.\nAnd now we wait‚Ä¶"
  },
  {
    "objectID": "ancient-metagenomic-pipelines.html#top-tips-for-nf-coreeager-success",
    "href": "ancient-metagenomic-pipelines.html#top-tips-for-nf-coreeager-success",
    "title": "13¬† Ancient Metagenomic Pipelines",
    "section": "13.7 Top Tips for nf-core/eager success",
    "text": "13.7 Top Tips for nf-core/eager success\n\nScreen sessions\n\nDepending on your input data, infrastructre, and analyses, running nf-core/eager can take hours or even days. To avoid crashed due to loss of power or network connectivity, try running nf-core/eager in a screen or tmux session:\nscreen -R eager\n\nMultiple ways to supply input data\n\nIn this tutorial, a tsv file to specify our input data files and formats. This is a powerful approach that allows nf-core eager to intelligently apply analyses to certain files only (e.g.¬†merging for paired-end but not single-end libraries). Check out the contents of our tsv input file using the following command:\ncat ancientMetagenomeDir_eager_input.tsv\nInputs can also be specified using wildcards, which can be useful for fast analyses with simple input data types (e.g.¬†same sequencing configuration, file location, etc.).\nnextflow run nf-core/eager -r 2.4.5 -ds1l -profile conda --fasta ../reference/GCF_001293415.1_ASM129341v1_genomic.fna\n--input \"data/*fastq.gz\" &lt;...&gt;\nSee the online nf-core/eager documentation for more details.\n\nGet your MultiQC report via email\n\nIf you have GNU mail or sendmail set up on your system, you can add the following flag to send the MultiQC html to your email upon run completion:\n--email \"your_address@something.com\"\n\nCheck out the EAGER GUI\n\nFor folks who might be less comfortable with the command line, check out the nf-core/eager GUI! The GUI also provides a full list of options with short explanations for those interested in learning more about what the pipeline can do.\n\nWhen something fails, all is not lost!\n\nWhen individual jobs fail, nf-coreager will try to automatically resubmit that job with increased memory and CPUs (up to two times per job). When the whole pipeline crashes, you can save time and computational resources by resubmitting with the -resume flag. nf-core/eager will retrieve cached results from previous steps as long as the input is the same.\n\nMonitor your pipeline in real time with the Nextflow Tower\n\nRegular users may be interested in checking out the Nextflow Tower, a tool for monitoring the progress of Nextflow pipelines in real time. Check here for more information."
  },
  {
    "objectID": "ancient-metagenomic-pipelines.html#questions-to-think-about",
    "href": "ancient-metagenomic-pipelines.html#questions-to-think-about",
    "title": "13¬† Ancient Metagenomic Pipelines",
    "section": "13.8 Questions to think about",
    "text": "13.8 Questions to think about\n\nWhy is it important to use a pipeline for genomic analysis of ancient data?\nHow can the design of the nf-core/eager pipeline help researchers comply with the FAIR princples for management of scientific data?\nWhat metrics do you use to evaluate the success/failure of ancient DNA sequencing experiments? How can these measures be evaluated when using nf-core/eager for data preprocessing and analysis?"
  },
  {
    "objectID": "summary.html",
    "href": "summary.html",
    "title": "14¬† Summary",
    "section": "",
    "text": "In summary, this book has no content whatsoever.\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "resources.html#introduction-to-ngs-sequencing",
    "href": "resources.html#introduction-to-ngs-sequencing",
    "title": "15¬† Resources",
    "section": "15.1 Introduction to NGS Sequencing",
    "text": "15.1 Introduction to NGS Sequencing\n\nhttps://www.youtube.com/watch?v=fCd6B5HRaZ8\nhttps://emea.illumina.com/content/dam/illumina-marketing/documents/products/illumina_sequencing_introduction.pdf"
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Dijk, Erwin L van, H√©l√®ne Auger, Yan Jaszczyszyn, and Claude Thermes.\n2014. ‚ÄúTen Years of Next-Generation Sequencing Technology.‚Äù\nTrends in Genetics 30 (9): 418‚Äì26. https://doi.org/10.1016/j.tig.2014.07.001.\n\n\nKircher, Martin, Susanna Sawyer, and Matthias Meyer. 2012. ‚ÄúDouble\nIndexing Overcomes Inaccuracies in Multiplex Sequencing on the Illumina\nPlatform.‚Äù Nucleic Acids Research 40 (1): e3. https://doi.org/10.1093/nar/gkr771.\n\n\nMa, Xiaotu, Ying Shao, Liqing Tian, Diane A Flasch, Heather L Mulder,\nMichael N Edmonson, Yu Liu, et al. 2019. ‚ÄúAnalysis of Error\nProfiles in Deep Next-Generation Sequencing Data.‚Äù Genome\nBiology 20 (1): 50. https://doi.org/10.1186/s13059-019-1659-6.\n\n\nMeyer, Matthias, and Martin Kircher. 2010. ‚ÄúIllumina Sequencing\nLibrary Preparation for Highly Multiplexed Target Capture and\nSequencing.‚Äù Cold Spring Harbor Protocols 2010 (6):\ndb.prot5448. https://doi.org/10.1101/pdb.prot5448.\n\n\nSchuster, Stephan C. 2008. ‚ÄúNext-Generation Sequencing Transforms\nToday‚Äôs Biology.‚Äù Nature Methods 5 (1): 16‚Äì18. https://doi.org/10.1038/nmeth1156.\n\n\nShendure, Jay, and Hanlee Ji. 2008. ‚ÄúNext-Generation\nDNA Sequencing.‚Äù Nature Biotechnology 26\n(10): 1135‚Äì45. https://doi.org/10.1038/nbt1486.\n\n\nSinha, Rahul, Geoff Stanley, Gunsagar Singh Gulati, Camille Ezran, Kyle\nJoseph Travaglini, Eric Wei, Charles Kwok Fai Chan, et al. 2017.\n‚ÄúIndex Switching Causes ‚ÄòSpreading-of-Signal‚Äô Among\nMultiplexed Samples in Illumina HiSeq 4000 DNA\nSequencing.‚Äù bioRxiv. https://doi.org/10.1101/125724.\n\n\nSlatko, Barton E, Andrew F Gardner, and Frederick M Ausubel. 2018.\n‚ÄúOverview of Next-Generation Sequencing Technologies.‚Äù\nCurrent Protocols in Molecular Biology / Edited by Frederick M.\nAusubel ... [Et Al.] 122 (1): e59. https://doi.org/10.1002/cpmb.59.\n\n\nValk, Tom van der, Francesco Vezzi, Mattias Ormestad, Love Dal√©n, and\nKaterina Guschanski. 2019. ‚ÄúIndex Hopping on the Illumina\nHiseqX Platform and Its Consequences for Ancient\nDNA Studies.‚Äù Molecular Ecology Resources,\nMarch. https://doi.org/10.1111/1755-0998.13009."
  }
]