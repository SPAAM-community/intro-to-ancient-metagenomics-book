<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="James A. Fellows Yates">

<title>1&nbsp; Introduction to NGS Sequencing – Introduction to Ancient Metagenomics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./introduction-to-ancient-dna.html" rel="next">
<link href="./section-theory.html" rel="prev">
<link href="./favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-78f7a97a8fd9205abc8dd23e5c196275.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<meta property="og:title" content="1&nbsp; Introduction to NGS Sequencing – Introduction to Ancient Metagenomics">
<meta property="og:description" content="">
<meta property="og:image" content="https://spaam-community.github.org/intro-to-ancient-metagenomics-book/assets/images/chapters/intro-to-ngs/fig-intro-ngs-fig-3dhelix.png">
<meta property="og:site_name" content="Introduction to Ancient Metagenomics">
<meta property="og:image:height" content="448">
<meta property="og:image:width" content="542">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./section-theory.html">Theory</a></li><li class="breadcrumb-item"><a href="./introduction-to-ngs-sequencing.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to NGS Sequencing</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to Ancient Metagenomics</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./citing-this-book.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Citing this book</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./authors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Authors</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./foreword.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Foreword</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./acknowledgements.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Acknowledgements</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./before-you-start.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Before you Start</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Theory</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction-to-ngs-sequencing.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to NGS Sequencing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction-to-ancient-dna.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to Ancient DNA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction-to-metagenomics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introduction to Metagenomics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction-to-microbial-genomics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Introduction to Microbial Genomics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction-to-edna.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Introduction to Environmental DNA</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section-useful-skills.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Useful Skills</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bare-bones-bash.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Introduction to the Command Line</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r-tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Introduction to R and the Tidyverse</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./python-pandas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Introduction to Python and Pandas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./git-github.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introduction to Git(Hub)</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section-ancient-metagenomics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ancient Metagenomics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./taxonomic-profiling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Taxonomic Profiling, OTU Tables and Visualisation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./denovo-assembly.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title"><em>De novo</em> Genome Assembly</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./authentication.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Authentication</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./contamination.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Contamination</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section-ancient-genomics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ancient Genomics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./genome-mapping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Genome Mapping</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./phylogenomics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Phylogenomics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./section-ancient-metagenomic-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ancient Metagenomic Resources</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing-ancient-metagenomic-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Accessing Ancient Metagenomic Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ancient-metagenomic-pipelines.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Ancient Metagenomic Pipelines</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./deprecated-chapters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Deprecated Chapters</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functional-profiling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Functional Profiling</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./appendices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter-writing-guidelines.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Chapter Writing Guidelines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter-template.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Chapter Page Template</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter-checklist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Chapter Checklist</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#basic-concepts" id="toc-basic-concepts" class="nav-link active" data-scroll-target="#basic-concepts"><span class="header-section-number">1.1</span> Basic Concepts</a>
  <ul class="collapse">
  <li><a href="#basic-structure-of-dna" id="toc-basic-structure-of-dna" class="nav-link" data-scroll-target="#basic-structure-of-dna">Basic structure of DNA</a></li>
  <li><a href="#dna-replication" id="toc-dna-replication" class="nav-link" data-scroll-target="#dna-replication">DNA replication</a></li>
  <li><a href="#extracting-dna" id="toc-extracting-dna" class="nav-link" data-scroll-target="#extracting-dna">Extracting DNA</a></li>
  <li><a href="#dna-sequencing" id="toc-dna-sequencing" class="nav-link" data-scroll-target="#dna-sequencing">DNA sequencing</a></li>
  <li><a href="#sanger-sequencing" id="toc-sanger-sequencing" class="nav-link" data-scroll-target="#sanger-sequencing">Sanger sequencing</a></li>
  </ul></li>
  <li><a href="#next-generation-sequencing" id="toc-next-generation-sequencing" class="nav-link" data-scroll-target="#next-generation-sequencing"><span class="header-section-number">1.2</span> Next generation sequencing</a>
  <ul class="collapse">
  <li><a href="#illumina-sequencing" id="toc-illumina-sequencing" class="nav-link" data-scroll-target="#illumina-sequencing">Illumina sequencing</a></li>
  <li><a href="#flow-cells-and-adapters" id="toc-flow-cells-and-adapters" class="nav-link" data-scroll-target="#flow-cells-and-adapters">Flow cells and adapters</a></li>
  <li><a href="#clustering" id="toc-clustering" class="nav-link" data-scroll-target="#clustering">Clustering</a></li>
  <li><a href="#sequencing-by-synthesis" id="toc-sequencing-by-synthesis" class="nav-link" data-scroll-target="#sequencing-by-synthesis">Sequencing-by-synthesis</a></li>
  <li><a href="#colour-chemistry" id="toc-colour-chemistry" class="nav-link" data-scroll-target="#colour-chemistry">Colour chemistry</a></li>
  <li><a href="#base-quality-and-paired-end-sequencing" id="toc-base-quality-and-paired-end-sequencing" class="nav-link" data-scroll-target="#base-quality-and-paired-end-sequencing">Base quality and paired-end sequencing</a></li>
  <li><a href="#base-calling-and-demultiplexing" id="toc-base-calling-and-demultiplexing" class="nav-link" data-scroll-target="#base-calling-and-demultiplexing">Base calling and demultiplexing</a></li>
  <li><a href="#fastq-file" id="toc-fastq-file" class="nav-link" data-scroll-target="#fastq-file">FASTQ File</a></li>
  </ul></li>
  <li><a href="#sequencing-and-considerations-for-ancient-metagenomics" id="toc-sequencing-and-considerations-for-ancient-metagenomics" class="nav-link" data-scroll-target="#sequencing-and-considerations-for-ancient-metagenomics"><span class="header-section-number">1.3</span> Sequencing and considerations for ancient metagenomics</a>
  <ul class="collapse">
  <li><a href="#low-dna-preservation" id="toc-low-dna-preservation" class="nav-link" data-scroll-target="#low-dna-preservation">Low DNA preservation</a></li>
  <li><a href="#index-hopping" id="toc-index-hopping" class="nav-link" data-scroll-target="#index-hopping">Index hopping</a></li>
  <li><a href="#sequencing-errors" id="toc-sequencing-errors" class="nav-link" data-scroll-target="#sequencing-errors">Sequencing errors</a></li>
  <li><a href="#dirty-genomes" id="toc-dirty-genomes" class="nav-link" data-scroll-target="#dirty-genomes">Dirty Genomes</a></li>
  <li><a href="#low-sequence-diversity-reads" id="toc-low-sequence-diversity-reads" class="nav-link" data-scroll-target="#low-sequence-diversity-reads">Low Sequence Diversity Reads</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">1.4</span> Summary</a></li>
  <li><a href="#questions-to-think-about" id="toc-questions-to-think-about" class="nav-link" data-scroll-target="#questions-to-think-about"><span class="header-section-number">1.5</span> Questions to think about</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">1.6</span> References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./section-theory.html">Theory</a></li><li class="breadcrumb-item"><a href="./introduction-to-ngs-sequencing.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to NGS Sequencing</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to NGS Sequencing</span></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>James A. Fellows Yates </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p>Next generation sequencing (NGS) revolutionised biology by providing rapid and cheap access to huge amounts of DNA sequence data. One unexpected benefit of the technology used in Illumina NGS sequencers was that it was also ideal for sequencing ultra-short ancient DNA.</p>
<p>In this chapter, we will go through:</p>
<ul>
<li>A brief overview of how DNA is structured</li>
<li>How DNA sequencing works</li>
<li>How most NGS sequenced DNA sequences are digitally represented</li>
</ul>
<p>Finally we will cover some important considerations of NGS sequencing for ancient metagenomic datasets.</p>
<section id="basic-concepts" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="basic-concepts"><span class="header-section-number">1.1</span> Basic Concepts</h2>
<section id="basic-structure-of-dna" class="level3">
<h3 class="anchored" data-anchor-id="basic-structure-of-dna">Basic structure of DNA</h3>
<p>To understand how sequencing works, we first need to be familiar with the basic structure of DNA. Deoxyribonucleic acid (DNA) is present in the vast majority of cells in your body and is the biological molecule famous for it’s ‘double helix’ structure (<a href="#fig-intro-ngs-fig-3dhelix" class="quarto-xref">Figure&nbsp;<span>1.1</span></a>). It encodes all the genetic information required for the development, growth, and function of living organisms.</p>
<p>Each strand of the double helix structure consists of four main components called nucleotides, which bind together in different orders. These nucleotides can be grouped into two categories:</p>
<ul>
<li>Pyrimidines: cytosine (C) and thymine (T)</li>
<li>Purines: guanine (G) and adenine (A)</li>
</ul>
<p>The nucleotides on one strand are connected via a sugar-phosphate ‘backbone’. The two strands are held together by the interaction of the hydrogen bond pairing between the four different nucleobases on each strand (<a href="#fig-intro-ngs-fig-2dhelix" class="quarto-xref">Figure&nbsp;<span>1.2</span></a>).</p>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-intro-ngs-fig-3dhelix" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-intro-ngs-fig-3dhelix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="assets/images/chapters/intro-to-ngs/fig-intro-ngs-fig-3dhelix.png" height="300" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-intro-ngs-fig-3dhelix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.1: Still from an animation of a 3D model of the DNA double helix. Source: Erin Rod, <a href="https://creativecommons.org/licenses/by/4.0/deed">CC BY 4.0</a>, via <a href="https://commons.wikimedia.org/wiki/File:The_Structure_of_DNA_GIF.gif">Wikimedia Commons</a>
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-intro-ngs-fig-2dhelix" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-intro-ngs-fig-2dhelix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="assets/images/chapters/intro-to-ngs/fig-intro-ngs-fig-2dhelix.png" height="300" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-intro-ngs-fig-2dhelix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.2: 2D molecular diagram of a DNA helix, with the sugar-phosphate backbone and amine groups labelled indicated. Source: Pradana Aumars, <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>, via <a href="https://commons.wikimedia.org/wiki/File:Structure_ADN.png">Wikimedia Commons</a>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>This pairing consists of one pyrimidine to one purine that are complementary to each other:</p>
<ul>
<li><code>C</code> with <code>G</code> (to remember: think CGI in animated movies)</li>
<li><code>A</code> and <code>T</code> (to remember: think AT-AT Walker from Star Wars, <a href="#fig-intro-ngs-fig-atatwalker" class="quarto-xref">Figure&nbsp;<span>1.3</span></a>)</li>
</ul>
<p>Therefore, whenever you find a <code>C</code> on one strand, you will normally find a <code>G</code> on the other strand (and vice versa), and the same for <code>A</code> and <code>T</code>.</p>
<p>What this means is that because of this complementary pairing, regardless of which strand you are ‘reading’, you can almost always reconstruct the order bases on the <em>other</em> strand.</p>
<div id="fig-intro-ngs-fig-atatwalker" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-intro-ngs-fig-atatwalker-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="assets/images/chapters/intro-to-ngs/fig-intro-ngs-fig-atatwalker.jpg" height="300" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-intro-ngs-fig-atatwalker-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.3: Lego reconstruction of AT AT walker from Star Wars. Source: Tim Moreillon, <a href="https://creativecommons.org/licenses/by-sa/2.0/deed">CC BY-SA 2.0 Generic</a>, via <a href="https://commons.wikimedia.org/wiki/File:LEGO_Star_Wars_AT-AT_Walker_(6740909421).jpg">Wikimedia Commons</a>
</figcaption>
</figure>
</div>
</section>
<section id="dna-replication" class="level3">
<h3 class="anchored" data-anchor-id="dna-replication">DNA replication</h3>
<p>This complementary base pairing characteristic of a DNA molecule is a critical factor of how DNA gets replicated (or copied) within a cell.</p>
<p>At it’s core, DNA replication consists of:</p>
<ol type="1">
<li>Unwinding the DNA helix and separating the two strands, by breaking the hydrogen bonds between the complementary bases using a helicase enzyme</li>
<li>Using a polymerase enzyme to add complementary new ‘free’ nucleotides floating in the cell to the exposed base on the strand (repeating this step for each base until a ‘stop’ signal is received)</li>
<li>Constructing bonds on the sugar-phosphate backbone of the new strand using a ligase enzyme</li>
</ol>
<p>A graphical representation can be seen of a helicase enzyme separating strangds canbe seen in <a href="#fig-intro-ngs-fig-dnareplication" class="quarto-xref">Figure&nbsp;<span>1.4</span></a>.</p>
<div id="fig-intro-ngs-fig-dnareplication" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-intro-ngs-fig-dnareplication-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="assets/images/chapters/intro-to-ngs/fig-intro-ngs-fig-dnareplication.jpg" height="300" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-intro-ngs-fig-dnareplication-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.4: Schematic diagram of DNA replication. A helicase unwinds DNA strand with DNA polymerases on the ‘leading’ and ‘lagging’ strand incorporating free nucleotides. Source: Christine Imiller, <a href="https://creativecommons.org/licenses/by-sa/4.0/deed">CC BY-SA 4.0</a>, via <a href="https://commons.wikimedia.org/wiki/File:DNA_Polymerase_DNA_Replication.png">Wikimedia Commons</a>
</figcaption>
</figure>
</div>
<p>This concept is important because it is the basis of how DNA sequencing works. With this, we can reconstruct the sequence of a DNA molecule for analysis.</p>
</section>
<section id="extracting-dna" class="level3">
<h3 class="anchored" data-anchor-id="extracting-dna">Extracting DNA</h3>
<p>To understand why specifically <em>NGS</em> sequencing revolutionised the field of palaeogenomics, we need to briefly compare the differences between how we get modern and ancient DNA.</p>
<p>To get DNA from ‘modern’ samples (i.e., living organisms), first a biological tissue or sample is acquired. We then typically break down (lyse) the cell membrane and/or walls, to release the molecular contents of the cell <span class="citation" data-cites="Danaeifar2022-sk">(<a href="#ref-Danaeifar2022-sk" role="doc-biblioref">Danaeifar 2022</a>)</span>. Extraction protocols then use a variety of enzymes or other mechanisms to degrade the other biomolecules in the cell (e.g., proteins, lipids, RNA) so that they do not ‘interfere’ with the extraction of the DNA itself. Finally, the DNA is separated and isolated out from the rest of the now-broken cell contents (purification).</p>
<p>This extracted ‘fresh’ DNA is typically in very long and intact strands that can be sort of imagined as long, soft spaghetti pasta like structures (<a href="#fig-intro-ngs-fig-moderndnaextraction" class="quarto-xref">Figure&nbsp;<span>1.5</span></a>).</p>
<div id="fig-intro-ngs-fig-moderndnaextraction" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-intro-ngs-fig-moderndnaextraction-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="assets/images/chapters/intro-to-ngs/fig-intro-ngs-fig-moderndnaextraction.jpg" class="img-fluid figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-intro-ngs-fig-moderndnaextraction-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.5: Simplified schematic diagram of the process of DNA extraction from living cells. Cell membranes are broken open, the extracted is treated to break down proteins and RNA, the DNA is separated out from the degraded biomolecules. Source: CNX OpenStax, <a href="https://creativecommons.org/licenses/by/4.0/deed">CC BY 4.0 International</a>, via <a href="https://commons.wikimedia.org/wiki/File:Figure_17_01_02.jpg">Wikimedia Commons</a>
</figcaption>
</figure>
</div>
<p>In contrast, while the concept of <em>ancient</em> DNA extraction is very similar, the end product of the extraction is different.</p>
<p>Taking a skeleton as an example, once a bone has been sampled for bone podwer, cell lysis is normally not necessary as the cells are already broken down due to age. Instead, we have to ‘liberate’ the DNA from the mineral matrix of the bone. So palaeogenomicists first demineralise the bone to release the DNA, before degrading the remaining non-nucleic acid biomolecules in the sample (typically with proteinases) and then purifying the DNA <span class="citation" data-cites="Andreeva2022-oe">(<a href="#ref-Andreeva2022-oe" role="doc-biblioref">Andreeva et al. 2022</a>)</span>.</p>
<p>In contrast, the resulting DNA molecules are quite different from the modern DNA. Rather than well cooked, soft spaghetti structures - ancient DNA molecules are more like extremely overcooked spaghetti. These molecules are highly degraded, broken down into very small fragments, and also often have ‘damage’ at the ends in the form of ‘modified nucleotides’ that do not represent the original sequence <span class="citation" data-cites="Dabney2013-zo">(<a href="#ref-Dabney2013-zo" role="doc-biblioref">Dabney, Meyer, and Pääbo 2013</a>, and see the <a href="./introduction-to-ancient-dna.html">Introduction to Ancient DNA chapter</a> for more information)</span>.<br>
Finally, the small amount of tiny and damaged DNA molecules typically sits in a ‘soup’ of ‘contaminating’ high-quality modern DNA from the surrounding burial and storage environment (<a href="#fig-intro-ngs-fig-ancientdnainbone" class="quarto-xref">Figure&nbsp;<span>1.6</span></a>).</p>
<p>As we will find out in the next section, these short fragments of DNA is not necessartily a disadvantage for NGS sequencing, but rather a benefit.</p>
<div id="fig-intro-ngs-fig-ancientdnainbone" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-intro-ngs-fig-ancientdnainbone-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="assets/images/chapters/intro-to-ngs/fig-intro-ngs-fig-ancientdnainbone.png" height="600" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-intro-ngs-fig-ancientdnainbone-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.6: © <a href="https://www.lucyreading.co.uk/project/ancient-dna/">Lucy Reading-Ikkanda</a> for The Scientist Magazine, June 2015 (reused here with permission). Very small fragmented ‘endogenous’ DNA is preserved in bone, but alongside more recent and modern contaminating microbial and recent human DNA also present within and around the mineral matrix.
</figcaption>
</figure>
</div>
</section>
<section id="dna-sequencing" class="level3">
<h3 class="anchored" data-anchor-id="dna-sequencing">DNA sequencing</h3>
<p>Now that we have our DNA, we want to be able to ‘read’ the order of the sequence of nucleotides that makes up a strand of the molecule.</p>
<p>Sequencing is the process of converting the long sequences of the four chemical nucleotides to the <code>ACTG</code> we can see on our computer screen. The result of this process is what we essentially apply all of our (meta)genomic analyses upon.</p>
<p>The core concept of most NGS sequencing methods <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> is to replicate the strand as normal. But instead of adding a standard nucleotide, we instead incorporate a modified nucleotide with a fluorophore attached to it. A type of fluorophore is a small molecule that emits a specific colour when excited by a laser. As there are four different nucleotides, each will emit a different colour <span class="citation" data-cites="Ju2006-cl">(<a href="#ref-Ju2006-cl" role="doc-biblioref">Ju et al. 2006</a>)</span>. Therefore if we record the colour emitted each time a modified nucleotide is added to a strand, we can reconstruct the sequence of the DNA nucleotides in order (<a href="#fig-intro-ngs-fig-colourednucleotides" class="quarto-xref">Figure&nbsp;<span>1.7</span></a>).</p>
<div id="fig-intro-ngs-fig-colourednucleotides" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-intro-ngs-fig-colourednucleotides-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="assets/images/chapters/intro-to-ngs/fig-intro-ngs-fig-colourednucleotides.jpeg" height="600" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-intro-ngs-fig-colourednucleotides-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.7: Molecular diagram of the four DNA nucleotides modified to include amine groups with fluorophores that will emit light when excited by a laser. Source: <span class="citation" data-cites="Ju2006-cl">(<a href="#ref-Ju2006-cl" role="doc-biblioref">Ju et al. 2006</a>)</span>
</figcaption>
</figure>
</div>
</section>
<section id="sanger-sequencing" class="level3">
<h3 class="anchored" data-anchor-id="sanger-sequencing">Sanger sequencing</h3>
<p>Historically, the first mass-production sequencing method was called Sanger sequencing (<a href="#fig-intro-ngs-fig-sangersequencing" class="quarto-xref">Figure&nbsp;<span>1.8</span></a>) <span class="citation" data-cites="Sanger1977-zw">(<a href="#ref-Sanger1977-zw" role="doc-biblioref">Sanger, Nicklen, and Coulson 1977</a>)</span>. This was the method used for sequencing the first human genome during the Human Genome Project <span class="citation" data-cites="Heather2015-zo">(<a href="#ref-Heather2015-zo" role="doc-biblioref">Heather and Chain 2015</a>)</span>.</p>
<p>The concept of Sanger sequencing involves making many copies of a single DNA molecule using replication. However, when adding the free nucleotides, within the replication mixture of a pool of (normal) free nucleotides are a proportion of the modified nucleotides mentioned above. These modified nucleotides include the ability to that emit light when excited by exposure of certain wavelengths or give off specific radiation signatures <span class="citation" data-cites="Valencia2013-wk">(<a href="#ref-Valencia2013-wk" role="doc-biblioref">Valencia et al. 2013</a>)</span>. In addition to the light emitting property, these modified nucleotides also contain a ‘blocking’ component that, once incorporated into the strand, prevents any further extension of the strand by other nucleotides.</p>
<p>Critically, as there is only a small proportion of blocking nucleotides amongst the pool of free nucleotides,the incorporation of the blocking nucleotides occurs at a slow rate and at different points during the replication process <span class="citation" data-cites="Shendure2011-om">(<a href="#ref-Shendure2011-om" role="doc-biblioref">J. A. Shendure et al. 2011</a>)</span>. This results in many replicates of the original molecules but all at different lengths (<a href="#fig-intro-ngs-fig-sangersequencing" class="quarto-xref">Figure&nbsp;<span>1.8</span></a>).</p>
<div id="fig-intro-ngs-fig-sangersequencing" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-intro-ngs-fig-sangersequencing-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="assets/images/chapters/intro-to-ngs/fig-intro-ngs-fig-sangersequencing.png" height="300" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-intro-ngs-fig-sangersequencing-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.8: Diagram of sanger sequencing, with a primer, template and free blocking nucleotides being added to ends of molecules at random lengths. The molecules are passed through a size-selecting capillary with a light detector, which identifies which of the four blocking nucleotides are passing through the capillary at a given point and recorded in a chromatogram. Source: Estevezj, <a href="https://creativecommons.org/licenses/by-sa/3.0/">CC BY-SA 3.0 Unported</a> via <a href="https://commons.wikimedia.org/wiki/File:Sanger-sequencing.svg">Wikimedia Commons</a>
</figcaption>
</figure>
</div>
<p>Once many different-length replicates of the template molecules are ready, the Sanger sequencing method involves running the pool of DNA fragments through a capillary gel. As all the molecules are of different sizes, they will move through the gel at different speeds, and therefore spread out based on the length of the molecule <span class="citation" data-cites="Valencia2013-wk">(<a href="#ref-Valencia2013-wk" role="doc-biblioref">Valencia et al. 2013</a>)</span>. In modern sanger sequencing machines, a laser is fired at the gel at regular intervals, and the light emitted from the modified nucleotides is detected. Shorter molecules will move faster through the gel, and therefore will be detected first, whereas longer molecules will be detected later. Therefore, by detecting the light emitted as the incrementally longer molecules pass through the gel, we can reconstruct the sequence of the nucleotides along the module.</p>
<p>The result is a chromatogram, which is a graph that records the strength of each colour at each point in the gel band (<a href="#fig-intro-ngs-fig-chromatogram" class="quarto-xref">Figure&nbsp;<span>1.9</span></a>).</p>
<div id="fig-intro-ngs-fig-chromatogram" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-intro-ngs-fig-chromatogram-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="assets/images/chapters/intro-to-ngs/fig-intro-ngs-fig-chromatogram.jpg" height="300" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-intro-ngs-fig-chromatogram-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.9: Example of a gel-based chromatogram with four columns with different bands. Each column corresponds to a different nucleotide and the light that is emitted at that position along the molecule. On the right is intensity graph of each colour given off by each modified nucleotide at each position. Source: Morse Phoque (Abizar), <a href="https://creativecommons.org/licenses/by-sa/3.0/">CC BY-SA 3.0 Unported</a> via <a href="https://commons.wikimedia.org/wiki/File:Radioactive_Fluorescent_Seq.jpg">Wikimedia Commons</a>
</figcaption>
</figure>
</div>
<p>While this method was used for the first sequencing of the human genome, it was very slow and very expensive. It does not scale well due to the requirement of having many redundant copies to sequence each molecule <span class="citation" data-cites="Schloss2020-gp">(<a href="#ref-Schloss2020-gp" role="doc-biblioref">Schloss et al. 2020</a>)</span>. Furthermore, this method also requires a large amount of starting DNA. This is problematic when we are handling degraded ancient DNA, as it is very rare to have a sufficient concentration of DNA to be able to use Sanger with sequencing - unless the initially preservation is high enough, and/or we take very large amounts input sample (which is typically via destructive methods).</p>
</section>
</section>
<section id="next-generation-sequencing" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="next-generation-sequencing"><span class="header-section-number">1.2</span> Next generation sequencing</h2>
<p>In 2005 the first ‘Next Generation Sequencing’ (NGS) machines were released <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>, in the form of Roche’s 454 Pyrosequencing <span class="citation" data-cites="Heather2015-zo">(<a href="#ref-Heather2015-zo" role="doc-biblioref">Heather and Chain 2015</a>)</span>.</p>
<p>These new sequencers were able to quickly and cheaply sequence millions of DNA molecules at once, revolutionising genetics and enabling ‘accessible’ genomics to a much wider group of scientists <span class="citation" data-cites="Koboldt2013-kk">(<a href="#ref-Koboldt2013-kk" role="doc-biblioref">Koboldt et al. 2013</a>)</span>.</p>
<p>While a few companies emerged with competing NGS sequencers employing different techniques, such as PacBio and IonTorrent, the platform that was been by far the most successful is the one from Illumina <span class="citation" data-cites="Heather2015-zo">(<a href="#ref-Heather2015-zo" role="doc-biblioref">Heather and Chain 2015</a>)</span>. These Illumina machines have been so successful, they have almost exclusively sequenced the entire corpus of ancient DNA sequencing data. Therefore the rest of this chapter will focus just on Illumina sequencing.</p>
<section id="illumina-sequencing" class="level3">
<h3 class="anchored" data-anchor-id="illumina-sequencing">Illumina sequencing</h3>
<p>Illumina sequencing relies on a process termed ‘Sequencing by synthesis’ (SBS) but with <em>reversible</em> terminators <span class="citation" data-cites="Shendure2008-fh">(<a href="#ref-Shendure2008-fh" role="doc-biblioref">J. Shendure and Ji 2008</a>)</span>. This follows a similar concept as Sanger Sequencing in that we add modified nucleotides with fluorophores for emitting per-nucleotide light. However instead of using multiple molecules of different lengths that are separated via a gel, it uses nucleotides that can be reversibly blocked, and thus after removing the ‘block’ can continue incorporating nucleotides within a single molecule <span class="citation" data-cites="Bentley2008-oj">(<a href="#ref-Bentley2008-oj" role="doc-biblioref">Bentley et al. 2008</a>)</span>.</p>
<p>This works by immobilising the DNA so it stays at one location on a special type of plate <span class="citation" data-cites="Shendure2008-fh">(<a href="#ref-Shendure2008-fh" role="doc-biblioref">J. Shendure and Ji 2008</a>)</span>. The machine then performs a typical DNA replication, adding fluorophore modified nucleotides one at a time. Instead of a chromatogram, the machine takes a type of photo of the emitted light. However the key difference is that when after this photo is taken, the blocking part of the oligo is <em>removed</em>, so the next modified oligo can added.</p>
<p>To visualise how this looks like, we can imagine looking down at a rectangular plate. On this surface, we can see millions of coloured tiny dots (<a href="#fig-intro-ngs-fig-flowcell" class="quarto-xref">Figure&nbsp;<span>1.10</span></a>), that are all changing colour in realtime as each new nucleotide is added along the new strand.</p>
<div id="fig-intro-ngs-fig-flowcell" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-intro-ngs-fig-flowcell-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="assets/images/chapters/intro-to-ngs/fig-intro-ngs-fig-flowcell.png" height="300" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-intro-ngs-fig-flowcell-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.10: Graphical representation of an Illumina sequencing flowcell during sequencing. Each colour dot corresponds to a single cluster of copies of the same DNA molecule emitting light corresponding to a single nucleotide along the molecular sequence.
</figcaption>
</figure>
</div>
<p>However, before we start to capture the images of the new nucleotides on an Illumina platform, we need to prepare the DNA molecules in a specific way.</p>
</section>
<section id="flow-cells-and-adapters" class="level3">
<h3 class="anchored" data-anchor-id="flow-cells-and-adapters">Flow cells and adapters</h3>
<p>To ensure that DNA molecules do not move while recording the light being emitted by a modified nucleotide, in Illumina sequencing the DNA molecules are bound to a special glass slide called a flowcell (<a href="#fig-intro-ngs-fig-flowcellschematic" class="quarto-xref">Figure&nbsp;<span>1.11</span></a>). This also ensures the DNA does not get washed away during the sequencing process as different solutions wash through the machine between each step.</p>
<div id="fig-intro-ngs-fig-flowcellschematic" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-intro-ngs-fig-flowcellschematic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="assets/images/chapters/intro-to-ngs/fig-intro-ngs-fig-flowcellschematic.png" height="300" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-intro-ngs-fig-flowcellschematic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.11: Schematic diagram of a Illumina HiSeq-like flowcell. The glass slide has eight ‘lanes’ (top), with wells at each end of each lane. The sequencing library is injected into the well, and moves through the lane in the direction as indicated by the arrows. Indicated by the dark green dots at the the bottom of each lane are the synthetic oligonucleotides that capture the DNA molecules, also known as the ‘lawn’. Image based on and inspired by <span class="citation" data-cites="Bronner2013-sv">Bronner et al. (<a href="#ref-Bronner2013-sv" role="doc-biblioref">2013</a>)</span> .
</figcaption>
</figure>
</div>
<div id="fig-intro-ngs-fig-grassy-lawn" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-intro-ngs-fig-grassy-lawn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="assets/images/chapters/intro-to-ngs/fig-intro-ngs-fig-grassy-lawn.jpg" height="300" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-intro-ngs-fig-grassy-lawn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.12: Photo of a lawn of grass, as a metaphor of the ‘lawn’ of artificial oligonucleotide sequences of an Illumina flowcell. Source: Animaldetector, <a href="https://creativecommons.org/licenses/by-sa/3.0/">CC BY-SA 3.0</a> via <a href="https://commons.wikimedia.org/wiki/File:Seededfertilizedlawn.JPG">Wikimedia Commons</a>
</figcaption>
</figure>
</div>
<p>To immobilise the DNA, the flow cell is coated with a ‘lawn’ (<a href="#fig-intro-ngs-fig-grassy-lawn" class="quarto-xref">Figure&nbsp;<span>1.12</span></a>) of synthetic oligonucleotides (i.e., artificially produced DNA molecule with a specific and known sequence also known as ‘oligos’) <span class="citation" data-cites="Holt2008-wk">(<a href="#ref-Holt2008-wk" role="doc-biblioref">Holt and Jones 2008</a>)</span>. By attaching (i.e., ligating) the <em>complementary</em> sequence of the synthetic oligos to the DNA molecules from our sample, when our DNA molecules flow over the lawn (<a href="#fig-intro-ngs-fig-flowcellschematic" class="quarto-xref">Figure&nbsp;<span>1.11</span></a>), the complementary bonds between the oligos on the lawn and the complementary sequence on our DNA molecules will form. This then will hold the DNA in place and ‘immoblise’ it for capturing emitted light at a specific location on the flow cell.</p>
<p>The process of adding the complementary synthetic oligos, referred to as ‘Adapters’, to the DNA molecules of a sample is called ‘Library preparation’.</p>
<p>These adapter sequences not only include the complementary sequence to flowcell oligos, but also an additional sequence that acts as a priming site for polymerases to start the replication process. Furthermore, researchers have exploited the ability of Illumina sequencers to sequence millions of molecules at once, to allow them to also sequence multiple <em>samples</em> at once. They do this by adding additional sequences to the adapter sequence construct that consist of short sample-specific ‘indices’ or ‘barcodes’ <span class="citation" data-cites="Kircher2012-fg">(<a href="#ref-Kircher2012-fg" role="doc-biblioref">Kircher, Sawyer, and Meyer 2012</a>)</span>. These indices allow DNA molecules from different samples to be sequenced at the same time, and then separated back into the groups of molecules from the same samples during data analysis. This system of sequencing multiple samples at once is known as ‘multiplexing’ <span class="citation" data-cites="Church1988-cr">(<a href="#ref-Church1988-cr" role="doc-biblioref">Church and Kieffer-Higgins 1988</a>)</span>.</p>
<div id="fig-intro-ngs-fig-library-construct" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-intro-ngs-fig-library-construct-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="assets/images/chapters/intro-to-ngs/fig-intro-ngs-fig-library-construct.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-intro-ngs-fig-library-construct-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.13: Annotated library construct of a DNA molecule prepared for sequencing on Illumina platforms. The P5 and P7 primers are complementary to the flow cell oligo ‘lawn’, the i5 and i7 indices act as the library specific ‘barcode’ used for separating samples when performing multiplex-sequencing, The Read 1 and Read 2 primers act as priming sites for sequencing the template molecule (in this, case an ancient DNA molecule). Emojis from
</figcaption>
</figure>
</div>
<p>The completed index, adapter, and target DNA molecule construct (<a href="#fig-intro-ngs-fig-library-construct" class="quarto-xref">Figure&nbsp;<span>1.13</span></a>) of all molecules from a given construction protocol run is termed a library, and this is what is injected into the sequencing machine.</p>
</section>
<section id="clustering" class="level3">
<h3 class="anchored" data-anchor-id="clustering">Clustering</h3>
<p>Once a library is injected into a flowcell, and each DNA molecule of the library is bound to it’s unique own location on the flowcell, we could start sequencing. However, there is the problem that the light emitted from a single tiny fluorophore is not strong enough to be captured by the camera in the sequencer.</p>
<p>The Illumina platforms get around this through a process called ‘clustering’ <span class="citation" data-cites="Heather2015-zo">(<a href="#ref-Heather2015-zo" role="doc-biblioref">Heather and Chain 2015</a>)</span>. The clustering process makes many identical copies of the molecule right next to the original template molecule. When this cluster of DNA copies emit the light from the same nucleotide along their sequence at the same time, the light collectively emitted will now be sufficiently strong to be captured by the camera.</p>
<p>To make sufficient copies of the ‘template’ molecule efficiently, this clustering is carried out using ‘bridge amplification’ <span class="citation" data-cites="Bentley2008-oj">(<a href="#ref-Bentley2008-oj" role="doc-biblioref">Bentley et al. 2008</a>)</span>.</p>
<p>The process of bridge amplification is as follows:</p>
<ol type="1">
<li>A single-stranded DNA molecule is immobilised on the flow cell via the adapter at <em>one</em> end of the module</li>
<li>The DNA is ‘bent over’</li>
<li>The oligo adapter at the other end of the molecule binds to another complementary flow-cell oligo in its close vicinity (forming a bridge)</li>
<li>A priming sequence, free nucleotides, and a polymerase is then added to the flow cell</li>
<li>The reverse complement of the DNA molecule is made via replication, and the polymerase mixture is washed away</li>
<li>The two strands are then separated to form two single-stranded DNA molecules (with the new strand representing the reverse complement of the original template molecule)</li>
<li>Repeat 1-5 for the two new strands until sufficient copies are made</li>
</ol>
<p>This process is also depicted in <a href="#fig-intro-ngs-fig-bridgeamplification.png" class="quarto-xref">Figure&nbsp;<span>1.14</span></a>.</p>
<div id="fig-intro-ngs-fig-bridgeamplification.png" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-intro-ngs-fig-bridgeamplification.png-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="assets/images/chapters/intro-to-ngs/fig-intro-ngs-fig-bridgeamplification.png" height="600" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-intro-ngs-fig-bridgeamplification.png-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.14: Diagram of bridge amplification. Single stranded DNA molecules are bound to a flow cell using adapter sequences to complementary oligos on the flow cell. The molecule and chemically bent over so the reverse end also binds, and a polymerase reconstructs the complementary strand. The two strands are separated by cleaving of one adapter, representing the ‘forward’ and ‘reverse’ strand. Both strands undergo the same process repeatedly to make many copies. Source: DMLapato, <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0 International</a> via <a href="https://commons.wikimedia.org/wiki/File:Cluster_Generation.png">Wikimedia Commons</a>
</figcaption>
</figure>
</div>
<p>Of course, after had many cycles of replication, we will have in a single cluster both forward and reverse complement copies of the same DNA molecule. As this would emit two different colours at each position along the sequence, one of the strand ‘directions are’ removed by ‘trimming’ the flow cell lawn at one of the adapter sequences</p>
</section>
<section id="sequencing-by-synthesis" class="level3">
<h3 class="anchored" data-anchor-id="sequencing-by-synthesis">Sequencing-by-synthesis</h3>
<p>With our cluster of many copies of the same DNA molecule all in the same direction, we can now start the ‘Sequencing by synthesis’ (SBS) process itself.</p>
<p>As with replication and Sanger sequencing, SBS involves adding free modified nucleotides to the template strand (with only the complementary base being able to be incorporated to the exposed strand at any one point), the modified nucleotides are excited with a laser, and a picture is taken <span class="citation" data-cites="Bentley2008-oj">(<a href="#ref-Bentley2008-oj" role="doc-biblioref">Bentley et al. 2008</a>)</span>.</p>
<p>The main difference with Sanger sequencing is we can actually reuse the same DNA molecule to add more nucleotides along the same strand - rather than ‘discarding’ due to the permanently blocking nucleotides. This makes the SBS technique more resource sufficient, both in reagents (you need fewer copies of the molecule and recycle the same original copies of template molecules), but also in space as it is not necessary to separate out the molecules in a gel. Instead, they can be all fixed in a tightly packed layout on the flowcell.</p>
<div id="fig-intro-ngs-fig-sequencingbysynthesis" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-intro-ngs-fig-sequencingbysynthesis-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="assets/images/chapters/intro-to-ngs/fig-intro-ngs-fig-sequencingbysynthesis.png" height="300" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-intro-ngs-fig-sequencingbysynthesis-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.15: Diagram of sequencing by synthesis. Free modified nucleotides bind to a strand next at a priming site. The blocking fluorophore prevents other nucleotides from binding, and when excited by a laser, emits a light specific to that nucleotide type the colour of which is recorded by a camera. The blocking fluorophore is cleaved off and the cycle repeats with the next nucleotide along the seqeuence. Source: Abizar Lakdawalla, <a href="https://creativecommons.org/licenses/by-sa/3.0/">CC BY-SA 3.0 Unported</a> via <a href="https://en.wikipedia.org/wiki/File:Sequencing_by_synthesis_Reversible_terminators.png">Wikimedia Commons</a>
</figcaption>
</figure>
</div>
<p>The process as depicted in <a href="#fig-intro-ngs-fig-sequencingbysynthesis" class="quarto-xref">Figure&nbsp;<span>1.15</span></a> can be broken down to:</p>
<ol type="1">
<li>On a single stranded molecule, bind a primer to the molecule’s adapter priming site</li>
<li>Add fluorescently labelled nucleotides (with a reversible terminator) to the flow cell</li>
<li>Only complementary (modified) nucleotides will bind to the template strand at the first exposed base</li>
<li>Wash away unbound nucleotides</li>
<li>Fire a laser to excite the modified nucleotides to emit the corresponding colour, and take a picture</li>
<li>Clip off the fluorophore part of the nucleotide</li>
<li>Repeat 2-6 until the entire strand is sequenced</li>
</ol>
<p>On Illumina sequencers, the number of repetitions (known as cycles) typically happens either 50, 75, or 125 times, depending on the machine and the type of sequencing chemistry kit.</p>
<p>We can see a small fraction of such a flow cell in <a href="#fig-intro-ngs-fig-sbsimagecapture" class="quarto-xref">Figure&nbsp;<span>1.16</span></a>. Each coloured dot corresponds to a cluster of DNA molecules. At each cycle (each photo), a new nucleotide is added to the strand, and a laser is fired to excite the fluorophores. We can see two different clusters emit different lights, as they are different DNA molecules and thus have different nucleotides at that particular ‘cycle’ (or position in the sequence) of the ‘replication’ process. By converting the emitted light to the known corresponding A, C, G, T, at each photo, we can reconstruct the sequence of the DNA molecule.</p>
<div id="fig-intro-ngs-fig-sbsimagecapture" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-intro-ngs-fig-sbsimagecapture-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="assets/images/chapters/intro-to-ngs/fig-intro-ngs-fig-sbsimagecapture.png" height="300" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-intro-ngs-fig-sbsimagecapture-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.16: Diagram of sequencing by synthesis. Each frame represents a camera photo taken at the same location on the flow cell. Each coloured dot represents a different cluster of many copies of the same immoblised DNA molecule. By recording the colour change at each location across each frame, the DNA molecule’s nucleotide sequence can be reconstructed. Source: EBI Training, <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> via <a href="https://www.ebi.ac.uk/training/online/courses/functional-genomics-ii-common-technologies-and-data-analysis-methods/next-generation-sequencing/second-generation-sequencing/illumina-sequencing/">EBI Training</a>
</figcaption>
</figure>
</div>
<p>One of the reasons why Illumina sequencers (and similar NGS technologies) have been so successful in the sequencing industry is is that this process is happening across millions of clusters at the same time.</p>
<p>We are hopefully now starting to feel comfortable with the concept for one-colour equals one nucleotide. To throw a curve ball, Illumina sequencers actually have <em>three</em> different ‘colour chemistries’ that they use on different machines.</p>
</section>
<section id="colour-chemistry" class="level3">
<h3 class="anchored" data-anchor-id="colour-chemistry">Colour chemistry</h3>
<p>To be able to offer cheaper machines, Illumina came up with alternative systems that require a fewer number of colours to be detected <span class="citation" data-cites="Fu2025-oq">(<a href="#ref-Fu2025-oq" role="doc-biblioref">Fu et al. 2025</a>)</span>. These variants are often referred to different ‘colour chemistries’.</p>
<p>A list of Illumina platforms and their colour chemistries (at the time of writing) areas follows below:</p>
<ul>
<li>Four-colour chemistry
<ul>
<li>Illumina HiSeq</li>
<li>Illumina MiSeq</li>
</ul></li>
<li>Two-colour chemistry
<ul>
<li>Illumina NovaSeq</li>
<li>Illumina NextSeq</li>
</ul></li>
<li>One-colour chemistry
<ul>
<li>Illumina iSeq</li>
</ul></li>
</ul>
<p>In the vast majority of cases, our data will be only sequenced on four- and two-colour chemistries, so we will focus on these two.</p>
<p>In the case of the Illumina HiSeq and MiSeq platforms, the system for sequencing is as described previously: each of the four bases of the nucleotides that make up DNA will have a reversible-terminator variant, and each of these variants will have a specific fluorophore that will emit one of four colours. Therefore, the camera on the machine is designed to be able to pick up each of the four different wavelengths through different imaging channels.</p>
<p>In contrast, two-colour chemistry machines will only have imaging channels that detect have two colours - red and green (<a href="#fig-intro-ngs-fig-twocolourchemistry" class="quarto-xref">Figure&nbsp;<span>1.17</span></a>). If the machine detects only green being emitted from a cluster on the flowcell, this correspond to T. If the machine detects only red, it records a C. If the machine detects <em>both</em> red and green wavelengths being emitted from a cluster - this corresponds to an A. If no colour is emitted, this is <em>assumed</em> to be a G.</p>
<div id="fig-intro-ngs-fig-twocolourchemistry" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-intro-ngs-fig-twocolourchemistry-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="assets/images/chapters/intro-to-ngs/fig-intro-ngs-fig-twocolourchemistry.png" height="300" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-intro-ngs-fig-twocolourchemistry-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.17: Graphical representation of difference between four- (left) and two-colour (right) chemistry of Illumina Platforms. While in four-colour chemistry machines there is one colour for each nucleotide, two colour chemistry models emit single colours for <code>T</code> and <code>C</code>, a mixture of both wavelengths for <code>A</code>, and no colour is assumed to represent a <code>G</code>. Inspired by <a href="https://www.ecseq.com/support/ngs/do_you_have_two_colors_or_four_colors_in_Illumina">https://www.ecseq.com/support/ngs/do_you_have_two_colors_or_four_colors_in_Illumina</a>
</figcaption>
</figure>
</div>
<p>This characteristic of two colour-chemistry thus means we have to be aware of the type of sequencer our data was generated on, as this will require slightly different computational preprocessing <span class="citation" data-cites="De-Kayne2021-pc">(<a href="#ref-De-Kayne2021-pc" role="doc-biblioref">De-Kayne et al. 2021</a>)</span>, as we will see later on in the section on <a href="#low-sequence-diversity">Low sequence diversity</a>.</p>
</section>
<section id="base-quality-and-paired-end-sequencing" class="level3">
<h3 class="anchored" data-anchor-id="base-quality-and-paired-end-sequencing">Base quality and paired-end sequencing</h3>
<p>Another consideration with Illumina sequencing kits is not just the number of cycles, but what ‘pairment’ they kit has.</p>
<p>As we all know, biology is not like physics where everything is perfect and ‘logical’ <a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. Biology likes to be messy, and things often do not stay consistent.</p>
<p>The same applies to sequencing - as the sequencer goes through each cycle of adding a new nucleotide to each DNA strand in a cluster, ‘mistakes’ will increasingly start to happen <span class="citation" data-cites="Metzker2010-qw">(<a href="#ref-Metzker2010-qw" role="doc-biblioref">Metzker 2010</a>)</span>. Polymerases will not bind properly, or fall off, or skip nucleotides, or even add the wrong base. The accumulated effects of these mistakes across all DNA strands in a cluster is that the emitted light during the imaging part of the cycle becomes less clearly one colour, as mixtures of wavelengths are emitted. This results in our confidence that <em>correct</em> nucleotide has been recorded at a given position of the DNA molecule becomes lower.</p>
<p>Sequencers address this in two ways.</p>
<p>Firstly, when measuring the particular base being recorded, all sequencers will at the same time calculate a ‘base quality’ that is associated with that call <span class="citation" data-cites="Cacho2016-ci">(<a href="#ref-Cacho2016-ci" role="doc-biblioref">Cacho et al. 2016</a>)</span>. This corresponds to the confidence (via a probability) that the recorded base was the correct one. For example, if the wavelength was mostly one colour (let’s say red for <code>C</code>) but the camera picked up a bit of another colour (lets say green for <code>T</code>), it will record <code>C</code> in the output, but the base quality score associated with this base call will be lower. If the sequencer’s camera picks up wavelengths of all four colours from the same cluster at the same time - or even no light is detected at all - then the base quality for that position in that DNA molecule will be recorded as an N and a confidence score of 0.</p>
<p>Secondly, specifically for Illumina sequencers, there is the concept of ‘paired-end’ sequencing <span class="citation" data-cites="Bentley2008-oj">(<a href="#ref-Bentley2008-oj" role="doc-biblioref">Bentley et al. 2008</a>)</span>. There is an overall drop in base quality (i.e., confidence we have the right nucleotide) the closer we get to the end of the molecule due to the accumulated mistakes over time. To counteract this, we can freshly sequence the molecule again but in the <em>reverse</em> direction. This way, we can ‘merge’ and take an average of the two base quality scores of two independent ‘observations’ of the nucleotide at a given position. So if the last base when reading the molecule in the forward direction is an N (due to ambiguous wavelength emission), we can correct or ‘recover’ this last base by making it the <em>first</em> base we call in when sequencing in the reverse direction from scratch with fresh reagents.</p>
<p>This works as Illumina sequencers can conveniently re-use the ‘bending over’ approach as performed by the ‘bridge’ amplification method during clustering we saw earlier in this chapter.</p>
<p>In other words, after bending over, the opposite flowcell oligo from the forward reverse flowcell anchor is cut so the ‘end’ of the original molecule is now bound to the flow cell and becomes the ‘start’ of the new cluster (<a href="#fig-intro-ngs-fig-pairedendsequencing" class="quarto-xref">Figure&nbsp;<span>1.18</span></a>). This paired-end sequencing technique means we get a pair of files - both with the same sequence from each cluster, but one has the molecule ‘read’ in the forward direction, and the other file with the ‘reverse’ direction.</p>
<p>Another added benefit of paired-end sequencing is that we can recover longer molecules <span class="citation" data-cites="Magoc2011-xl">(<a href="#ref-Magoc2011-xl" role="doc-biblioref">Magoč and Salzberg 2011</a>)</span>. In cases where the DNA molecule is <em>longer</em> than the number of cycles of the chemistry kit, by flipping over the molecule and sequencing from the other end, we can recover the end of the molecule that otherwise falls outside the original number of cycles. Of course, if the molecule is longer than the sum of both set of cycles (e.g.&nbsp;a 120bp molecule, even though the sequencing kit is only two times 50bp), we will still miss the ‘middle’ part of the molecule. However, this is counteracted by the sheer number of independent molecules sequenced, so the ‘missing’ part can be filled in from another sequencing DNA molecule that ‘starts’ in this position.</p>
<div id="fig-intro-ngs-fig-pairedendsequencing" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-intro-ngs-fig-pairedendsequencing-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="assets/images/chapters/intro-to-ngs/fig-intro-ngs-fig-pairedendsequencing.png" class="img-fluid figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-intro-ngs-fig-pairedendsequencing-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.18: Diagram showing a broad overview of how Illumina paired-end sequencing works for a single DNA molecule. 1. The single-stranded DNA strand is attached to the flow cell, and read in one direction. 2. The molecule is denatured and one strand gets discarded. 3. The molecule is bent over (similar to bridge amplification), and the adapter at the other end is bound to the flow cell. 4. The original anchored end of the molecule is then cut, allowing the original ‘end’ to become the new starting point sequencing. 5. The molecule is sequenced in the reverse direction. Emojis from <a href="https://openmoji.org/">openmoji.org</a> (<a href="https://creativecommons.org/licenses/by-sa/4.0/#">CC-BY SA 4.0</a>).
</figcaption>
</figure>
</div>
<p>It should be noted, however, that the added benefit of sequencing <em>longer</em> molecules via paired-end sequencing is not always relevant to older ancient DNA or ancient metagenomics. This is because most ‘true’ DNA molecules are often <em>shorter</em> than the sequencing cycles of a typical Illumina kit. That said, fragmented ancient DNA molecules follow a distribution of molecule lengths, and retrieval of longer reads can be useful during in analyses such as <a href="./denovo-assembly.html"><em>de novo</em> assembly</a> for scaffolding purposes <span class="citation" data-cites="Ayling2020-ra">(<a href="#ref-Ayling2020-ra" role="doc-biblioref">Ayling, Clark, and Leggett 2020</a>)</span>.</p>
</section>
<section id="base-calling-and-demultiplexing" class="level3">
<h3 class="anchored" data-anchor-id="base-calling-and-demultiplexing">Base calling and demultiplexing</h3>
<p>We now understand how the machine itself ‘reads’ the DNA molecule clusters on the flow cell.</p>
<p>But how do these images get converted to a format that we can read on our computer screens? Furthermore, if we have sequenced multiple samples at the same time with multiplexing (each with their own sample-specific indices), how do we separate the molecules from sample out?</p>
<p>We can do this with two, often integrated, steps.</p>
<p>Base calling is the process of converting the images to digital text-based <code>A</code>, <code>C</code>, <code>T,</code> and <code>G</code>s <span class="citation" data-cites="Rougemont2008-ug">(<a href="#ref-Rougemont2008-ug" role="doc-biblioref">Rougemont et al. 2008</a>)</span>. This is not something the vast majority of researchers have to do, as nowadays it happens on the sequencer itself or by the sequencing technicians and thus not necessary for researchers to carry out.</p>
<p>However, once the file with the digital representations of the sequences is taken off the machine, and if not also performed by the sequencing facility, we may have to perform something called ‘demultiplexing’ (<a href="#fig-intro-ngs-fig-demultiplexing" class="quarto-xref">Figure&nbsp;<span>1.19</span></a>). This involves using computational software that identifies the known index sequence at the beginning of each sequence entry in the base-called file, and then separates all reads containing the same sample-specific index into it’s own independent file.</p>
<div id="fig-intro-ngs-fig-demultiplexing" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-intro-ngs-fig-demultiplexing-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="assets/images/chapters/intro-to-ngs/fig-intro-ngs-fig-demultiplexing.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-intro-ngs-fig-demultiplexing-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.19: Schematic diagram showing the demultimultiplexing concept. Multiple libraries have been sequenced in a single lane of a sequencer. Each library has their own index sequence combination. Demultiplexing consists of taking the large single-lane FASTQ file, and using information recorded during the library construction to assign each read to it’s associated sample. These reads then are sorted by sample and separated into separate per-sample FASTQ files.
</figcaption>
</figure>
</div>
<p>While these processes are not something most researchers will do themselves, it is useful to know the basic concept, as sometimes errors detected in downstream analysis can be traced back to suboptimal demultiplexing. One example is when we have not received the number of reads we expected, which may have be caused by incorrect assignment of indices during demultiplexing.</p>
</section>
<section id="fastq-file" class="level3">
<h3 class="anchored" data-anchor-id="fastq-file">FASTQ File</h3>
<p>The primary output from demultiplexing is called the FASTQ file. This is a text-based (semi-)standard format for storing biological sequences, and their corresponding base quality scores <span class="citation" data-cites="Cock2010-qs">(<a href="#ref-Cock2010-qs" role="doc-biblioref">Cock et al. 2010</a>)</span>. A biological sequence that has been converted to a digital text format is referred to as a ‘read’ or ‘sequence read’. The files that store reads are typically compressed to save space, but can still be very large (gigabytes in size, even when compressed).</p>
<p>The structure of a FASTQ file is a repeated series of four lines (<a href="#fig-intro-ngs-fig-sequencing-read" class="quarto-xref">Figure&nbsp;<span>1.20</span></a>):</p>
<ol type="1">
<li>A metadata or ID line</li>
<li>The DNA sequence itself</li>
<li>A ‘spacer’ line</li>
<li>The base quality score (corresponding to the base in the same position as in line 2)</li>
</ol>
<p>This can broken down as follows:</p>
<p>The metadata line records a range of information from the sequencer and also potentially the demultiplexing. Typically this line will record the sequencing machine ID, a run number, the ID of the flow cell, coordinate information from which cluster on the flow cell the sequence is from, and then extra information that depends on the sequencing center (e.g., some will record the sample-specific index pairs here, or certain settings of the demultiplexing tool).</p>
<div id="fig-intro-ngs-fig-sequencing-read" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-intro-ngs-fig-sequencing-read-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="assets/images/chapters/intro-to-ngs/fig-intro-ngs-fig-sequencing-read.png" class="img-fluid figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-intro-ngs-fig-sequencing-read-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.20: Annotated example of a single sequencing read as represented in a FASTQ file. A read consists of four lines: a metadata line, a sequence line, a spacer line, and a base quality score line. This set of four lines is repeated for every sequenced molecule in the library. Emojis from <a href="https://openmoji.org/">openmoji.org</a> (<a href="https://creativecommons.org/licenses/by-sa/4.0/#">CC-BY SA 4.0</a>)
</figcaption>
</figure>
</div>
<p>The sequence line will contain <code>A</code>, <code>C</code>, <code>T</code>, <code>G</code>, and <code>N</code> characters in the order of the DNA molecule as recorded by the sequencer. In the figure we can see an example of an <code>N</code> call in the first position <a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>.</p>
<p>The third line is simply a spacer line, which is just a <code>+</code> sign. It serves no purpose in modern day FASTQ files (they just display the <code>+</code> to ensure we retain an even number of lines for analysis purposes), however in the past, the metadata information was duplicated on this line to associate with the base quality scores on line 4.</p>
<p>The fourth line has the base quality scores corresponding to the sequence in line 2. These are encoded using <a href="https://en.wikipedia.org/wiki/ASCII">ASCII characters</a>, to allow encoding of scores more than 9 in a single character. What the exact each ASCII character represents slightly depends on <a href="https://en.wikipedia.org/wiki/FASTQ_format#Encoding">which sequencing machine we are using</a> (e.g.&nbsp;Illumina have both a 1.3 and 1.8 variant). However all variants encode a quality score of ‘Q’, also known as a ‘Phred’ score, which corresponds to the probability that the called base is <em>incorrect</em> <span class="citation" data-cites="Ewing1998-su">(<a href="#ref-Ewing1998-su" role="doc-biblioref">Ewing and Green 1998</a>)</span>. This essentially means that the lower the probability the base is incorrect, the higher the quality score. Modern Illumina sequencers have a minimum quality score of 0 (i.e., an incorrect call) and a maximum score of 41 (a highly confident call). Wikipedia provides a very good summary of the differences between ASCII representations of the Phred score on different platforms <a href="https://en.wikipedia.org/wiki/FASTQ_format#Encoding">here</a>.</p>
<p>The rest of a FASTQ file is simply just a repeated set of these four lines. Each line corresponds to an independent DNA cluster - and thus DNA molecule - that was sequenced. In the case of Illumina pair-end sequencing, we will normally have two FASTQ files for each sample - and we can match the forward and reverse reading of each strand by the metadata line and a <code>/1</code> or <code>/2</code> at the end of the ID<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>.</p>
</section>
</section>
<section id="sequencing-and-considerations-for-ancient-metagenomics" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="sequencing-and-considerations-for-ancient-metagenomics"><span class="header-section-number">1.3</span> Sequencing and considerations for ancient metagenomics</h2>
<p>In the second half of this chapter, we will look into some implications of the sequencing process for analysing ancient metagenomic data.</p>
<p>While some of these points are not always specific to ancient metagenomics, and can apply to any DNA analysis - modern or ancient, they can be particularly impactful due to the particular characteristics of ancient DNA.</p>
<section id="low-dna-preservation" class="level3">
<h3 class="anchored" data-anchor-id="low-dna-preservation">Low DNA preservation</h3>
<p>One side effect of the degradation and lost of DNA molecules in ancient samples is that the total molecular biomass of the sample is very low <span class="citation" data-cites="Weyrich2019-am">(<a href="#ref-Weyrich2019-am" role="doc-biblioref">Weyrich et al. 2019</a>)</span>.</p>
<p>This means that during library preparation, researchers often have to perform many rounds of PCR amplification to get a sufficient library concentration for sequencing.</p>
<p>By over-amplifying libraries, we reduce the number of unique sequences from our sample we can actually retrieve. If we are repeatedly sequencing the same DNA sequence (i.e.&nbsp;the amplified copies) over and over, we use up the fixed number of available clusters on the flow cell <span class="citation" data-cites="Gloor2017-ml">(<a href="#ref-Gloor2017-ml" role="doc-biblioref">Gloor et al. 2017</a>)</span>, and prevent clusters of unique sequences from forming and thus being sequenced.</p>
<p>This is also important analysis-wise, as will be discussed in the chapters on <a href="./taxonomic-profiling.html">taxonomic profiling</a> and <a href="./genome-mapping.html">genomic mapping</a>, as we can actually artificially ‘inflate’ the counts of reads that come from a particular taxon (<a href="#fig-intro-ngs-fig-read-stacking" class="quarto-xref">Figure&nbsp;<span>1.21</span></a>). For microbiome studies, this can skew the estimate of which species are in our sample or not. Some studies have also suggested dedeuplication can improve the accuracy of metagenomic <em>de novo</em> assembly <span class="citation" data-cites="Zhang2023-vz">(<a href="#ref-Zhang2023-vz" role="doc-biblioref">Zhang et al. 2023</a>)</span></p>
<div id="fig-intro-ngs-fig-read-stacking" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-intro-ngs-fig-read-stacking-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="assets/images/chapters/intro-to-ngs/fig-intro-ngs-fig-read-stacking.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-intro-ngs-fig-read-stacking-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.21: Schematic representation of the result on over-amplification on reference-based genome mapping. Exact duplicate reads (yellow), that derive from overamplifying a library, can result in portions of the genome having higher depth coverage in certain regions (top distribution) and thus artificially provide a misleading sense of confidence in recovered regions during analysis, even though the overall coverage is low.
</figcaption>
</figure>
</div>
<p>While this artefact can be partially corrected during computational analysis through the process of ‘deduplication’, we should be careful and aim to not overamplify our libraries in the first place, as we can potentially waste a lot of money on sequencing uninformative molecules <span class="citation" data-cites="Daley2013-kn">(<a href="#ref-Daley2013-kn" role="doc-biblioref">Daley and Smith 2013</a>)</span>.</p>
</section>
<section id="index-hopping" class="level3">
<h3 class="anchored" data-anchor-id="index-hopping">Index hopping</h3>
<p>A more recent artefact that has appeared in more recent Illumina platforms is something that has been termed ‘index hopping’ <span class="citation" data-cites="Van_der_Valk2019-to">(<a href="#ref-Van_der_Valk2019-to" role="doc-biblioref">T. van der Valk et al. 2019</a>)</span>. This can cause problems when we are multiplex-sequencing samples, i.e., sequencing multiple samples at once on the same flow cell.</p>
<p>Some more recent Illumina platforms such as the HiSeq X and NovaSeq machines have a new type of flow cell called ‘patterned flow cells’. These aim to better separate out and make more consistent the layout of DNA clusters on the flow cell by having ‘nanowells’ that the clusters form inside. By having a stricter pattern where clusters form, it allows even tighter distribution of clusters on the flow cell without impeding each other and thus increasing the number of clusters that can be sequenced at once <span class="citation" data-cites="Modi2021-ka">(<a href="#ref-Modi2021-ka" role="doc-biblioref">Modi et al. 2021</a>)</span>.</p>
<p>However, even though the cause it not fully understood, it appears that the method used to prevent two DNA molecules occupying the same well (‘exclusion amplification’) can accidentally cause ‘switching’ of the index barcode between two different DNA molecules (<a href="#fig-intro-ngs-fig-indexhopping" class="quarto-xref">Figure&nbsp;<span>1.22</span></a>). Thus, DNA molecules from one sample can instead receive the index barcode of another sample, and subsequently assigned to the wrong sample during demultiplexing.</p>
<p>While this has been observed a low rates in earlier Illumina platforms, index misassignment appears to occur more often in patterned flow cells, at a rate somewhere between 0%-10% <span class="citation" data-cites="Van_der_Valk2019-to">(<a href="#ref-Van_der_Valk2019-to" role="doc-biblioref">T. van der Valk et al. 2019</a>)</span>.</p>
<p>For (ancient) metagenomics this can be problematic as it can result in false positive identification of taxa in your sample. For example, if you sequence in the same run a capture-library of a pathogen and a shotgun metagenomic library for screening, you may falsely ‘identify’ the presence of the pathogen in the shotgun sample. With index hopping, some of the abundant pathogen reads in the pathogen will be accidentally assigned in demultiplexing to the shotgun metagenomic library giving a false positive identification. In another case, if you have an oral microbiome sample and a gut microbiome sample sequenced on the same run, you may start seeing oral species being detected up in your gut samples. While this <em>could</em> be valid biologically, in other cases this could be false and it becomes hard to disambiguate if the species is truly present in the gut or not.</p>
<div id="fig-intro-ngs-fig-indexhopping" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-intro-ngs-fig-indexhopping-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="assets/images/chapters/intro-to-ngs/fig-intro-ngs-fig-indexhopping.jpg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-intro-ngs-fig-indexhopping-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.22: Diagram from <span class="citation" data-cites="Van_der_Valk2018-xx">T. van der Valk et al. (<a href="#ref-Van_der_Valk2018-xx" role="doc-biblioref">2018</a>)</span>’s preprint demonstrating how free-floating adapters (with a different index) can be incorrectly incorporated into molecules during exclusion amplification on Illumina platforms using patterned flowcells (reproduced here under a <a href="http://creativecommons.org/licenses/by-nd/4.0/">CC-BY-ND 4.0</a> license without modification).
</figcaption>
</figure>
</div>
<p>Therefore, we should always keep this in mind when sending our libraries for sequencing. One workaround to this is to ligate additional (short) ‘inline’ barcodes directly to the DNA molecules during library preparation <em>prior</em> to adding adapters <span class="citation" data-cites="Rohland2015-xn">(<a href="#ref-Rohland2015-xn" role="doc-biblioref">Rohland et al. 2015</a>)</span>. However this adds financial cost, and reduces the length of the template molecule we can sequence (as now we must include the inline barcode in the number of sequencing cycles). Otherwise, good sequencing core facilities will automatically screen for this artefact when using these platforms. Despite this, we should always verify this artefact of the sequencing process has not occurred if we find ‘unexpected’ results in our data.</p>
</section>
<section id="sequencing-errors" class="level3">
<h3 class="anchored" data-anchor-id="sequencing-errors">Sequencing errors</h3>
<p>As many parts of this textbook demonstrates, metagenomic sequencing is becoming extremely high-throughput and analysis is becoming increasingly automated and routine. However this does not mean we should skip over quality control of our sequencing data.</p>
<p>While Illumina sequencers nowadays have a very low error rate, they are still not perfect - and things can also go wrong during the sequencing process (<a href="#fig-intro-ngs-fig-fastqc" class="quarto-xref">Figure&nbsp;<span>1.23</span></a>).</p>
<p>All sequencing machines will record ‘their confidence’ in the base calls they make. It is still critical that researchers quality check these before performing downstream analyses.</p>
<p>If our reads have a high number of low base quality socres, the machine may have picked up the wrong nucleotide in the sequence. This could cause a range of problems in various aspects of data analysis: our read may falsely taxonomically classified to the wrong organism with that has a more similar sequence to our errored sequence than the original organism, our read may align to wrong place on a genome during <a href="./genome-mapping.html">mapping</a> (or not align at all!), prevent sufficient overlap of sequences during assembly causing fragmented assemblies, or even cause false positive variant calls during genotyping for phylogenomic analysis <span class="citation" data-cites="Dohm2008-rf">(<a href="#ref-Dohm2008-rf" role="doc-biblioref">Dohm et al. 2008</a>)</span>.</p>
<p>This is a particular concern for ancient metagenomics due to the very low number of truly endogenous ancient molecules in our libraries. This low number of reads means that we cannot as easily ‘correct’ for errors through simply having many repeated observations of a base call in the same a position (higher depth coverage) from independent DNA molecules.</p>
<p>Many core sequencing facilities will be used to handling modern samples with high quality libraries, and thus the threshold for a rejected sequencing run maybe lower than what we would want for ancient metagenomics. Therefore it’s always important to <em>always</em> (double)check the quality of our sequencing data before proceeding with any analysis.</p>
<div id="fig-intro-ngs-fig-fastqc" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-intro-ngs-fig-fastqc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="assets/images/chapters/intro-to-ngs/fig-intro-ngs-fig-fastqc.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-intro-ngs-fig-fastqc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.23: Screenshot of the output of the sequencing quality evaluation tool FASTQC <span class="citation" data-cites="Andrews2010-pd">(<a href="#ref-Andrews2010-pd" role="doc-biblioref">Andrews 2010</a>)</span> of the ancient DNA palaeofaeces sample 2612 from <span class="citation" data-cites="Maixner2021-sg">Maixner et al. (<a href="#ref-Maixner2021-sg" role="doc-biblioref">2021</a>)</span>. Many of the reads have low quality scores (Y-axis) at the end of molecules (X-axis) from around 110bp. This likely represents error accumulation as the sequencing chemistry becomes ‘tired’. Such low-quality bases should be removed using base quality score trimming to reduce the chance of incorrect read assignment or false-positive variant calls due to the wrong base being called.
</figcaption>
</figure>
</div>
</section>
<section id="dirty-genomes" class="level3">
<h3 class="anchored" data-anchor-id="dirty-genomes">Dirty Genomes</h3>
<p>Another very common problem we encounter in both ancient and modern metagenomics are ‘dirty genomes’.</p>
<p>To briefly jump ahead into the bioinformatic analysis of an ancient metagenomic project, we will often compare our reads against a reference database of genomes. This is done to classify which species’ genome a particular read comes from, and allows us to infer the taxonomic makeup of the sample.</p>
<p>We pull these reference genomes from a range of user-submitted databases, such as the NCBI’s GenBank or RefSeq databases. However, the genomes that are uploaded to these databases are not always of high quality. Some genomes can contain sequences that should not be there, such as adapters, primers, contaminating sequences from other species, or other artefactual sequences <span class="citation" data-cites="Longo2011-qd Mukherjee2015-vc Merchant2014-eu Steinegger2020-br Breitwieser2019-iz Kryukov2016-my">(<a href="#ref-Longo2011-qd" role="doc-biblioref">Longo, O’Neill, and O’Neill 2011</a>; <a href="#ref-Mukherjee2015-vc" role="doc-biblioref">Mukherjee et al. 2015</a>; <a href="#ref-Merchant2014-eu" role="doc-biblioref">Merchant, Wood, and Salzberg 2014</a>; <a href="#ref-Steinegger2020-br" role="doc-biblioref">Steinegger and Salzberg 2020</a>; <a href="#ref-Breitwieser2019-iz" role="doc-biblioref">Breitwieser et al. 2019</a>; <a href="#ref-Kryukov2016-my" role="doc-biblioref">Kryukov and Imanishi 2016</a>)</span>. While the NCBI does have quality control checks in place, these have not always been as stringent in the past, and are constantly evolving.</p>
<p>A common example of a notoriously contaminated genome, which many ancient metagenomicists have encountered is the repeated identification of <em>Cyprinus carpio</em> (carp) in their samples (<a href="#fig-intro-ngs-fig-contamination-blog-screenshots" class="quarto-xref">Figure&nbsp;<span>1.24</span></a>).</p>
<p>This is not a true hit, but in fact false positive hits due to the presence of adapter sequences in the carp genome <a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>. I.e., remaining adapter sequences in the sequencing library that were not properly removed during read preprocessing, align against the adapter sequences in the carp genome, resulting in false positive identification of carp in all samples.</p>
<div id="fig-intro-ngs-fig-contamination-blog-screenshots" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-intro-ngs-fig-contamination-blog-screenshots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="assets/images/chapters/intro-to-ngs/fig-intro-ngs-fig-contamination-blog-screenshots.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-intro-ngs-fig-contamination-blog-screenshots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.24: Screenshot of the exasperation after the discovery of a publicly available <em>Cyprinus carpio</em> (carp) genome that was full of sequencing adapters. Any remaining sequencing adapters in our FASTQ files would thus align against the sequences in this genome and we would magically have carp in all of our metagenomic samples. Screenshot of <a href="https://web.archive.org/web/20170823143538/http://www.opiniomics.org/we-need-to-stop-making-this-simple-fcking-mistake/">post</a> on the Opinionomics blog by Mick Watson
</figcaption>
</figure>
</div>
<p>The implication for ancient metagenomicists is that if we do not properly remove artefacts from our reads, we can end up with a lot of false positive hits in our data. This can be particularly impactful, for example, if we are trying to identify the presence of dietary species in a human microbiome sample. But this also extends to microbes, where insufficient removal of contaminating DNA (e.g.&nbsp;modern human sequences incorporated during sampling) can align against stretches of human sequences incorporated into chimeric reference microbial genomes <span class="citation" data-cites="Breitwieser2019-iz">Gihawi et al. (<a href="#ref-Gihawi2023-hu" role="doc-biblioref">2023</a>)</span>.</p>
<p>Therefore, while it is always good to perform quality checks on the genomes going into our reference database, we should also thoroughly quality control our sequenced reads <em>prior</em> downstream analysis. We should make sure to trim reads of adapters, remove host contamination and other artefacts, and check these steps worked properly!</p>
</section>
<section id="low-sequence-diversity-reads" class="level3">
<h3 class="anchored" data-anchor-id="low-sequence-diversity-reads">Low Sequence Diversity Reads</h3>
<p>The presence of low sequence diversity reads in a FASTQ file can cause degraded computational performance, and skew higher-level taxonomic assignments.</p>
<p>Low sequence diversity reads are those that have very little nucleotide variation, such as mononucleotide (<code>GGGGGG</code>) or dinucleotide (<code>ATATAT</code>) repeats. While some of these are not necessarily errors (long stretches of repeats do occur naturally in particularly eukaryotic genomes), they can also be caused by the type of sequencer used.</p>
<p>As described earlier in this chapter, Illumina NovaSeq and NextSeq platforms use two-colour chemistry. In this system, if no light is detected by the camera, the sequencer assumes the base is a <code>G</code>. Therefore if the molecule is very short, once the molecule finishes and there are still remaining sequencing cycles to go, there will be repeated cycles of no light being emitted <a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a>. This results in poly-<code>G</code> ‘tails’ in reads.</p>
<p>Ancient DNA libraries are particularly susceptible to poly-<code>G</code> tails, as the degraded nature of the molecules means that a large number of are <em>very</em> short and thus the length of molecule finishes before all the cycles have finished.</p>
<p>The impact of these low sequence diversity reads is two-fold. Firstly, they slow down processing of reads during the computationally expensive step of alignment to eukaryotic genomes, as low sequence diversity reads can often match many different locations on ta genome, and thus result in an unspecific or ambiguous alignment. These often do not provide useful information, and are anyway discarded during downstream analysis - but only after the computational resources have been used to align them in the first place. Secondly, we can also end up <em>losing</em> otherwise valid reads, purely due to half of the read having an artefactual stretch of nucleotides at the tail end (e.g.&nbsp;<code>AGTCTCGATGGGGGGGGGG</code>, where the first half is a valid sequence and the tail is just because the sequence is short) and thus cannot be aligned to any part of a reference genome. For taxonomic profiling, reads that match multiple genomes will be pushed by Lowest Common Ancestor algorithms ‘up’ the taxonomic tree. When comparing taxonomic profiles between samples at higher ranks, this can inflate counts at higher nodes (e.g., kingdom or phylum level) that do not accurately reflect the true diversity of the sample, as ultimately such reads are sequencing artefacts.</p>
<p>Therefore, if we have sequencing data (particularly from Illumina two-colour chemistry platforms), it is a good idea to check for signatures of increased low sequence diversity reads and remove these from our data through poly-G trimming. Read processing tools such as <code>fastp</code> <span class="citation" data-cites="Chen2018-vg">(<a href="#ref-Chen2018-vg" role="doc-biblioref">Chen et al. 2018</a>)</span> can help with this, as they have functionality that can automatically detect and remove poly-<code>G</code> tails from reads.</p>
</section>
</section>
<section id="summary" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="summary"><span class="header-section-number">1.4</span> Summary</h2>
<p>In this chapter we have covered how the structure of DNA molecules and process of replication is critical to understanding how genetic sequencing works.</p>
<p>We looked at how library preparation is required to add adapters that can include sample specific barcodes to immobilise DNA molecules to the flow cell. We also went through the differences between four- and two-colour Illumina sequencing chemistry, which differ on how each nucleotide added emits a light captured by a camera.</p>
<p>We discussed how sequencing methods are not perfect, and how the confidence in base calls are stored in FASTQ files, and how such low confidence calls can be corrected through paired-end sequencing.</p>
<p>Finally we discussed some important considerations ancient DNA and ancient metagenomics, including duplicated sequences, index hopping, sequencing errors, causes behind contaminated reference genomes, and poly-G tails in low sequence diversity reads.</p>
</section>
<section id="questions-to-think-about" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="questions-to-think-about"><span class="header-section-number">1.5</span> Questions to think about</h2>
<ul>
<li>Why is Illumina sequencing technologies useful for aDNA?</li>
<li>What problems can the four-colour chemistry technology of NextSeq and NovaSeqs cause in downstream analysis?</li>
<li>Why is ‘Index-Hopping’ a problem?</li>
<li>What is good software to evaluate the quality of your sequencing runs?</li>
</ul>
</section>
<section id="references" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="references"><span class="header-section-number">1.6</span> References</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Andreeva2022-oe" class="csl-entry" role="listitem">
Andreeva, T V, A B Malyarchuk, A D Soshkina, N A Dudko, M Yu Plotnikova, and E I Rogaev. 2022. <span>“Methodologies for Ancient <span>DNA</span> Extraction from Bones for Genomic Analysis: Approaches and Guidelines.”</span> <em>Russian Journal of Genetics</em> 58 (9): 1017–35. <a href="https://doi.org/10.1134/s1022795422090034">https://doi.org/10.1134/s1022795422090034</a>.
</div>
<div id="ref-Andrews2010-pd" class="csl-entry" role="listitem">
Andrews, Simon. 2010. <span>“<span>FastQC</span>: A Quality Control Tool for High Throughput Sequence Data.”</span> <a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/">http://www.bioinformatics.babraham.ac.uk/projects/fastqc/</a>.
</div>
<div id="ref-Ayling2020-ra" class="csl-entry" role="listitem">
Ayling, Martin, Matthew D Clark, and Richard M Leggett. 2020. <span>“New Approaches for Metagenome Assembly with Short Reads.”</span> <em>Briefings in Bioinformatics</em> 21 (2): 584–94. <a href="https://doi.org/10.1093/bib/bbz020">https://doi.org/10.1093/bib/bbz020</a>.
</div>
<div id="ref-Bentley2008-oj" class="csl-entry" role="listitem">
Bentley, David R, Shankar Balasubramanian, Harold P Swerdlow, Geoffrey P Smith, John Milton, Clive G Brown, Kevin P Hall, et al. 2008. <span>“Accurate Whole Human Genome Sequencing Using Reversible Terminator Chemistry.”</span> <em>Nature</em> 456 (7218): 53–59. <a href="https://doi.org/10.1038/nature07517">https://doi.org/10.1038/nature07517</a>.
</div>
<div id="ref-Breitwieser2019-iz" class="csl-entry" role="listitem">
Breitwieser, Florian P, Mihaela Pertea, Aleksey Zimin, and Steven L Salzberg. 2019. <span>“Human Contamination in Bacterial Genomes Has Created Thousands of Spurious Proteins.”</span> <em>Genome Research</em> 29 (May): 954–60. <a href="https://doi.org/10.1101/gr.245373.118">https://doi.org/10.1101/gr.245373.118</a>.
</div>
<div id="ref-Bronner2013-sv" class="csl-entry" role="listitem">
Bronner, Iraad F, Michael A Quail, Daniel J Turner, and Harold Swerdlow. 2013. <span>“Improved Protocols for Illumina Sequencing.”</span> <em>Et Al [Current Protocols in Human Genetics]</em> 79 (1): 18.2.1–42. <a href="https://doi.org/10.1002/0471142905.hg1802s79">https://doi.org/10.1002/0471142905.hg1802s79</a>.
</div>
<div id="ref-Cacho2016-ci" class="csl-entry" role="listitem">
Cacho, Ashley, Ekaterina Smirnova, Snehalata Huzurbazar, and Xinping Cui. 2016. <span>“A Comparison of Base-Calling Algorithms for Illumina Sequencing Technology.”</span> <em>Briefings in Bioinformatics</em> 17 (5): 786–95. <a href="https://doi.org/10.1093/bib/bbv088">https://doi.org/10.1093/bib/bbv088</a>.
</div>
<div id="ref-Chen2018-vg" class="csl-entry" role="listitem">
Chen, Shifu, Yanqing Zhou, Yaru Chen, and Jia Gu. 2018. <span>“Fastp: An Ultra-Fast All-in-One <span>FASTQ</span> Preprocessor.”</span> <em>Bioinformatics</em> 34 (17): i884–90. <a href="https://doi.org/10.1093/bioinformatics/bty560">https://doi.org/10.1093/bioinformatics/bty560</a>.
</div>
<div id="ref-Church1988-cr" class="csl-entry" role="listitem">
Church, G M, and S Kieffer-Higgins. 1988. <span>“Multiplex <span>DNA</span> Sequencing.”</span> <em>Science (New York, N.Y.)</em> 240 (4849): 185–88. <a href="https://doi.org/10.1126/science.3353714">https://doi.org/10.1126/science.3353714</a>.
</div>
<div id="ref-Cock2010-qs" class="csl-entry" role="listitem">
Cock, Peter J A, Christopher J Fields, Naohisa Goto, Michael L Heuer, and Peter M Rice. 2010. <span>“The Sanger <span>FASTQ</span> File Format for Sequences with Quality Scores, and the Solexa/Illumina <span>FASTQ</span> Variants.”</span> <em>Nucleic Acids Research</em> 38 (6): 1767–71. <a href="https://doi.org/10.1093/nar/gkp1137">https://doi.org/10.1093/nar/gkp1137</a>.
</div>
<div id="ref-Dabney2013-zo" class="csl-entry" role="listitem">
Dabney, Jesse, Matthias Meyer, and Svante Pääbo. 2013. <span>“Ancient <span>DNA</span> Damage.”</span> <em>Cold Spring Harbor Perspectives in Biology</em> 5 (7). <a href="https://doi.org/10.1101/cshperspect.a012567">https://doi.org/10.1101/cshperspect.a012567</a>.
</div>
<div id="ref-Daley2013-kn" class="csl-entry" role="listitem">
Daley, Timothy, and Andrew D Smith. 2013. <span>“Predicting the Molecular Complexity of Sequencing Libraries.”</span> <em>Nature Methods</em> 10 (4): 325–27. <a href="https://doi.org/10.1038/nmeth.2375">https://doi.org/10.1038/nmeth.2375</a>.
</div>
<div id="ref-Danaeifar2022-sk" class="csl-entry" role="listitem">
Danaeifar, Mohsen. 2022. <span>“New Horizons in Developing Cell Lysis Methods: A Review.”</span> <em>Biotechnology and Bioengineering</em> 119 (11): 3007–21. <a href="https://doi.org/10.1002/bit.28198">https://doi.org/10.1002/bit.28198</a>.
</div>
<div id="ref-De-Kayne2021-pc" class="csl-entry" role="listitem">
De-Kayne, Rishi, David Frei, Ryan Greenway, Sofia L Mendes, Cas Retel, and Philine G D Feulner. 2021. <span>“Sequencing Platform Shifts Provide Opportunities but Pose Challenges for Combining Genomic Data Sets.”</span> <em>Molecular Ecology Resources</em> 21 (3): 653–60. <a href="https://doi.org/10.1111/1755-0998.13309">https://doi.org/10.1111/1755-0998.13309</a>.
</div>
<div id="ref-Dohm2008-rf" class="csl-entry" role="listitem">
Dohm, Juliane C, Claudio Lottaz, Tatiana Borodina, and Heinz Himmelbauer. 2008. <span>“Substantial Biases in Ultra-Short Read Data Sets from High-Throughput <span>DNA</span> Sequencing.”</span> <em>Nucleic Acids Research</em> 36 (16): e105. <a href="https://doi.org/10.1093/nar/gkn425">https://doi.org/10.1093/nar/gkn425</a>.
</div>
<div id="ref-Ewing1998-su" class="csl-entry" role="listitem">
Ewing, B, and P Green. 1998. <span>“Base-Calling of Automated Sequencer Traces Using Phred. <span>II</span>. Error Probabilities.”</span> <em>Genome Research</em> 8 (3): 186–94. <a href="https://doi.org/10.1101/gr.8.3.186">https://doi.org/10.1101/gr.8.3.186</a>.
</div>
<div id="ref-Fu2025-oq" class="csl-entry" role="listitem">
Fu, Beverly J, Vinayak V Viswanadham, Dominika Maziec, Hu Jin, and Peter J Park. 2025. <span>“A Recurrent Sequencing Artifact on Illumina Sequencers with Two-Color Fluorescent Dye Chemistry and Its Impact on Somatic Variant Detection.”</span> <em>bioRxiv.org: The Preprint Server for Biology</em>, September, 2025.09.27.678978. <a href="https://doi.org/10.1101/2025.09.27.678978">https://doi.org/10.1101/2025.09.27.678978</a>.
</div>
<div id="ref-Gihawi2023-hu" class="csl-entry" role="listitem">
Gihawi, Abraham, Yuchen Ge, Jennifer Lu, Daniela Puiu, Amanda Xu, Colin S Cooper, Daniel S Brewer, Mihaela Pertea, and Steven L Salzberg. 2023. <span>“Major Data Analysis Errors Invalidate Cancer Microbiome Findings.”</span> <em>mBio</em> 14 (5): e0160723. <a href="https://doi.org/10.1128/mbio.01607-23">https://doi.org/10.1128/mbio.01607-23</a>.
</div>
<div id="ref-Gloor2017-ml" class="csl-entry" role="listitem">
Gloor, Gregory B, Jean M Macklaim, Vera Pawlowsky-Glahn, and Juan J Egozcue. 2017. <span>“Microbiome Datasets Are Compositional: And This Is Not Optional.”</span> <em>Frontiers in Microbiology</em> 8 (November): 2224. <a href="https://doi.org/10.3389/fmicb.2017.02224">https://doi.org/10.3389/fmicb.2017.02224</a>.
</div>
<div id="ref-Heather2015-zo" class="csl-entry" role="listitem">
Heather, James M, and Benjamin Chain. 2015. <span>“The Sequence of Sequencers: The History of Sequencing <span>DNA</span>.”</span> <em>Genomics</em>, November. <a href="https://doi.org/10.1016/j.ygeno.2015.11.003">https://doi.org/10.1016/j.ygeno.2015.11.003</a>.
</div>
<div id="ref-Holt2008-wk" class="csl-entry" role="listitem">
Holt, Robert A, and Steven J M Jones. 2008. <span>“The New Paradigm of Flow Cell Sequencing.”</span> <em>Genome Research</em> 18 (6): 839–46. <a href="https://doi.org/10.1101/gr.073262.107">https://doi.org/10.1101/gr.073262.107</a>.
</div>
<div id="ref-Ju2006-cl" class="csl-entry" role="listitem">
Ju, Jingyue, Dae Hyun Kim, Lanrong Bi, Qinglin Meng, Xiaopeng Bai, Zengmin Li, Xiaoxu Li, et al. 2006. <span>“Four-Color <span>DNA</span> Sequencing by Synthesis Using Cleavable Fluorescent Nucleotide Reversible Terminators.”</span> <em>Proceedings of the National Academy of Sciences of the United States of America</em> 103 (52): 19635–40. <a href="https://doi.org/10.1073/pnas.0609513103">https://doi.org/10.1073/pnas.0609513103</a>.
</div>
<div id="ref-Kircher2012-fg" class="csl-entry" role="listitem">
Kircher, Martin, Susanna Sawyer, and Matthias Meyer. 2012. <span>“Double Indexing Overcomes Inaccuracies in Multiplex Sequencing on the Illumina Platform.”</span> <em>Nucleic Acids Research</em> 40 (1): e3. <a href="https://doi.org/10.1093/nar/gkr771">https://doi.org/10.1093/nar/gkr771</a>.
</div>
<div id="ref-Koboldt2013-kk" class="csl-entry" role="listitem">
Koboldt, Daniel C, Karyn Meltz Steinberg, David E Larson, Richard K Wilson, and Elaine R Mardis. 2013. <span>“The Next-Generation Sequencing Revolution and Its Impact on Genomics.”</span> <em>Cell</em> 155 (1): 27–38. <a href="https://doi.org/10.1016/j.cell.2013.09.006">https://doi.org/10.1016/j.cell.2013.09.006</a>.
</div>
<div id="ref-Kryukov2016-my" class="csl-entry" role="listitem">
Kryukov, Kirill, and Tadashi Imanishi. 2016. <span>“Human Contamination in Public Genome Assemblies.”</span> <em>PloS One</em> 11 (9): e0162424. <a href="https://doi.org/10.1371/journal.pone.0162424">https://doi.org/10.1371/journal.pone.0162424</a>.
</div>
<div id="ref-Longo2011-qd" class="csl-entry" role="listitem">
Longo, Mark S, Michael J O’Neill, and Rachel J O’Neill. 2011. <span>“Abundant Human <span>DNA</span> Contamination Identified in Non-Primate Genome Databases.”</span> <em>PloS One</em> 6 (2): e16410. <a href="https://doi.org/10.1371/journal.pone.0016410">https://doi.org/10.1371/journal.pone.0016410</a>.
</div>
<div id="ref-Magoc2011-xl" class="csl-entry" role="listitem">
Magoč, Tanja, and Steven L Salzberg. 2011. <span>“<span>FLASH</span>: Fast Length Adjustment of Short Reads to Improve Genome Assemblies.”</span> <em>Bioinformatics (Oxford, England)</em> 27 (21): 2957–63. <a href="https://doi.org/10.1093/bioinformatics/btr507">https://doi.org/10.1093/bioinformatics/btr507</a>.
</div>
<div id="ref-Maixner2021-sg" class="csl-entry" role="listitem">
Maixner, Frank, Mohamed S Sarhan, Kun D Huang, Adrian Tett, Alexander Schoenafinger, Stefania Zingale, Aitor Blanco-Míguez, et al. 2021. <span>“Hallstatt Miners Consumed Blue Cheese and Beer During the Iron Age and Retained a Non-Westernized Gut Microbiome Until the Baroque Period.”</span> <em>Current Biology: CB</em>, October. <a href="https://doi.org/10.1016/j.cub.2021.09.031">https://doi.org/10.1016/j.cub.2021.09.031</a>.
</div>
<div id="ref-Merchant2014-eu" class="csl-entry" role="listitem">
Merchant, Samier, Derrick E Wood, and Steven L Salzberg. 2014. <span>“Unexpected Cross-Species Contamination in Genome Sequencing Projects.”</span> <em>PeerJ</em> 2 (November): e675. <a href="https://doi.org/10.7717/peerj.675">https://doi.org/10.7717/peerj.675</a>.
</div>
<div id="ref-Metzker2010-qw" class="csl-entry" role="listitem">
Metzker, Michael L. 2010. <span>“Sequencing Technologies - the Next Generation.”</span> <em>Nature Reviews. Genetics</em> 11 (1): 31–46. <a href="https://doi.org/10.1038/nrg2626">https://doi.org/10.1038/nrg2626</a>.
</div>
<div id="ref-Modi2021-ka" class="csl-entry" role="listitem">
Modi, Alessandra, Stefania Vai, David Caramelli, and Martina Lari. 2021. <span>“The Illumina Sequencing Protocol and the <span>NovaSeq</span> 6000 System.”</span> <em>Bacterial Pangenomics</em>, 15–42. <a href="https://doi.org/10.1007/978-1-0716-1099-2\_2">https://doi.org/10.1007/978-1-0716-1099-2\_2</a>.
</div>
<div id="ref-Mukherjee2015-vc" class="csl-entry" role="listitem">
Mukherjee, Supratim, Marcel Huntemann, Natalia Ivanova, Nikos C Kyrpides, and Amrita Pati. 2015. <span>“Large-Scale Contamination of Microbial Isolate Genomes by Illumina <span>PhiX</span> Control.”</span> <em>Standards in Genomic Sciences</em> 10 (March): 18. <a href="https://doi.org/10.1186/1944-3277-10-18">https://doi.org/10.1186/1944-3277-10-18</a>.
</div>
<div id="ref-Rohland2015-xn" class="csl-entry" role="listitem">
Rohland, Nadin, Eadaoin Harney, Swapan Mallick, Susanne Nordenfelt, and David Reich. 2015. <span>“Partial Uracil-<span>DNA</span>-Glycosylase Treatment for Screening of Ancient <span>DNA</span>.”</span> <em>Philosophical Transactions of the Royal Society of London. Series B, Biological Sciences</em> 370 (1660): 20130624. <a href="https://doi.org/10.1098/rstb.2013.0624">https://doi.org/10.1098/rstb.2013.0624</a>.
</div>
<div id="ref-Rougemont2008-ug" class="csl-entry" role="listitem">
Rougemont, Jacques, Arnaud Amzallag, Christian Iseli, Laurent Farinelli, Ioannis Xenarios, and Felix Naef. 2008. <span>“Probabilistic Base Calling of Solexa Sequencing Data.”</span> <em>BMC Bioinformatics</em> 9 (1): 431. <a href="https://doi.org/10.1186/1471-2105-9-431">https://doi.org/10.1186/1471-2105-9-431</a>.
</div>
<div id="ref-Sanger1977-zw" class="csl-entry" role="listitem">
Sanger, F, S Nicklen, and A R Coulson. 1977. <span>“<span>DNA</span> Sequencing with Chain-Terminating Inhibitors.”</span> <em>Proceedings of the National Academy of Sciences of the United States of America</em> 74 (12): 5463–67. <a href="https://doi.org/10.1073/pnas.74.12.5463">https://doi.org/10.1073/pnas.74.12.5463</a>.
</div>
<div id="ref-Schloss2020-gp" class="csl-entry" role="listitem">
Schloss, Jeffery A, Richard A Gibbs, Vinod B Makhijani, and Andre Marziali. 2020. <span>“Cultivating <span>DNA</span> Sequencing Technology After the Human Genome Project.”</span> <em>Annual Review of Genomics and Human Genetics</em> 21 (1): 117–38. <a href="https://doi.org/10.1146/annurev-genom-111919-082433">https://doi.org/10.1146/annurev-genom-111919-082433</a>.
</div>
<div id="ref-Shendure2011-om" class="csl-entry" role="listitem">
Shendure, Jay A, Gregory J Porreca, George M Church, Andrew F Gardner, Cynthia L Hendrickson, Jan Kieleczawa, and Barton E Slatko. 2011. <span>“Overview of <span>DNA</span> Sequencing Strategies.”</span> <em>Et Al [Current Protocols in Molecular Biology]</em> Chapter 7 (1): Unit7.1. <a href="https://doi.org/10.1002/0471142727.mb0701s96">https://doi.org/10.1002/0471142727.mb0701s96</a>.
</div>
<div id="ref-Shendure2008-fh" class="csl-entry" role="listitem">
Shendure, Jay, and Hanlee Ji. 2008. <span>“Next-Generation <span>DNA</span> Sequencing.”</span> <em>Nature Biotechnology</em> 26 (10): 1135–45. <a href="https://doi.org/10.1038/nbt1486">https://doi.org/10.1038/nbt1486</a>.
</div>
<div id="ref-Steinegger2020-br" class="csl-entry" role="listitem">
Steinegger, Martin, and Steven L Salzberg. 2020. <span>“Terminating Contamination: Large-Scale Search Identifies More Than 2,000,000 Contaminated Entries in <span>GenBank</span>.”</span> <em>Genome Biology</em> 21 (1): 115. <a href="https://doi.org/10.1186/s13059-020-02023-1">https://doi.org/10.1186/s13059-020-02023-1</a>.
</div>
<div id="ref-Valencia2013-wk" class="csl-entry" role="listitem">
Valencia, C Alexander, M Ali Pervaiz, Ammar Husami, Yaping Qian, and Kejian Zhang. 2013. <span>“Sanger Sequencing Principles, History, and Landmarks.”</span> In <em>SpringerBriefs in Genetics</em>, 3–11. New York, NY: Springer New York. <a href="https://doi.org/10.1007/978-1-4614-9032-6\_1">https://doi.org/10.1007/978-1-4614-9032-6\_1</a>.
</div>
<div id="ref-Van_der_Valk2018-xx" class="csl-entry" role="listitem">
Valk, Tom van der, Francesco Vezzi, Mattias Ormestad, Love Dalén, and Katerina Guschanski. 2018. <span>“Index Hopping on the Illumina HiseqX Platform and Its Consequences for Ancient DNA Studies.”</span> <em>bioRxiv</em>. <a href="https://doi.org/10.1101/179028">https://doi.org/10.1101/179028</a>.
</div>
<div id="ref-Van_der_Valk2019-to" class="csl-entry" role="listitem">
Valk, Tom van der, Francesco Vezzi, Mattias Ormestad, Love Dalén, and Katerina Guschanski. 2019. <span>“Index Hopping on the Illumina <span>HiseqX</span> Platform and Its Consequences for Ancient <span>DNA</span> Studies.”</span> <em>Molecular Ecology Resources</em>, March. <a href="https://doi.org/10.1111/1755-0998.13009">https://doi.org/10.1111/1755-0998.13009</a>.
</div>
<div id="ref-Weyrich2019-am" class="csl-entry" role="listitem">
Weyrich, Laura S, Andrew G Farrer, Raphael Eisenhofer, Luis A Arriola, Jennifer Young, Caitlin A Selway, Matilda Handsley-Davis, Christina J Adler, James Breen, and Alan Cooper. 2019. <span>“Laboratory Contamination over Time During Low-Biomass Sample Analysis.”</span> <em>Molecular Ecology Resources</em> 19 (4): 982–96. <a href="https://doi.org/10.1111/1755-0998.13011">https://doi.org/10.1111/1755-0998.13011</a>.
</div>
<div id="ref-Zhang2023-vz" class="csl-entry" role="listitem">
Zhang, Zhiguo, Lu Zhang, Guoqing Zhang, Ze Zhao, Hui Wang, and Feng Ju. 2023. <span>“Deduplication Improves Cost-Efficiency and Yields of <span>DE</span> Novo Assembly and Binning of Shotgun Metagenomes in Microbiome Research.”</span> <em>Microbiology Spectrum</em>, February, e0428222. <a href="https://doi.org/10.1128/spectrum.04282-22">https://doi.org/10.1128/spectrum.04282-22</a>.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Newer techniques such as Nanopore sequencers use different methods.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>With the more recent emergence of Nanopore sequencing, really NGS should be equated to ‘second generation sequencing’, a term you will see in some contexts.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Take this statement very much tongue in cheek.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>It is actually quite common to see in the first or second position of reads, as the sequencer’s camera is still calibrating itself.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>We can occasionally encounter a format called ‘interleaved’ FASTQ files, where the forward and reverse reads are placed right after one another in the same file, but this is not common practice any more.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>See <a href="https://web.archive.org/web/20170823143538/http://www.opiniomics.org/we-need-to-stop-making-this-simple-fcking-mistake/">https://web.archive.org/web/20170823143538/http://www.opiniomics.org/we-need-to-stop-making-this-simple-fcking-mistake/</a> and <a href="https://web.archive.org/web/20241012070028/https://grahametherington.blogspot.com/2014/09/why-you-should-qc-your-reads-and-your.html">https://web.archive.org/web/20241012070028/https://grahametherington.blogspot.com/2014/09/why-you-should-qc-your-reads-and-your.html</a><a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>See: <a href="https://support.illumina.com/content/dam/illumina-support/help/Illumina_DRAGEN_Bio_IT_Platform_v3_7_1000000141465/Content/SW/Informatics/Dragen/PolyG_Trimming_fDG.htm">https://support.illumina.com/content/dam/illumina-support/help/Illumina_DRAGEN_Bio_IT_Platform_v3_7_1000000141465/Content/SW/Informatics/Dragen/PolyG_Trimming_fDG.htm</a><a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/spaam-community\.github\.org\/intro-to-ancient-metagenomics-book");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./section-theory.html" class="pagination-link" aria-label="Theory">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Theory</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./introduction-to-ancient-dna.html" class="pagination-link" aria-label="Introduction to Ancient DNA">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to Ancient DNA</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>© 2024 SPAAM Community &amp; Authors with ❤️. Available under <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a>. Source material <a href="https://github.com/SPAAM-community/intro-to-ancient-metagenomics-book">here</a>.</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>